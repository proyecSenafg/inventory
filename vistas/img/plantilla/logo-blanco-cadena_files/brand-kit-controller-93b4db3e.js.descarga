(window.webpackJsonp=window.webpackJsonp||[]).push([["brand-kit-controller",7,"authoring-context"],{103:function(e,t,i){var n,r;n=[i(16),i(9),i(2),i(11),i(17),i(33),i(682),i(696),i(698),i(224),i(699)],void 0===(r=function(e,t,i,n,r,o,a,s,c,l,u){"use strict";var d,h;return d=a.extend({cachename:"confirmview",el:".confirm-overlay",mode:"confirm",clickTimeSafetyZone:250,events:{"click .confirm-view-bg":"handleBackgroundClick","click .cancel-btn":"handleCloseBtn","click .sp-cta-button-secondary":"handleCloseBtn","click .ok-btn":"handleConfirmBtn","click .confirm-view-prompt-field":"handlePromptFieldClick"},initialize:function(){t.bindAll(this,t.functionsIn(this)),this._initDefaultStrings()},_initDefaultStrings:function(){this.defaultOkText=r.getString("confirm-view-default-verb-ok"),this.defaultCancelText=r.getString("confirm-view-default-verb-cancel"),this.defaultWaiterTitle=r.getString("confirm-view-default-waiter-title")},setText:function(e,t){e=e||"",t=t||this.text$,e.jquery?(t.html(""),t.append(e)):t.text(e)},render:function(){var i;this.$el.length||(this.$el=e(document.body).find(".confirm-overlay")),window.marvel.events.trigger("spark-dialog-shown"),this.$el.addClass("v2"),this.$el.html(r.mustacheRender(c)),this.cancelBtn$=this.$el.find(".sp-cta-button-secondary"),this.isBeta&&this.$el.find(".confirm-view-dialog-title").addClass("beta"),this.$el[0].focus(),this._options.transparentOverlay&&this.$el.find(".confirm-view-bg").addClass("transparent-overlay"),this._options.className&&this.$el.addClass(this._options.className);var n=this.$el.find(".confirm-view-link");this.checkBoxText?(this.$el.find(".confirm-view-checkbox-label").text(this.checkBoxText),this.href?n.attr("href",this.href):n.addClass("hide")):(this.$el.find(".confirm-view-checkbox").addClass("hide"),n.addClass("hide"));if(Array.isArray(this.okText)){var o="";this.defaultConfirmIndex=this.okText.length-1,t.each(this.okText,function(e,t){var i=".confirm-btn-"+t;e.isDefault&&(this.defaultConfirmIndex=t),e.button$=this.$el.find(i),this.setText(e.text,e.button$),e.button$.data("id",e.id),o+=(t?", ":"")+i}.bind(this)),this.confirmBtn$=this.$el.find(o)}else this.defaultConfirmIndex=0,this.confirmBtn$=this.$el.find(".confirm-btn-0"),this.okText&&this.okText.id?(this.setText(this.okText.text||this.defaultOkText,this.confirmBtn$),this.confirmBtn$.data("id",this.okText.id)):(this.setText(this.okText||this.defaultOkText,this.confirmBtn$),this.confirmBtn$.removeData("id"));i=this.confirmBtn$.length,this.closeBtn$=this.$el.find(".confirm-view-close-btn"),this._options.hideCloseButton?this.closeBtn$.addClass("hide"):(this.closeBtn$.removeClass("hide"),this.closeBtn$.on("click",this.handleCloseBtn.bind(this))),this.confirmBtn$.on("click",this.handleConfirmBtn.bind(this)),this.confirmBtn$.removeClass("disabled").removeClass("hide"),this.cvShell$=this.$el.find(".confirm-view-shell"),this.cvShell$.addClass(this.mode),this.title$=this.$el.find(".confirm-view-dialog-title"),this.title$.text(this.question),this.text$=this.$el.find(".confirm-view-dialog-text"),this.setText(this.detail),this.text$.append(n),this.waiter$=this.$el.find(".wait-spinner"),this._closeDefer&&this.cvShell$.addClass("can-wait"),this._addedKeyup||(this._addedKeyup=!0,e(document).on("keyup.dialog",this.handleKeyup)),"waiter"===this.mode?(this.setWaiterVis(!0),this._hideSpinner&&this.waiter$.addClass("hide")):"alert"!==this.mode?(this._options.hideCancelButton?this.cancelBtn$.addClass("hide"):(this.cancelBtn$.removeClass("disabled").removeClass("hide"),this.cancelBtn$.text(this.cancelText||this.defaultCancelText),this.cancelText&&this.cancelBtn$.text(this.cancelText)),"prompt"===this.mode&&(this.$el.find(".confirm-view-prompt-field-area").removeClass("hide"),this.promptField$=this.$el.find(".confirm-view-prompt-field"),this.promptField$.attr("placeholder",this.placeholderText),this.maxLen&&this.promptField$.attr("maxlength",this.maxLen),this.promptField$.val(this.defaultText),this.promptExtraStyles&&this.promptField$.css(this.promptExtraStyles))):this.cancelBtn$.addClass("hide"),this.cancelBtn$.hasClass("hide")||i++,this.cvShell$.addClass("num-buttons-"+i),this._options.additionalUI$&&this.$el.find(".confirm-view-content-shell").append(this._options.additionalUI$),this.$el.removeClass("hide"),this.setDialogDimensions();var a=!0;"prompt"===this.mode&&this.autoSelectPromptText&&(this.promptField$.select(),a=!1),a&&this.confirmBtn$[this.defaultConfirmIndex].focus(),this._ignoreNextKeyup=!1,this._options.afterRenderCallback&&"function"==typeof this._options.afterRenderCallback&&this._options.afterRenderCallback(this.$el)},onConfirm:function(e,t,i){this._confirmCallback=e,this.title=t,this.text=i},handleConfirmBtn:function(t){var i=!0;if(i=e(t.target).data("id")||i,this.checkBoxText){var n=this.$el.find(".confirm-view-checkbox-input").is(":checked");this.handleBtn({value:i,isDismissed:n},t),this.checkBoxText=null}else this.handleBtn(i,t)},setDialogDimensions:function(){var e=this._options.minHeight||0;e&&this.cvShell$.css("min-height",e)},setWaiterVis:function(e){if(e){if("waiter"!==this.mode){var t=this._getBounds();this.cvShell$.css("height",t.height+"px")}else this.cvShell$.css("height","");this.title$.text(this.waiterTitle||this.defaultWaiterTitle),this.setText(this.waiterText||""),this.waiterText?this.cvShell$.addClass("waiter-has-text"):this.cvShell$.removeClass("waiter-has-text"),this.waiterProgressBar?(this._progressBarView||(this._progressBarView=new s),this.waiterProgressBar.el$=this.$el.find(".confirm-progress-bar"),this.waiterProgressBar.text$=this.waiterProgressBar.eventNames.updateText&&this.text$,this._progressBarView.setupProgress(this.waiterProgressBar),this._progressBarView.render(),this.cvShell$.addClass("showing-progress")):this.waitSuccess?this.cvShell$.addClass("showing-waiter-success"):this.cvShell$.addClass("showing-waiter"),this._canCancelWaiter?(this.cvShell$.addClass("can-cancel-waiter"),this._options.okOnly?this.cancelBtn$.addClass("hide"):this.cancelBtn$.text(this.waiterCancelText)):this.cvShell$.removeClass("can-cancel-waiter")}else this.cvShell$.removeClass("can-cancel-waiter"),this.waiterProgressBar?(this.cvShell$.removeClass("showing-progress"),this._progressBarView.hide()):this.cvShell$.removeClass("showing-waiter"),this.title$.text(this.question),this.setText(this.detail),this.cancelBtn$.text(this.cancelText)},handleBtn:function(e,i){if(i.stopPropagation(),e){if("prompt"===this.mode&&!this.validPromptTextCheck("confirm"))return void this.promptField$.select();if(this.confirmBtn$.hasClass("disabled"))return}if(!(this._closingEventTime&&i.timeStamp-this._closingEventTime<this.clickTimeSafetyZone)&&(this._closingEventTime=i.timeStamp,this._confirmDefer)){var n;if("prompt"!==this.mode)n=e;else if(e){if(n=this.promptField$.val(),this._options.trimText&&(n=n.trim()),this.confirmBtn$.length>1){var r=e;n={text:n,buttonData:!0===r?this.okText[this.defaultConfirmIndex]:t.find(this.okText,(function(e){return e.id===r}))}}}else n=null;this._closeDefer?(this._confirmDefer.resolve(n),this._confirmDefer=null,e?this.setWaiterVis(!0):this.hide(!0),this._closeDefer.promise.then(function(){this._closeDefer=null,e&&(this.hide(!0),this.setWaiterVis(!1))}.bind(this))):(this.hide(!0),this._confirmDefer.resolve(n),this._confirmDefer=null),e&&this._options.okHandler&&this._options.okHandler()}},handleBackgroundClick:function(e){this._options.ignoreBackgroundClick||this.handleCloseBtn(e)},handleCloseBtn:function(e){this.checkBoxText=null,"alert"!==this.mode?this.handleBtn(!1,e):this.handleBtn(!0,e)},handlePromptFieldClick:function(e){this.selectAllOnFieldClick&&e.target.select()},isShowing:function(){return!this.$el.hasClass("hide")},isWaiting:function(){return this.cvShell$.hasClass("showing-waiter")},_showAsWaiter:function(e,i,n,r,o){this._options=o,this.mode="waiter",this.waiterText=i,this.question="",this.detail="",this.waiterTitle=e,this._confirmDefer=n,this._canCancelWaiter=!!this._confirmDefer,this.waiterCancelText=r,this.okText=o.okText,this.waiterProgressBar=t.clone(o.progressBar),this._hideSpinner=o.hideSpinner,this.waitSuccess=o.waitSuccess,this.render()},_showAsConfirm:function(e,t,i,n){this._options=n,this._confirmDefer=i,this.mode="confirm",this.question=e,this.detail=t,this.okText=n.okText,this.cancelText=n.cancelText,this._closeDefer=n.closeDefer,this.waiterTitle=n.closeDeferWaitTitle,this.waiterText=n.closeDeferWaitText,this.render()},_showAsConfirmWithCheckboxWithHyperLink:function(e,t,i,n){this._options=n,this._confirmDefer=i,this.mode="confirm",this.question=e,this.detail=t+" ",this.checkBoxText=n.checkBoxText,this.href=n.href,this.okText=n.okText,this.cancelText=n.cancelText,this._closeDefer=n.closeDefer,this.waiterTitle=n.closeDeferWaitTitle,this.waiterText=n.closeDeferWaitText,this.render()},_showAsAlert:function(e,t,i,n){this._options=n,this._confirmDefer=i,this.mode="alert",this.question=e,this.detail=t,this.okText=n.okText,this.render()},_showAsPrompt:function(e,i,n,r){this._options=r,this._confirmDefer=n,this.mode="prompt",this.question=e,this.detail=i,this.defaultText=r.defaultText||"",this.placeholderText=r.placeholderText||"",this.promptExtraStyles=r.promptExtraStyles||null,this.maxLen=r.maxLen||0,this.selectAllOnFieldClick=r.selectAllOnFieldClick,this.okText=r.okText,this.cancelText=r.cancelText,this._closeDefer=r.closeDefer,this.waiterTitle=r.closeDeferWaitTitle,this.waiterText=r.closeDeferWaitText,this.autoSelectPromptText=!!t.isUndefined(r.select)||r.select,this.isBeta=r.isBeta||!1,this.render(),this.validPromptTextCheck("setup",this.defaultText)},validPromptTextCheck:function(e,i){var n=t.isUndefined(i)?this.promptField$.val():i;return this._options.trimText&&(n=n.trim()),this._options.cantBeEmpty&&""===n?("setup"!==e&&("confirm"===e||this._options.showErrorDuringEntry)&&this.promptField$.addClass("error"),this._options.dontDimConfirmIfError||this.confirmBtn$.addClass("disabled"),!1):(this.promptField$.removeClass("error"),this.confirmBtn$.removeClass("disabled"),!0)},showCancelableWaitView:function(e,t,n){var r=i.defer();return n=n||{},this._showAsWaiter(e,t,r,n.cancelText||this.defaultCancelText,n),r.promise},showWaitView:function(e,t,i){this._showAsWaiter(e,t,null,null,i||{})},showWaitSuccessView:function(e,t,i){(i=i||{}).waitSuccess=!0,this._showAsWaiter(e,t,null,null,i),setTimeout(function(){this.hide(!0)}.bind(this),i.duration||1e3)},showAlert:function(e,t,n){var r=(n=n||{}).defer||i.defer();return this._showAsAlert(e,t,r,n),r.promise},showConfirm:function(e,t,n,r){(n=n||{}).afterRenderCallback=n.afterRenderCallback||r;var o=n.defer||i.defer();return this._showAsConfirm(e,t,o,n),o.promise},showConfirmWithCheckBoxAndHyperLink:function(e,t,n,r){(n=n||{}).afterRenderCallback=n.afterRenderCallback||r;var o=n.defer||i.defer();return this._showAsConfirmWithCheckboxWithHyperLink(e,t,o,n),o.promise},showPrompt:function(e,t,n){var r=(n=n||{}).defer||i.defer();return this._showAsPrompt(e,t,r,n),r.promise},handleKeyup:function(e){if(this._ignoreNextKeyup)this._ignoreNextKeyup=!1;else{if(e&&e.isPropagationStopped())return;this._ignoreCloseActions||this.isWaiting()&&!this._canCancelWaiter?(e.stopPropagation(),e.preventDefault()):e.keyCode===l.DOM_VK_ESCAPE?(e.stopPropagation(),e.preventDefault(),this._options.hideCloseButton&&this._options.hideCancelButton||this.handleCloseBtn(e)):e.keyCode===l.DOM_VK_RETURN||e.keyCode===l.DOM_VK_ENTER?(e.stopPropagation(),e.preventDefault(),this.handleConfirmBtn(e)):"prompt"===this.mode&&this.validPromptTextCheck("keyUp")}},ignoreNextKeyup:function(){return!!this.isShowing()&&(this._ignoreNextKeyup=!0,!0)},_getBounds:function(){return this.cvShell$[0].getBoundingClientRect()},hide:function(t){window.marvel.events.trigger("spark-dialog-closed"),!t&&this._confirmDefer&&(this._confirmDefer.resolve(!1),this._confirmDefer=null),this.$el.addClass("hide"),this.cvShell$.removeClass(this.mode),this.$el.find(".confirm-view-bg").removeClass("transparent-overlay"),this._addedKeyup&&(e(document).off("keyup.dialog",this.handleKeyup),this._addedKeyup=!1)},getMessageViewAdaptor:function(){return{name:"confirmview",pattern:"confirmview",show:function(e){h[e.mode].apply(h,e.arguments).then(e.success||function(){},e.error||function(){})}}}}),h=new d}.apply(t,n))||(e.exports=r)},104:function(e,t,i){var n,r;n=[i(9),i(2),i(11),i(617),i(33),i(155),i(316),i(6),i(42),i(315),i(13)],void 0===(r=function(e,t,n,r,o,a,s,c,l,u,d){"use strict";var h=new c.default({color:"rebeccapurple",name:"userProfileController"}),g=l.default,f=a.default,m=s.default;return new(n.Model.extend({initUserProfile:function(){return this._currentUserProfile?t.resolve():(this._currentUserProfile=new r,this._currentUserProfile.initProfile({useFeaureFlags:!0,dataObj:{},profileId:"spark",type:"spark",logger:h}))},getChangedSettingsToSubmit:function(t){var i={};return e.each(t,function(t,n){"_"!==n.charAt(0)&&("object"!=typeof t||e.isArray(t)?i[n]=t:i[n]="featureFlipperChanges"!==n?this.getChangedSettingsToSubmit(t):t)}.bind(this)),i},setUserSettings:function(i){var n=t.defer();return e.each(i,function(e,t){"enableMarketing"===t&&console.log("try to save "+JSON.stringify(e))}.bind(this)),i=this.getChangedSettingsToSubmit(i),this._currentUserProfile.saveUpdatedProfileSettings(i).then((function(e){n.resolve(e)}),(function(e){n.reject(e)})),n.promise},refreshUserProfile:function(){if(delete this._getProfileHomeSettingsDefer,this.userProfileDeferred){if(!this.userProfileDeferred.promise.isFulfilled())return this.userProfileDeferred.promise;delete this.userProfileDeferred,delete this._currentUserProfile}return this.userProfileLoaded().then(function(){g.trigger(m.USER_PROFILE_REFRESHED,this._currentUserProfile)}.bind(this))},userProfileLoaded:function(){return this.userProfileDeferred||(this.userProfileDeferred=t.defer(),o.allFeaturesLoaded().then(function(){this.initUserProfile().then(function(){this._currentUserProfile._isSignedIn||g.on(f.FEATURES_REFRESHED_ON_AUTH,this.refreshUserProfile.bind(this)),this.userProfileDeferred.resolve(this._currentUserProfile),g.trigger(m.USER_PROFILE_LOADED,this._currentUserProfile)}.bind(this),function(e){window.marvel.logger.error("Failed to load user profile "+e.status,e),this.userProfileDeferred.reject(e.status)}.bind(this))}.bind(this)).done()),this.userProfileDeferred.promise},getGetNoticedSettings:function(){return this._currentUserProfile.getGetNoticedSettings()},getIsEDUAccount:function(){return this.userProfileLoaded().then(function(){return this._currentUserProfile.isEDUAccount()}.bind(this))},getUserType:function(){return this.userProfileLoaded().then(function(){return this._currentUserProfile.getUserType()}.bind(this))},getUserTypeId:function(){return this.userProfileLoaded().then(function(){return this._currentUserProfile.getUserTypeId()}.bind(this))},getIsFreeHigherEducationUser:function(){return this.userProfileLoaded().then(function(){return this._currentUserProfile.isFreeHigherEducationUser()}.bind(this))},getStockBlocked:function(e){return this.userProfileLoaded().then(function(){return this._currentUserProfile.stockBlocked(e)}.bind(this))},getStockUserInfo:function(e){return this.userProfileLoaded().then(function(){return this._currentUserProfile.getStockUserInfo(e)}.bind(this))},getProfileHomeSettings:function(){return this._getProfileHomeSettingsDefer||(this._getProfileHomeSettingsDefer=t.defer(),this.userProfileLoaded().then(function(){this._getProfileHomeSettingsDefer.resolve(this._currentUserProfile.getProfileHomeSettings())}.bind(this)).done()),this._getProfileHomeSettingsDefer.promise},getProfile:function(){return this._currentUserProfile},getProfileIfLoggedIn:function(){return this.userProfileLoaded().then(function(){return this._currentUserProfile}.bind(this),(function(e){}))},editSettings:function(t){var i={mode:"edit"};return t&&e.assign(i,t),this._displaySettingsForEdit(i).then((function(e){e&&i.isFeatureFlipperRequest&&document.location.reload()}))},_getUserProfileView:function(){return this._getUserProfileViewDefer||(this._getUserProfileViewDefer=t.defer(),Promise.all([i.e("m-react-spectrum"),i.e(0),i.e(1),i.e(2),i.e("user-profile-view")]).then(function(e){var t=i(845);this._getUserProfileViewDefer.resolve(t)}.bind(this).bind(null,i)).catch(i.oe)),this._getUserProfileViewDefer.promise},isFreeNonEduUSUser:function(){var e=d.getUserCountry(),t=["US"].includes(e);return this.getIsEDUAccount().then(function(e){return!e&&t&&!o.hasFeature("is-paid-user")&&!o.hasFeature("entitle-brand-kit")}.bind(this))},_displaySettingsForEdit:function(i){return this._getUserProfileView().then(function(n){i.fieldIds||(i.fieldIds=["share-default-to-unlisted"],o.hasFeature("user-settings-allow-show-account-info")&&i.fieldIds.push("displayName","avatar","email","entitlement","usertype","udsData","safeSearch"));var r=t.defer();i=e.clone(i),this._mode=i.mode;var a=!1;return i.hideLoadingSpinner||n.showLoadingSpinner().then(function(e){a="canceled"===e}.bind(this)),this.userProfileLoaded().then(function(){return i.isFeatureFlipperRequest?void 0:this._currentUserProfile.emailListSettingsLoaded()}.bind(this)).then(function(s){if(!i.hideLoadingSpinner){if(a)return r.resolve();n.hideLoadingSpinner()}o.hasFeature("show-user-flag-image-source-stock")&&i.fieldIds.push("user-flag-image-source-stock"),e.each(u.imageServices.dooplo,function(e){o.hasFeature(u.imageServices.showFlagPrefixDooplo+e)&&i.fieldIds.push(u.imageServices.flagPrefixDooplo+e)}.bind(this));var c=i.fieldIds.indexOf("share-default-to-unlisted");-1!==c&&(this.getGetNoticedSettings().supported||i.fieldIds.splice(c,1));if(i.ignoreIfExisting&&this._currentUserProfile.lastModified)return r.resolve();var l=t.defer();i.userProfile=this._currentUserProfile,i.canEditNonBooleans=!1,i.closeDefer=l,"success"===s?i.fieldIds.push("spark-newsletter"):"unableToLoadEmailSettingsForQualifiedUser"===s&&(i.unableToLoadEmailSettingsForQualifiedUser=!0),n.editProfile(i).then(function(e){e?this.setUserSettings(e).then(function(e){l.resolve(!0),r.resolve(e)}.bind(this),function(e){r.reject(e)}.bind(this)):(l.resolve(!0),r.resolve())}.bind(this),(function(e){h.error("editProfile had error",e),r.reject(e)})).done()}.bind(this),(function(e){r.reject(e)})).done(),r.promise}.bind(this))}}))}.apply(t,n))||(e.exports=r)},132:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i(4),r=i.n(n),o=i(3),a=i.n(o),s=(i(2),function(){function e(t,i){if(r()(this,e),this.REGEX_MATCHER_CURIE_PARAMS=/\{\?(.+)\}/,this.REGEX_MATCHER_CURIE_MODIFIERS=/\{;(.+)\}/,this.REGEX_MATCHER_PARAM_SPIT=/\s*,\s*/,!t)throw new Error("You must provide at least one string as link!");if("string"!=typeof t)throw new Error("Link must be provided as string!");this.link=t,this.parameters=i||{}}return a()(e,[{key:"toUri",value:function(){var e=this;if("string"!=typeof this.link)throw new Error("You must provide at least one string as link!");if(0===Object.getOwnPropertyNames(this.parameters).length)return this.sanitize();var t=this.getModifiers().reduce((function(t,i){var n=e.parameters[i];return delete e.parameters[i],void 0!==n&&t.push(i+"="+n),t}),[]).filter((function(e){return(e+"").length>0})).join("&"),i=this.getParameters().reduce((function(t,i){var n=e.parameters[i];return void 0!==n&&t.push(i+"="+n),t}),[]).filter((function(e){return(e+"").length>0})).join("&"),n="";return n=t?this.link.replace(this.REGEX_MATCHER_CURIE_MODIFIERS,";"+t):n.replace(this.REGEX_MATCHER_CURIE_MODIFIERS,""),n=i?this.link.replace(this.REGEX_MATCHER_CURIE_PARAMS,"?"+i):n.replace(this.REGEX_MATCHER_CURIE_PARAMS,"")}},{key:"sanitize",value:function(){if("string"!=typeof this.link)throw new Error("You must provide at least one string as link!");return this.link.replace(this.REGEX_MATCHER_CURIE_PARAMS,"").replace(this.REGEX_MATCHER_CURIE_MODIFIERS,"")}},{key:"getModifiers",value:function(){if("string"!=typeof this.link)throw new Error("You must provide at least one string as link!");var e=this.REGEX_MATCHER_CURIE_MODIFIERS.exec(this.link);return e&&e[1]?e[1].split(this.REGEX_MATCHER_PARAM_SPIT):[]}},{key:"getParameters",value:function(){if("string"!=typeof this.link)throw new Error("You must provide at least one string as link!");var e=this.REGEX_MATCHER_CURIE_PARAMS.exec(this.link);return e&&e[1]?e[1].split(this.REGEX_MATCHER_PARAM_SPIT):[]}}]),e}()),c=function(){function e(){r()(this,e)}return a()(e,[{key:"getLink",value:function(e,t){if(this._links){var i=this._links["http://ns.adobe.com/melville/rel/".concat(e)];if(i)return i.templated?new s(i.href,t).toUri():i.href}}},{key:"getProxyRenditionHref",value:function(e,t){if(!e)return e;if(-1===e.search(/cc-api-storage/))return t&&(e=e.replace(/size=\d+/,"size="+t)),"/teamLibraryStorage?storageUrl=".concat(encodeURIComponent(e));return e?0===e.search(/^https?\:\/\/[^\/]*\/id/)?e:(0===e.search(/^https?\:\/\/[^\/]*\/assets/)&&(e=-1!==e.search(/size/)?e.replace(/^https?\:\/\/[^\/]*\/assets\/([^\/]*)\/([^\/]*)\/([^\/]*)\/?(\:rendition)?.*size\=([^&]*).*$/,"/image_assets/$1/$2/?asset_id=$3&size=$5"):e.replace(/^https?\:\/\/[^\/]*\/assets\/([^\/]*)\/([^\/]*)\/([^\/]*)\/?.*$/,"/image_assets/$1/$2/?asset_id=$3")+"&size="+(t||500)),0===e.search(/^https?\:\/\/[^\/]*\/public/)&&(e=-1!==e.search(/size/)?e.replace(/^https?\:\/\/[^\/]*\/public\/libraries\/([^\/]*)\/([^\/]*)\/?(\:rendition)?.*size\=([^&]*).*$/,"/image_assets/public/adobe-libraries/$1/?asset_id=$2&size=$4"):e.replace(/^https?\:\/\/[^\/]*\/public\/libraries\/([^\/]*)\/([^\/]*)\/?.*$/,"/image_assets/public/adobe-libraries/$1/?asset_id=$2")+"&size="+(t||500)),e):void 0}}]),e}()},164:function(e,t,i){var n,r;n=[i(16),i(9),i(11),i(2),i(1),i(33),i(104),i(37),i(111),i(332),i(17),i(301),i(103),i(35),i(173)],void 0===(r=function(e,t,i,n,r,o,a,s,c,l,u,d,h,g,f){"use strict";var m=g.SparkPerformanceTracker;return i.Model.extend({defaultCfg:{syncGroup:"",scope:"",newDocName:"Untitled",community:"",doctype:"",legacyName:"",displayName:""},registeredName:null,deferredLoading:null,initialize:function(){},typeName:null,getConfig:function(){},getAppTypeID:function(){return this.getSetting("scope")},isaProjectFormat:function(){return!0},getDisplayName:function(e){var t=this.getSetting("displayName");return e?u.getString("product-name")+" "+t:t},isEnabled:function(){var e=this.getSetting("enabledFlagName");return!e||o.hasFeature(e)},supportsCollaboration:function(){return!0},requiresDocumentLocking:function(e){return this.supportsCollaboration()},supportsDownload:function(){return!0},appSupportsEditorSearch:function(){return!1},supportsDirectDownload:function(){return"post"===this.typeName},supportsAsyncPublish:function(){return!1},getSetting:function(e){var t=this.getConfig()[e];return void 0===t&&(t=this.defaultCfg[e]),t},getCPCommunity:function(){return this.getConfig().community},isDocPublished:function(e){return!!this.getCPAlias(e)},generateCPProjectId:function(e){return e.get("id")},setCPProjectId:function(e,t){e.saveChanges(function(e){e.setValue("cp#projectId",t)}.bind(this))},getCPProjectId:function(e){return e.getDCXRoot().getValue("cp#projectId")},getCPAlias:function(e){return e.getDCXRoot().getValue("cp#shortId")},setCPAlias:function(e,t){return e.saveChanges((function(e){e.setValue("cp#shortId",t)}))},getCPAssetId:function(e){return e.getDCXRoot().getValue("cp#assetId")},setCPAssetId:function(e,t){return e.saveChanges((function(e){e.setValue("cp#assetId",t)}))},getDocContentETag:function(e){return console.error("ERROR: Apps must implement getDocContentETag in appImpl"),""},getPublishedContentETag:function(e){return e.getDCXRoot().getValue("cp#publishedEtag")},setPublishedContentETag:function(e,t){return e.saveChanges(function(i){i.setValue("cp#publishedEtag",t||this.getDocContentETag(e))}.bind(this))},usesContentModifiedEtags:function(){return!0},isBrowserSupported:function(){return!0},getUnsupportedBrowserMessage:function(){return""},hasContentBeenUpdatedSincePublish:function(e,t){n.defer();var i=this.getDocContentETag(e);if(i){var r=this.getPublishedContentETag(e);return!r||i!==r}return e.getContentModifiedDate({preferCpContentModified:!0})-new Date(t)>6e4},setProjectName:function(e,t){console.error("ERROR: Apps must implement setProjectName in appImpl")},getProjectName:function(e,t){return this!==e.getMyPrimaryApp()?e.getMyPrimaryApp().getProjectName(e,t):(console.error("ERROR: Apps must implement getProjectName in appImpl"),"")},checkDocCompatibility:function(e,t){return n.resolve()},getLicensableResources:function(e,i){return i=i||{},this.getImageComponentsInfoForDoc(e).then(function(e){return t.isUndefined(i.licensed)?t.filter(e,this.licensingRelevant.bind(this)):i.licensed?t.filter(e,this._isInfoComponentLicensed.bind(this)):t.filter(e,function(e){return this.licensingRelevant(e)&&this._isInfoComponentUnlicensed(e)}.bind(this))}.bind(this))},batchCheckLicenses:function(e,{tryToLicense:t}={}){const i=[];let r;const o=e.getMyApp().getAppTypeID(),s=t;let c,l;return c=s?a.getStockUserInfo(o):a.getStockBlocked(o),n.all([c,this.getImageComponentsInfoForDoc(e,{ifKnownConstrainedOnly:!0})]).then(function(e){l=e[0];const t=!s&&e[0]||"",o=e[1].reduce(function(e,n){const o=n.data.licenseType||n.data.license&&n.data.license.type;if(o&&o.match(/^royalty_free/)){const a=n.data.assetID||n.data.license.asset_id||n.data.license.image_id;if(a){if(t)throw r=t,new Error("User blocked from stock");o.match(/^royalty_free_(standard|extended|limited)$/)?e.push(a):i.push(a+"")}}return e}.bind(this),[]);return o.length>0?s?d.verifyOrLicenseIdsForUser(o,l):d.getBatchLicenseInfo(o,o):s?n.resolve({lists:d.getDefaultBatchLicenseInfo()}):n.resolve(d.getDefaultBatchLicenseInfo())}.bind(this)).then((function(e){if(window.marvel.logger.traceflow("stock-license-check","batchCheckLicenses:"+JSON.stringify(e)),s){if(e.error){let t="error";return e.error.containsMegaPremiumImages?t="cant-upgrade":e.error.userNotPremium?t=l.canSeeLimited?"upgrade":"cant-upgrade":e.error.containsNoLongerAvailableImages?t="no-longer-available":e.subError&&e.subError.maxDailyFreeQuotaReached&&(t="free-quota"),{stockBlockType:t}}return e.lists}return e.unlicensed=[...e.unlicensed,...i,...e.freeUnlicensed,...e.noLongerAvailable],e})).catch((function(e){return r||window.marvel.logger.warn("batchCheckLicenses - caught exception:",{message:e&&e.message,stack:e&&e.stack}),{stockBlockType:r||"error"}}))},getImageExportAnalyticsIfDocLoaded:function(e){return n.resolve()},getBatchLicenseInfoForExport:function(e){e.sort();var t=e.join(",");this.stockExportInfoCache||(this.stockExportInfoCache={});var i=this.stockExportInfoCache[t];return i||(i=d.getBatchLicenseInfoForExport(e)),i},getImageMetadataForAnalytics:function(e){l.default&&(l=l.default);var i={google:0,dropbox:0,dooplo:0,facebook:0,stock:0,adobestock:0,creativeCloud:0,lightroom:0,uploaded:0,publicLibrary:0,privateLibrary:0,sharedLibrary:0,cclight:0},r="post"!==e.getMyApp().typeName;return n.all([this.getImageComponentsInfoForDoc(e)]).then(function(e){var o,a=e[0],s=!1,c=!1,u=[],d=[];return t.each(a,function(e){var t,r=e&&e.data&&(e.data.srcName||e.data.source);if(r&&(t=i[r],i[r]=t+1),this.licensingRelevant(e)){var o=e.data.asset_id||e.data.assetID||e.data.license&&e.data.license.image_id;d.push(o),this._isInfoComponentLicensed(e)?c=!0:s=!0}if(e&&e.data&&e.data.library_id){var a,h=e.data.library_id;if(0===h.search(/^urn:/)){var g=l.getCachedLibraryById(h);a=g?n.resolve(g):l.fetchLibraryByUrn(h)}else a=n.resolve({isPublic:function(){return!0}});u.push(a)}else u.push(n.resolve(null))}.bind(this)),d.length&&(o=this.getBatchLicenseInfoForExport(d),u.unshift(o)),n.allSettled(u).then(function(e){var t=0,n=0;e.forEach((function(e,r){if("fulfilled"===e.state){var a=e.value;a&&(o&&!r?a.forEach((function(e){1===e.premium_level_id?t++:n++})):a.isPublic()?i.publicLibrary+=1:a.belongsToUser()?i.privateLibrary+=1:a.isSharedWithUser()&&(i.sharedLibrary+=1))}else{var s=e.reason;o&&!r?window.marvel.logger.warn("[AppImpl] Failed to fetch stock export license info ",s):window.marvel.logger.warn("[AppImpl] Failed to fetch library ",s)}}));var a=[];i.sharedLibrary>0&&a.push("shared"),i.publicLibrary>0&&a.push("public"),i.privateLibrary>0&&a.push("personal");var l=a.length>0?"cclType: ["+a.join(", ")+"]":"",u=["freeStockImages:"+t,"paidStockImages:"+n],d={contextualData13:"hasLicensedImages:"+c,contextualData14:"hasUnlicensedImages:"+s,contextualData15:"hasGoogleImages:"+!!i.google,contextualData16:"hasDropboxImages:"+!!i.dropbox,contextualData17:"hasDooploImages:"+!!i.dooplo,contextualData18:"hasFacebookImages:"+!!i.facebook,contextualData19:"hasStockAssets:["+u.join(",")+"]",contextualData21:"hasLightroomImages:"+!!i.lightroom,contextualData22:"hasUploadedImages:"+!!i.uploaded,contextualData23:"hasCCLightDesignAssets:"+!!i.cclight,contextualData29:l};return r&&(d.contextualData20="hasCCImages:"+!!i.creativeCloud),d}.bind(this))}.bind(this))},getCollabTypeAnalytic:function(e,i,n){var r=[],o=e.getCollaboration(),a="INCOMING"===o||"OUTGOING"===o;return t.isString(i)&&i.match(/cclType:.*shared.*/)&&r.push("sharedLibrary"),t.isString(i)&&i.match(/cclType:.*personal.*/)&&r.push("personalLibrary"),t.isString(i)&&i.match(/cclType:.*public.*/)&&r.push("publicLibrary"),a?(r.push("sharedProject"),n&&r.push("sharedBranding")):n&&r.push("personalBranding"),0===r.length&&r.push("none"),"collabType: ["+r.join(", ")+"]"},licensingRelevant:function(e){return!t.isEmpty(e.data.license)&&"Adobe Stock"===e.data.license.source_name||"Adobe Stock"===e.data.srcName||"stock"===e.data.srcName},_isInfoComponentLicensed:function(e){return!(!e.data||t.isEmpty(e.data.license))&&"royalty_free"!==(t.isObject(e.data.license)?e.data.license.type:e.data.license)},_isInfoComponentUnlicensed:function(e){return!this._isInfoComponentLicensed(e)},getImageComponentsInfoForDoc:function(e){return e.getImageComponents()},lazyLoad:function(e){},load:function(){return this.deferredLoading||(this.deferredLoading=n.defer(),m.measurePromise("LoadingAppImpl:"+this.typeName,this.deferredLoading.promise),this.lazyLoad(this.deferredLoading)),this.deferredLoading.promise},loadForShare:function(e,t){},loadDesignView:function(e,i){this.load().then(function(){var n,r=this.getStorageImpl();i.showPreview?(n=new this.viewCls,e.renderSubView(n,r,i)):r.createDocument(i).then(function(t){n=new this.viewCls,e.renderSubView(n,r,i)}.bind(this),function(n){if(window.marvel.logger.warn("[AppImpl] Failed to create the document, can't init design view: ",n),"NO_COMPOSITE"!==n.code&&"NOT_COMPATIBLE"!==n.code&&"USER_CANCELED"!==n.code)e.errorState(),t.delay(function(){this.loadDesignView(e,i)}.bind(this),5e3);else{var r=u.getString("organizer-error-not-found");n.msg=n.usermsg||r,window.marvel.events.trigger("mrvl-must-reload",n)}}.bind(this))}.bind(this))},cancelEditingSession:function(e){return n.resolve()},userIsActive:function(){this._onUserActive?this._onUserActive():window.marvel.logger.traceflow("baton-timeout","appImpl.userIsActive is a no op. Project is not shared.")},beginLongUserActivity:function(){this._onBeginLongUserActivity?this._onBeginLongUserActivity():window.marvel.logger.traceflow("baton-timeout","applImpl.beginLongUserActivity is a no op. Project is not shared.")},endLongUserActivity:function(e){this._onEndLongUserActivty?this._onEndLongUserActivty(e):window.marvel.logger.traceflow("baton-timeout","appImpl.endLongUserActivity is a no op. Project is not shared.")},wrapLongUserActivity:function(e,t){window.marvel.logger.traceflow("baton-timeout","wrapLongUserActivity start for "+e),this.beginLongUserActivity(),t.finally(function(){window.marvel.logger.traceflow("baton-timeout","wrapLongUserActivity end for "+e),this.endLongUserActivity()}.bind(this))},isCollaborationEnabled:function(){return!!this._isCollaborationEnabled},onEditorActive:function(e,i,n){this._isCollaborationEnabled=!0,this._onUserActive=t.throttle(e,1e3,{leading:!0,trailing:!1}),this._onBeginLongUserActivity=i,this._onEndLongUserActivty=n,window.addEventListener("touchstart",this._onUserActive,!0),window.addEventListener("mousedown",this._onUserActive,!0),window.addEventListener("pointerdown",this._onUserActive,!0),window.addEventListener("keydown",this._onUserActive,!0),window.addEventListener("scroll",this._onUserActive,!0),window.addEventListener("resize",this._onUserActive,!0)},offEditorActive:function(e){this._onBeginLongUserActivity=null,this._onEndLongUserActivty=null,window.removeEventListener("touchstart",this._onUserActive,!0),window.removeEventListener("mousedown",this._onUserActive,!0),window.removeEventListener("pointerdown",this._onUserActive,!0),window.removeEventListener("keydown",this._onUserActive,!0),window.removeEventListener("scroll",this._onUserActive,!0),window.removeEventListener("resize",this._onUserActive,!0),this._onUserActive=null},setAppViewImplCls:function(e){this.viewCls=e},setPublishImpl:function(e){this.publishImpl=e},getPublishImpl:function(){return this.publishImpl},setStorageImpl:function(e){this.storageImpl=e,e.getSetting=this.getSetting.bind(this),e.initSyncGroup()},getStorageImpl:function(){return this.storageImpl},resetDocPublishData:function(e,i){var r=e.getMyApp(),o=[r.setCPAlias(e,null),r.setCPAssetId(e,null)];n.allSettled(o).then((function(e){var n=[];t.each(e,(function(e){"fulfilled"!==e.state&&n.push(e.reason)})),0===n.length?i.resolve():i.reject(n)}))},clearDataForDocCreatedByDupe:function(e){e.clearRootDataWithPrefix("cp#")},handleBrowserUnsupported:function(t,i){var r=n.defer(),o=e('<div data-auto="browser-unsupported-message"/>').html(this.getUnsupportedBrowserMessage()),a=navigator.userAgent||"N/A";return s.trackEvent("unsupportedBrowserMsgShown",{contextString:t,userAgent:a,projectType:this.getAppTypeID()},i),h.showAlert("Darn, you need to switch browsers",o,{closeDefer:r,okText:"Ok, got it"}).then(function(){r.resolve()}.bind(this)),r.promise},requestAppCreateNew:function(e,t,i){var r=n.defer();return this.isEnabled()?this.isBrowserSupported()?((i=i||{}).contextString=e,i.projectType=this.getAppTypeID(),window.marvel._isInApp?(s.trackEvent("projectCreationBegin",i,t),marvel.events.trigger("show-interstitial",{typeName:this.typeName,afterShowingDefer:r}),r.promise.then(function(){marvel.navigate("design/"+this.typeName+"/new",{trigger:!0})}.bind(this)).done()):s.trackLink("projectCreationBegin",i,t,function(){window.location.href=u.getLocalizedSparkPath("/sp/design/"+this.typeName+"/new")}.bind(this)),!0):(this.handleBrowserUnsupported(),!1):(alert(this.getDisplayName()+" is coming soon."),!1)},hasLicensedResources:function(e){return this.getImageComponentsInfoForDoc(e).then(function(e){return!!t.find(e,function(e){return this._isInfoComponentLicensed(e)}.bind(this))}.bind(this))},updateLicensedResources:function(e,t){return console.warn("TBD: update images in mrvlDoc."),n.resolve()},appSupportsUpdateLicensedResources:function(e){return!1},unlicenseResources:function(e){return console.warn("TBD: unlicese images in mrvlDoc"),n.resolve()},getAuthoringContextId:function(e){return e.getDCXRoot().getValue("authctx#ctxid")},getAuthoringContextName:function(e){return e.getDCXRoot().getValue("authctx#ctxname")},setAuthoringContextIdAndUrn:function(e,t,i){if(e.belongsToUser()){var r=t&&t.getId(),o=t&&t.getURN();if(window.marvel.logger.traceflow("authCtx","setAuthoringContextIdAndUrn",{docId:e.id,oldAuthCtxId:this.getAuthoringContextId(e),newAuthCtxId:r,oldAuthCtxURN:this.getAuthoringContextUrn(e),newAuthCtxURN:o,skipSave:i}),i){var a=e.getDCXRoot();return a.setValue("authctx#ctxid",r),a.setValue("authctx#ctxurn",o),n.resolve()}return e.saveChanges(function(e){e.setValue("authctx#ctxid",r),e.setValue("authctx#ctxurn",o)}.bind(this))}return marvel.logger.warn("AuthoringContext.setAuthoringContextIdAndUrn error: attempted to set authctx#ctxid and authctx#ctxurn for a project that is an incoming collaboration"),n.resolve()},setAuthoringContextId:function(e,t,i){return e.belongsToUser()?(window.marvel.logger.traceflow("authCtx","setAuthoringContextId",{docId:e.id,oldAuthCtxId:this.getAuthoringContextId(e),newAuthCtxId:t,skipSave:i}),i?(e.getDCXRoot().setValue("authctx#ctxid",t),n.resolve()):e.saveChanges(function(e){e.setValue("authctx#ctxid",t)}.bind(this))):(marvel.logger.warn("AuthoringContext.setAuthoringContextId error: attempted to set authctx#ctxid for a project that is an incoming collaboration"),n.resolve())},getAuthoringContextUrn:function(e){return e.getDCXRoot().getValue("authctx#ctxurn")},setAuthoringContextUrn:function(e,t){var i=0,r=function(e,t){return e.belongsToUser()?this.getAuthoringContextUrn(e)!==t?(window.marvel.logger.traceflow("authCtx","setAuthoringContextUrn",{docId:e.id,oldAuthCtxUrn:this.getAuthoringContextUrn(e),newAuthCtxUrn:t,retryCount:i}),i>0?e.pull():n.resolve().then(function(){return e.saveChanges(function(e){e.setValue("authctx#ctxurn",t)}.bind(this))}.bind(this))):n.resolve():(marvel.logger.warn("AuthoringContext.setAuthoringContextUrn error: attempted to set authctx#ctxurn for a project that is an incoming collaboration"),n.resolve())}.bind(this);return window.marvel.logger.traceflow("authCtx","setAuthoringContextUrn",{docId:e.id,oldAuthCtxUrn:this.getAuthoringContextUrn(e),newAuthCtxUrn:t}),f(r.bind(this),{maxAttempts:2,shouldRetry:function(e){return!!(e&&e.message&&e.message.includes("UPDATE_CONFLICT"))||(window.marvel.logger.warn("[appImpl:setAuthoringContextUrn] unexpected error, not retrying",e),!1)},counter_cb:function(){i++},loggerFn:window.marvel.logger.warn.bind(window.marvel.logger),logMessagePrefix:"[appImpl:setAuthoringContextUrn]"})(e,t)},getContentSummary:function(e){return n.resolve()},setAuthoringContextUrnFromBrandId:function(e,t){var i=t.getId(),r=this.getAuthoringContextUrn(e);return i&&!r?e.saveChanges(function(e){e.setValue("authctx#ctxurn",t.getURN())}.bind(this)):n.resolve()},isBranded:function(e){var t=!!e.getDCXRoot().getValue("authctx#uses-branded-elements");return n.resolve(t)},getDOMComponent:function(e){var i,n=e.getDCXComposite();return n&&(i=t.find(n.current.allComponents(),(function(e){return e&&"dom"===e.relationship}))),i||console.warn("Post: Failed to retrieve DOM: ",e),i},hasPremiumFontSources:function(e){return n.resolve(!1)},hasPremiumDesignAssets:function(e){return this.getImageComponentsInfoForDoc(e).then((function(e){return 0===e.length?n.resolve(!1):n.resolve(e.some((function(e){return"premium"===e.data.type})))})).catch((function(){return n.resolve(!1)}))},hasPremiumIngredients:function(e){return n.spread([this.hasPremiumFontSources(e),this.hasPremiumDesignAssets(e)],(function(e,t){return e||t}))},premiumIsRequired:function(e){return n.all(this.isBranded(e),this.hasPremiumIngredients(e)).spread((function(e,t){return e||t}))},getAuthoringContextThemeId:function(e){return e.getDCXRoot().getValue("authctx#themeid")},setAuthoringContextThemeId:function(e,t,i){return i?(e.getDCXRoot().setValue("authctx#themeid",t),n.resolve()):e.saveChanges(function(e){e.setValue("authctx#themeid",t)}.bind(this))},stripBranding:function(e,t){return(o.hasFeature("enable-multi-brand")?n.resolve():this.setAuthoringContextIdAndUrn(e,null,!0)).then(function(){return this.setAuthoringContextThemeId(e,null,!0).then(function(){return t?(e.getDCXRoot().setValue("authctx#uses-branded-elements",!1),n.resolve()):e.saveChanges(function(e){e.setValue("authctx#uses-branded-elements",!1)}.bind(this))}.bind(this))}.bind(this))},rebrandProject:function(e,t,i){return this.stripBranding(e,i).then(function(){return this.setAuthoringContextIdAndUrn(e,t,i)}.bind(this))},beforeCollaboration:function(e){return n.resolve()},hasUploadedFonts:function(e){return this._hasFontSource(e,"user-uploaded")},_hasFontSource:function(e,i){return this.getFontsUsed?this.getFontsUsed(e).then((function(e){return!!t.find(e||[],(function(e){return e&&e.source===i}))})):this.includesUploadedFonts&&"user-uploaded"===i?n.resolve(this.includesUploadedFonts(e)):n.resolve(!1)},getLastPublishedAuthoringContextId:function(e){return e.getDCXRoot().getValue("authctx#lastPublishedAuthctxid")},setLastPublishedAuthoringContextId:function(e,t){return e.saveChanges(function(e){e.setValue("authctx#lastPublishedAuthctxid",t)}.bind(this))},isaThemeEditor:function(){return this.isaProjectFormat()},getThemeController:function(e){return n.resolve({initTheme:function(e,t){},renderCover:function(e,t){},areAssetsUsed:function(e,t){},updateLinkedAssets:function(e,t){},relinkAsset:function(e,t){},getNumberOfGeneratedThemes:function(){return n.resolve(-1)},getGeneratedThemes:function(){return n.resolve([])},generateThemeRendition:function(e,t,i){t.fillStyle="#000000",t.fillRect(0,0,t.canvas.width,t.canvas.height)},canResolveConflict:function(e,t,i,r){return n.resolve(!1)},resolveAuthoringContextConflict:function(e,t,i,r,o){return n.resolve()}})},getThemeEditorView:function(){return n.resolve((function(){return this.render=function(){},this.setElement=function(){},this}))},getGeneratedThemes:function(e){return n.resolve([])},generateThemeRendition:function(e,t,i){t.fillStyle="#000000",t.fillRect(0,0,t.canvas.width,t.canvas.height)}})}.apply(t,n))||(e.exports=r)},1689:function(e,t,i){var n,r;n=[i(16),i(9),i(2),i(299)],void 0===(r=function(e,t,n,r){"use strict";var o={},a=0,s=function(){--a<0&&(a=0),a>0?e("html").addClass("ac-wf-loading"):e("html").removeClass("ac-wf-loading")};return{loadFont:function(c,l){var u,d,h,g;return++a>0?e("html").addClass("ac-wf-loading"):e("html").removeClass("ac-wf-loading"),u=t.isString(c)?c:(d=c).lookupKey(),o[u]?o[u]:(g=d?n.resolve(d):r.getFontRegistry().then((function(e){if(e.facesByKey[u]){var t=n.defer();return Promise.resolve().then(function(n){var r=new(i(686));r.setFontDataFromSparkFontDefn(e.facesByKey[u]),t.resolve(r)}.bind(null,i)).catch(i.oe),t.promise}var r="loadFont failed find face defn for "+u;return console.warn(r),n.reject(r)})),h=n.defer(),o[u]=h.promise,g.then(function(e){return"spark-provided"!==e.source()||r.USE_SPARKFONTS_PREVIEW_API&&e.tkPreviewId()?"tk-synced"===e.source()||"spark-provided"===e.source()?r.inject().then((function(){setTimeout((function(){h.resolve(e)}),3e3);var t={id:e.tkPreviewId(),variations:e.tkVariation(),css_name:e.cssName(),name:e.friendlyName()};return window.TypekitPreview.load([t],{active:function(){h.resolve(e)},inactive:function(e,t){var i="error loading typekit preview font "+e+" and "+t;console.warn(i),h.reject(i)},fontinactive:function(e,t){var i="error-inactive loading typekit preview font "+e+" and "+t;console.warn(i),h.reject(i)}}),!0})):"user-uploaded"==e.source()?this._loadUploadedFont(e).then((function(){h.resolve(e)}),(function(e){h.reject(e)})):(console.warn("ATTEMPT TO LOAD FONT FACE WITH UNKNOW SOURCE "+e.source()),void h.reject("Unknown font source")):r.inject().then((function(){h.resolve(e)}))}.bind(this)).done(),h.promise.finally(s),o[u])},_loadUploadedFont:function(i){var r,o="cls-"+i.cssName().replace(" ","-").replace(/\"/g,"")+"-"+i.fontWeight()+"-"+i.fontStyle(),a=document.head.querySelectorAll("style."+o)[0],s="font-css-"+o;if(!a&&(a=this._createStyleBlock(o),window.localStorage)){try{r=window.localStorage.getItem(s)}catch(u){}var c,l;return r?(a.innerHTML=r,c=n.defer(),(l=e("<div class='font-loading-measure'>AbcdeFghijklmnoPqrstuvWxyz</div>")).css({position:"fixed",visibility:"hidden",top:"-1000px",left:"-1000px","font-size":"30px","font-style":i.fontStyle(),"font-weight":i.fontWeight()}),e("body").append(l),i.$css(l),t.delay((function(){l.remove(),c.resolve()}),500),c.promise):this._loadFontAjax(i).then((function(r){return i.getCSSFontFaceAsync(!0,r).then(function(r){a.innerHTML=r;try{window.localStorage.setItem(s,r)}catch(u){}return c=n.defer(),(l=e("<div class='font-loading-measure'>AbcdeFghijklmnoPqrstuvWxyz</div>")).css({position:"fixed",visibility:"hidden",top:"-1000px",left:"-1000px","font-size":"30px","font-style":i.fontStyle(),"font-weight":i.fontWeight()}),e("body").append(l),i.$css(l),t.delay((function(){l.remove(),c.resolve()}),500),c.promise}.bind(this))}),function(e){return i.getCSSFontFaceAsync().then(function(e){a.innerHTML=e}.bind(this))}.bind(this))}return n.resolve()},_loadFontAjax:function(t){var i=n.defer();return t.getHrefAsync(void 0,!0).then(function(t){window.marvel.logger.info("[AuthoringContextFontLoader] Downloading font via href: "+t),e.ajax({url:t,type:"GET",mimeType:"text/plain; charset=x-user-defined"}).done(function(e,t,n){var r="data:"+(n.getResponseHeader("content-type")||"application/x-font-opentype")+";base64,"+this._base64Encode(e);i.resolve(r)}.bind(this)).fail((function(e,t,n){console.warn("ERROR loading font file: ",n),i.reject(n)}))}.bind(this)).catch((function(e){i.reject(e)})).done(),i.promise},_base64Encode:function(e){for(var t,i,n,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o="",a=0,s=e.length;a<s;){if(t=255&e.charCodeAt(a++),a==s){o+=r.charAt(t>>2),o+=r.charAt((3&t)<<4),o+="==";break}if(i=e.charCodeAt(a++),a==s){o+=r.charAt(t>>2),o+=r.charAt((3&t)<<4|(240&i)>>4),o+=r.charAt((15&i)<<2),o+="=";break}n=e.charCodeAt(a++),o+=r.charAt(t>>2),o+=r.charAt((3&t)<<4|(240&i)>>4),o+=r.charAt((15&i)<<2|(192&n)>>6),o+=r.charAt(63&n)}return o},_createStyleBlock:function(e){var t=document.createElement("style");return t.type="text/css",t.className=e,document.getElementsByTagName("head")[0].appendChild(t),t}}}.apply(t,n))||(e.exports=r)},1965:function(e,t,i){var n,r;n=[i(16),i(9),i(2),i(11)],void 0===(r=function(e,t,i,n){"use strict";var r;return r=n.Collection.extend({setAC:function(e){this._ac=e},initialize:function(e,t){var i=n.Collection.prototype.initialize.call(this,e,t);return t&&t.feel&&(this._feel=t.feel),i},getFeel:function(){return this._feel},add:function(e,i){var r=n.Collection.prototype.add.call(this,e,i);return t.isArray(e)||(e=[e]),i&&i.genericRoles&&t.each(e,function(e){e._genericRoles=i.genericRoles}.bind(this)),i&&i.uniqueRoles&&t.each(e,function(e){e._uniqueRoles=i.uniqueRoles}.bind(this)),r},getPropFromFirst:function(e){var t=this.at(0);if(t[e])return"function"==typeof t[e]?t[e]():t.getData().getValue(e)},getCSSFontFaceAsync:function(e){var t="",n=[];return this.each((function(i){n.push(i.getCSSFontFaceAsync(e).then((function(e){t+=e})))})),i.allSettled(n).then((function(){return t}))},loadFonts:function(){var e=new r,i=new r;if(this.each((function(t){t.isSparkFont()?e.add(t):i.add(t)})),e.length&&e.each((function(e){e.loadFont()})),i.length){var n=i.getPropFromFirst("cssName");i.getCSSFontFaceAsync().then((function(e){var i=document.createElement("style");i.type="text/css",i.innerHTML=e,i.className=n;var r=document.head.querySelectorAll("style."+n);r&&t.each(r,(function(e){e.parentNode.removeChild(e)})),document.getElementsByTagName("head")[0].appendChild(i)}))}},getFontWithRole:function(e){return this.find((function(i){return i.hasRole&&"function"==typeof i.hasRole?i.hasRole(e):i._uniqueRoles&&!!t.find(i._uniqueRoles,(function(t){return t==e}))||i._genericRoles&&!!t.find(i._genericRoles,(function(t){return t==e}))}))}})}.apply(t,n))||(e.exports=r)},2030:function(e,t,i){var n,r;n=[i(16),i(9),i(2),i(11)],void 0===(r=function(e,t,i,n){"use strict";return n.Model.extend({valueProp:"ac#value",getRoles:function(){return this._data.getValue("ac#roles")||[]},setRoles:function(e){this._data.setValue("ac#roles",e)},hasRole:function(e){var i=this.getRoles();return t.includes(i,e)},hasAnyRole:function(e){var i=this.getRoles();return!!t.find(i,(function(i){return t.includes(e,i)}))},addRole:function(e){var i=this.getRoles();t.includes(i,e)||(i.push(e),this.setRoles(i))},removeRole:function(e){var i=this.getRoles();i=t.without(i,e),this.setRoles(i)},setAC:function(e){this._ac=e},getAC:function(){return this._ac},setData:function(e){this._data=e},getData:function(){return this._data},getId:function(){return this._data.id},setValue:function(e){this._data.setValue(this.valueProp,e)},_getValue:function(){return this._data.getValue(this.valueProp)},getValue:function(){return this._getValue()},getValueProp:function(e,t){var i=this.getValue();return i&&i[e]?i[e]:t||""},setName:function(e){this._data.setValue("name",e)},getName:function(){return this._data.getValue("name")}})}.apply(t,n))||(e.exports=r)},2155:function(e,t,i){var n;n=function(e){"use strict";var t,i=(t=document.createElement("canvas").getContext("2d"),(window.devicePixelRatio||1)/(t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1)),n=function(e,t,n){n||(n=i);var r=document.createElement("canvas");return r.width=e*n,r.height=t*n,r.style.width=e+"px",r.style.height=t+"px",r.getContext("2d").setTransform(n,0,0,n,0,0),r},r=function(t,i){var n=e("<span>"+t.replace(/</g,"&lt;").replace(/>/g,"&gt;")+"</span>").css({font:i,float:"left","white-space":"nowrap"}).css({visibility:"hidden"}).appendTo(e("body")),r=n.width();return n.remove(),r},o=function(e,t,i){var o=i.size||24,a=i.weight||"400",s=i.style||"normal",c=i.lineHeight||1.5,l=i.padding||0,u=i.color||"#35414C",d=s+" "+a+" "+o+"px "+e,h=s+" "+a+" 8px "+e,g=8*c,f=r(t,h),m=n(f,g,0),p=m.getContext("2d");m.height=g,m.width=f,p.font=h,p.fillStyle=u,p.textBaseline="middle",p.fillText(t,0,g/2),p.fillRect(0,0,10,10);for(var v=p.getImageData(0,0,f,g).data,b=0,y=0,w=v.length/2,C=!1,M=0,L=v.length;M<L;)v[M],v[M+1],v[M+2],0!=v[M+3]&&b++,(M+=4)>=w&&!C&&(C=!0,y=b,b=0);var k=y/b,x=o*c+2*l,N=r(t,d)+2*l,T=x/2;return k>1.8&&k<2?T+=.1*o:k>=2&&(T+=.18*o),p=(m=n(N,x)).getContext("2d"),m.height=x,m.width=N,p.font=d,p.fillStyle=u,p.textBaseline="middle",p.fillText(t,l,T),m.whiteSpaceRatio=k,m};return{generateCanvas:o,generateDataURL:function(){var e=o.apply(this,arguments);return e.toDataURL()}}},e.exports=n(i(16))},2156:function(e,t,i){var n,r;n=[i(16),i(9),i(2),i(2030),i(686),i(1689),i(299),i(2157)],void 0===(r=function(e,t,i,n,r,o,a,s){"use strict";var c=["headline-font","body-font","body-font-bold","body-font-italic","body-font-bold-italic"];return n.extend({type:"font",valueProp:"font#data",isDefn:function(){return!1},getHrefAsync:function(e,t){return this._ac._hrefForCustomFontAsync(this.getData(),e)},getFileAsBlob:function(e,t){var n=i.defer();return this.getHrefAsync(e,t).then(function(e){var t=new XMLHttpRequest;t.onreadystatechange=function(){4==this.readyState&&200==this.status&&n.resolve(this.response)},t.onerror=function(e){n.reject(e)},t.open("GET",e),t.responseType="blob",t.send()}.bind(this)).catch((function(e){n.reject(e)})).done(),n.promise},getRenditionHrefAsync:function(e,t,i){var n="face-rendition";return t?n="family-rendition":i&&(n="rendition"),this._ac._hrefForCustomFontRenditionAsync(this.getData(),n).then(function(t){return e&&t&&(t=t.indexOf("/assets/")>0?t.replace(/^https?\:\/\/[^\/]+\/image_assets\/[^\/]+\/[^\/]+\/(.*)$/,"$1"):t.replace(/^https?\:\/\/[^\/]+\/image_assets\/[^\/]+\/(.*)$/,"$1")),t}.bind(this))},friendlyName:function(e){var t;if(this.isSparkFont()){var i=s.faces[this.lookupKey()];t=i.subgroupName+" "+i.name}else t=this._data.getValue("name")||"Undefined";return e?-1!=t.search(/^clarendon/i)||-1!=t.search(/^raleway/i)||-1!=t.search(/^wanderlust/i)?t.split(" ")[0]:t.split(" ").slice(0,2).join(" "):t},setUniqueBodyFontRole:function(e){this._ac.getCustomFontSubgroup(this.subgroupName()).each((function(t){t.removeRole(e)})),this.addRole(e)},subgroupName:function(){return this.isSparkFont()?s.faces[this.lookupKey()].subgroupName:this.getValueProp("subgroupName")},faceName:function(){return this.isSparkFont()?s.faces[this.lookupKey()].name:this.getValueProp("faceName")},setFontFromDefn:function(e,t,i){i=i||this.getData(),t=t||this.getValue(),"tk-synced"==e._fontData.source?(t.source=e.source(),t.lookupKey=e.lookupKey(),t.subgroupName=e.subgroupName(),t.cssName=e.cssName(),t.weight=e.fontWeight(),t.style=e.fontStyle(),t.tkPreviewId=e.tkPreviewId(),t.tkVariation=e.tkVariation(),t.tkSubgroupKitId=e.tkSubgroupKitId(),i.setValue("name",e.friendlyName())):(t.source=e.source(),t.lookupKey=e.lookupKey())},setLookupKey:function(e){var t=this._getValue();"object"==typeof e&&"tk-synced"===e.type?this._setTypekitSyncedFont(e,t):t.lookupKey=e,this.setValue(t)},createFont:function(e,t){var i=this._ac.composite.acquireNestedMapSync("all-fonts"),n=this._ac.composite.addChildPath(void 0,void 0,i),r={};return n.setValue("type","application/vnd.adobe.element.custom-font+dcx"),n.setValue("ac#application","spark-web"),n.setValue("ac#roles",t),this.setFontFromDefn(e,r,n),this._data=n,n.setValue("font#data",r),n.setValue(this.valueProp,r),n},createFromElement:function(e,t){var i=e.getValue(this.valueProp).lookupKey,n=new r;n.setFontDataFromSparkFontDefn(t.facesByKey[i]),this._data=this.createFont(n,e.getValue("ac#roles"))},source:function(){return this.getValueProp("source")},isCustomFont:function(){return"user-uploaded"==this.source()},isSparkFont:function(){return"spark-provided"==this.source()},isFauxFont:function(){return"faux-font"==this.source()},isBodyFont:function(){return this.hasAnyRole(["body-font-italic","body-font-bold-italic","is-body-font-italic","is-body-font-bold-italic","body-font","body-font-bold","is-body-font","is-body-font-bold"])},getMetricsAsync:function(){return this.isCustomFont()?i.resolve(this.getMetrics()):this.getMetricsFromRegistry()},getMetrics:function(){return this.getValueProp("metrics")},getMetricsFromRegistry:function(){return a.getFontRegistry().then(function(e){return e.facesByKey[this.lookupKey()].face.metrics}.bind(this))},lookupKey:function(){return this.isCustomFont()&&this._data?"custom-"+this._data.path:this.getValueProp("lookupKey")},uiKey:function(){return"custom-"+this.getId()},tkPreviewId:function(){var e=this.getValueProp("tkPreviewId");if(!e&&this.isSparkFont()){var t=s.faces[this.lookupKey()];e=s.subgroups[t.subgroupName].typekitPreviewId}return e},tkVariation:function(){var e=this.getValueProp("tkVariation");!e&&this.isSparkFont()&&(e=s.faces[this.lookupKey()].typekitKey);return e},tkSubgroupKitId:function(){var e=this.getValueProp("tkSubgroupKitId");if(!e&&this.isSparkFont()){var t=s.faces[this.lookupKey()];e=s.subgroups[t.subgroupName].typekitSubgroupKitId}return e},cssName:function(){if(this.isSparkFont()){var e=s.faces[this.lookupKey()];return s.subgroups[e.subgroupName].cssName}return this.getValueProp("cssName")||'"'+this.friendlyName()+'"'},cssNameForPreview:function(){var e=this.cssName();return"tk-synced"===this.source()&&(e=this.tkPreviewId()),e},fontStyle:function(){if(this.isSparkFont()){if(!this.getValueProp("fontStyle")){return{n:"normal",i:"italic"}[this.tkVariation().split("")[0]]}}else if(this.isCustomFont()||this.isFauxFont()){if(this.hasRole("body-font-italic")||this.hasRole("body-font-bold-italic")||this.hasRole("is-body-font-italic")||this.hasRole("is-body-font-bold-italic"))return"italic";if(this.hasRole("body-font")||this.hasRole("body-font-bold")||this.hasRole("is-body-font")||this.hasRole("is-body-font-bold"))return"normal";var e=this.getMetrics();if(e&&e.style)return e.style}return this.getValueProp("fontStyle","normal")},fontWeight:function(){if(this.isSparkFont()){if(!this.getValueProp("fontWeight")){var e=this.tkVariation().split(""),t=parseInt(e[1]);return t<1&&(t=1),t>9&&(t=9),100*t}}else if(this.isCustomFont()||this.isFauxFont()){if(this.hasRole("body-font")||this.hasRole("body-font-italic")||this.hasRole("is-body-font")||this.hasRole("is-body-font-italic"))return 400;if(this.hasRole("body-font-bold")||this.hasRole("body-font-bold-italic")||this.hasRole("is-body-font-bold")||this.hasRole("is-body-font-bold-italic"))return 700;var i=this.getMetrics();if(i&&i.weight)return i.weight}return this.getValueProp("fontWeight","normal")},getCSSFontFaceAsync:function(e,t){var i=this.cssName();return i||(i=this.friendlyName().toLowerCase()),this.getHrefAsync().then(function(n){return(t=t||n)?(e&&(t=t.indexOf("/assets/")>0?t.replace(/https?\:\/\/[^\/]*\/image_assets\/[^\/]*\/[^\/]*\/(.*)$/,"$1"):t.replace(/https?\:\/\/[^\/]*\/image_assets\/[^\/]*\/(.*)$/,"$1")),"@font-face { font-family: "+i+";font-weight:"+this.fontWeight()+";font-style:"+this.fontStyle()+';src: url("'+t+'"); }'):void 0}.bind(this))},loadFont:function(){var e=this.source();return"user-uploaded"==e?o.loadFont(this,this._ac):"spark-provided"==e?o.loadFont(this.lookupKey(),this._ac):i.resolve()},$loadFontCSS:function(e,i,n,r){var o=!1;i=i||18,t.delay((function(){o||e.addClass("font-loading")}),50),this.loadFont().finally(function(){o=!0;var t=a.getFontNormalized(i,this.getMetrics());e.css("font-size",t.size+"px"),n&&e.css("line-height",1.94*i+t.vshift+"px"),r&&e.css("height",1.94*i+t.vshift+"px"),this.$css(e,",adobe-clean,sans-serif"),e.removeClass("font-loading")}.bind(this)).done()},$cssRendition:function(e,t,i,n){r.prototype.$cssRendition.call(this,e,t,i,n)},$css:function(t,i){var n=this.cssName();i=i||"","tk-synced"!==this.source()&&"spark-provided"!==this.source()||(n=n||this.tkPreviewId()),(t=e(t)).css({"font-family":n+i,"font-style":this.fontStyle(),"font-weight":this.fontWeight()})},createOrUpdateFontFiles:function(e){return this._ac.createOrUpdateFontFiles(this.getData(),e)},generateRenditions:function(){return this._ac.generateFontRenditions(this)},getUniqueRole:function(){return this.getUniqueRoles()[0]},getUniqueRoles:function(){var e=this.getRoles();return t.intersection(e,c)},getTOUAName:function(){return this.subgroupName()+" "+this.faceName()},isInstallable:function(){var e=this.getMetrics().fsType,t=this.getTOUAName();try{var i=Number.parseInt(e),n=15&i;if(0===n)return window.marvel.logger.traceflow("brand-kit","verifyFonts fsType="+i+"  licenseType=0 so no upload is required"),!0;window.marvel.logger.traceflow("brand-kit","verifyFonts fsType="+n+" so font upload is required for "+t)}catch(r){window.marvel.logger.warn("BrandKitWrapper failed verifying font license",r)}return!1}})}.apply(t,n))||(e.exports=r)},2157:function(e){e.exports=JSON.parse('{"subgroups":{"Acumin Pro Semi Condensed":{"subgroupName":"Acumin Pro Semi Condensed","cssName":"acumin-pro-semi-condensed","typekitPreviewId":"zhgz","typekitSubgroupKitId":"oed0yfm","paragraphRecommended":true,"faces":[{"typekitKey":"n3","name":"Light","lookupKey":"258dc19d287f38402246a43ef7ee15db90408ab0d5e9ce6170e4797f99816d","weight":"300","style":"","subgroupName":"Acumin Pro Semi Condensed"},{"typekitKey":"i3","name":"Light Italic","lookupKey":"258dc19d287f38402246a43ef7ee15db90408ab0d5e9ce6170e4797f99816d23b74c91cf9a8b","weight":"300","style":"italic","subgroupName":"Acumin Pro Semi Condensed"},{"typekitKey":"n6","name":"Semibold","lookupKey":"258dc19d287f38402246a43ef7ee15db90408ab0d5e9ce6170e4667393807b6c925c","weight":"600","style":"","subgroupName":"Acumin Pro Semi Condensed"},{"typekitKey":"i6","name":"Semibold Italic","lookupKey":"258dc19d287f38402246a43ef7ee15db90408ab0d5e9ce6170e4667393807b6c925cd0ea87899a41d2","weight":"600","style":"italic","subgroupName":"Acumin Pro Semi Condensed"}]},"Adobe Caslon Pro":{"subgroupName":"Adobe Caslon Pro","cssName":"adobe-caslon-pro","typekitPreviewId":"hmqz","typekitSubgroupKitId":"qhv3iqj","paragraphRecommended":true,"faces":[{"typekitKey":"n4","name":"Regular","lookupKey":"258adb9224315b712345eb03b2d30e94fe7d81b3c5ebdc76","weight":"400","style":"","subgroupName":"Adobe Caslon Pro"},{"typekitKey":"i4","name":"Italic","lookupKey":"258adb9224315b712345eb03b2d30e94fe6690b5dceede","weight":"400","style":"italic","subgroupName":"Adobe Caslon Pro"},{"typekitKey":"n6","name":"Semibold","lookupKey":"258adb9224315b712345eb03b2d30e94fe7c81b9d9e5d26870","weight":"600","style":"","subgroupName":"Adobe Caslon Pro"},{"typekitKey":"i6","name":"Semibold Italic","lookupKey":"258adb9224315b712345eb03b2d30e94fe7c81b9d9e5d26870e97c629f857060","weight":"600","style":"italic","subgroupName":"Adobe Caslon Pro"},{"typekitKey":"n7","name":"Bold","lookupKey":"258adb9224315b712345eb03b2d30e94fe6d8bb8d4","weight":"700","style":"","subgroupName":"Adobe Caslon Pro"},{"typekitKey":"i7","name":"Bold Italic","lookupKey":"258adb9224315b712345eb03b2d30e94fe6d8bb8d4a7f47075a55c75","weight":"700","style":"italic","subgroupName":"Adobe Caslon Pro"}]},"Azo Sans":{"subgroupName":"Azo Sans","cssName":"azo-sans-web","typekitPreviewId":"lyqy","typekitSubgroupKitId":"ppn2tqp","paragraphRecommended":false,"faces":[{"typekitKey":"n3","name":"Light","lookupKey":"2594dbd0127076637d65ed0afaf7","weight":"300","style":"","subgroupName":"Azo Sans"},{"typekitKey":"i3","name":"Light Italic","lookupKey":"2594dbd0127076637d65ed0afaf75cb2a74e88bdd3","weight":"300","style":"italic","subgroupName":"Azo Sans"},{"typekitKey":"n7","name":"Bold","lookupKey":"2594dbd0127076637d6beb01f6","weight":"700","style":"","subgroupName":"Azo Sans"},{"typekitKey":"i7","name":"Bold Italic","lookupKey":"2594dbd0127076637d6beb01f6a3358fb2438db7","weight":"700","style":"italic","subgroupName":"Azo Sans"}]},"Bellfort Script":{"subgroupName":"Bellfort Script","cssName":"spark-bellfort-script","typekitPreviewId":false,"typekitSubgroupKitId":"vpr2ezi","paragraphRecommended":false,"faces":[{"typekitKey":"n3","name":"Light","lookupKey":"268bd89c277e6a64707ae71ffbf308d69f4683bcc4","weight":"300","style":"","subgroupName":"Bellfort Script"},{"typekitKey":"n4","name":"Regular","lookupKey":"268bd89c277e6a64707ae71ffbf308d6814a83a1dce6cf","weight":"400","style":"","subgroupName":"Bellfort Script"}]},"Calluna":{"subgroupName":"Calluna","cssName":"calluna","typekitPreviewId":"vybr","typekitSubgroupKitId":"pwy8yyx","paragraphRecommended":true,"faces":[{"typekitKey":"n4","name":"Regular","lookupKey":"278fd89c347f793d024ce318fee20e","weight":"400","style":"","subgroupName":"Calluna"},{"typekitKey":"i4","name":"Italic","lookupKey":"278fd89c347f793d195de501fbe0","weight":"400","style":"italic","subgroupName":"Calluna"},{"typekitKey":"n7","name":"Bold","lookupKey":"278fd89c347f793d1246e809","weight":"700","style":"","subgroupName":"Calluna"},{"typekitKey":"i7","name":"Bold Italic","lookupKey":"278fd89c347f793d1246e809b2ca089abf4687","weight":"700","style":"italic","subgroupName":"Calluna"}]},"Clarendon Text Pro":{"subgroupName":"Clarendon Text Pro","cssName":"clarendon-text-pro","typekitPreviewId":"kctd","typekitSubgroupKitId":"tes3lrh","paragraphRecommended":false,"faces":[{"typekitKey":"n4","name":"Regular","lookupKey":"2782d582247f7c7f3e09d008eaf75caba140c986d5e0c86875bb","weight":"400","style":"","subgroupName":"Clarendon Text Pro"},{"typekitKey":"i4","name":"Italic","lookupKey":"2782d582247f7c7f3e09d008eaf75caba140c99dc4e6d16d77","weight":"400","style":"italic","subgroupName":"Clarendon Text Pro"},{"typekitKey":"n7","name":"Bold","lookupKey":"2782d582247f7c7f3e09d008eaf75caba140c996dfebd9","weight":"700","style":"","subgroupName":"Clarendon Text Pro"},{"typekitKey":"i7","name":"Bold Italic","lookupKey":"2782d582247f7c7f3e09d008eaf75caba140c996dfebd9245dbd547a978a","weight":"700","style":"italic","subgroupName":"Clarendon Text Pro"}]},"Courier Std":{"subgroupName":"Courier Std","cssName":"courier-std","typekitPreviewId":"jxcp","typekitSubgroupKitId":"oeu5sen","paragraphRecommended":false,"faces":[{"typekitKey":"n4","name":"Regular","lookupKey":"2781c18228746a30035de040c0e61b8ebf4e96","weight":"400","style":"","subgroupName":"Courier Std"},{"typekitKey":"n7","name":"Bold","lookupKey":"2781c18228746a30035de040d0ec109f","weight":"700","style":"","subgroupName":"Courier Std"}]},"Didot Headline":{"subgroupName":"Didot Headline","cssName":"spark-didot-headline","typekitPreviewId":false,"typekitSubgroupKitId":"gkw8jcv","paragraphRecommended":false,"faces":[{"typekitKey":"n4","name":"Regular","lookupKey":"2087d09f35315075314de804fce651a9b64891b8d1f5","weight":"400","style":"","subgroupName":"Didot Headline"},{"typekitKey":"n6","name":"Demi","lookupKey":"2087d09f35315075314de804fce651bfb6428d","weight":"600","style":"","subgroupName":"Didot Headline"},{"typekitKey":"n7","name":"Bold","lookupKey":"2087d09f35315075314de804fce651b9bc4380","weight":"700","style":"","subgroupName":"Didot Headline"}]},"Futura PT":{"subgroupName":"Futura PT","cssName":"futura-pt","typekitPreviewId":"ftnk","typekitSubgroupKitId":"icc1sfj","paragraphRecommended":false,"faces":[{"typekitKey":"n5","name":"Medium","lookupKey":"229bc085337038400404c908f6ea0996","weight":"500","subgroupName":"Futura PT"},{"typekitKey":"n7","name":"Heavy","lookupKey":"229bc085337038400404cc08f3f505","weight":"700","style":"","subgroupName":"Futura PT"}]},"Lato":{"subgroupName":"Lato","cssName":"lato","typekitPreviewId":"jxfv","typekitSubgroupKitId":"oea2wtv","paragraphRecommended":true,"faces":[{"typekitKey":"n3","name":"Light","lookupKey":"288fc09f6c5d7177385d","weight":"300","subgroupName":"Lato"},{"typekitKey":"n4","name":"Regular","lookupKey":"288fc09f6c437d772545e51f","weight":"400","subgroupName":"Lato"},{"typekitKey":"i4","name":"Italic","lookupKey":"288fc09f6c586c713c40e7","weight":"400","style":"italic","subgroupName":"Lato"},{"typekitKey":"n7","name":"Bold","lookupKey":"288fc09f6c53777c34","weight":"700","subgroupName":"Lato"},{"typekitKey":"i9","name":"Black Italic","lookupKey":"288fc09f6c5374713342a424e6e21092b0","weight":"900","style":"italic","subgroupName":"Lato"}]},"Local Brewery":{"subgroupName":"Local Brewery","cssName":"spark-local-brewery","typekitPreviewId":false,"typekitSubgroupKitId":"vfd3hup","paragraphRecommended":false,"faces":[{"typekitKey":"n7","name":"Bold","lookupKey":"2881d7912d315a62355ee11febae3e94bf4b","weight":"700","style":"","subgroupName":"Local Brewery"}]},"Local Brewery Four":{"subgroupName":"Local Brewery Four","cssName":"spark-local-brewery-four","typekitPreviewId":false,"typekitSubgroupKitId":"txs8zsv","paragraphRecommended":false,"faces":[{"typekitKey":"n4","name":"Regular","lookupKey":"2881d7912d315a62355ee11feba33a94a65dc986d5e0c86875bb","weight":"400","subgroupName":"Local Brewery Four"}]},"LTC Bodoni 175":{"subgroupName":"LTC Bodoni 175","cssName":"ltc-bodoni-175","typekitPreviewId":"mrnw","typekitSubgroupKitId":"meq2xke","paragraphRecommended":false,"faces":[{"typekitKey":"n4","name":"Regular","lookupKey":"28baf7d0037e7c7f3e40a45ca5b651a9b64891b8d1f5","weight":"400","style":"","subgroupName":"LTC Bodoni 175"},{"typekitKey":"i4","name":"Italic","lookupKey":"28baf7d0037e7c7f3e40a45ca5b651b2a74e88bdd3","weight":"400","style":"italic","subgroupName":"LTC Bodoni 175"}]},"Museo Sans Rounded":{"subgroupName":"Museo Sans Rounded","cssName":"museo-sans-rounded","typekitPreviewId":"dtgx","typekitSubgroupKitId":"iuk5brd","paragraphRecommended":false,"faces":[{"typekitKey":"n5","name":"500","lookupKey":"299bc7952e314b713e5aa43ffdf6129fb64bc9e180b7","weight":"500","style":"","subgroupName":"Museo Sans Rounded"},{"typekitKey":"n7","name":"700","lookupKey":"299bc7952e314b713e5aa43ffdf6129fb64bc9e380b7","weight":"700","style":"","subgroupName":"Museo Sans Rounded"}]},"Museo Slab":{"subgroupName":"Museo Slab","cssName":"museo-slab","typekitPreviewId":"llxb","typekitSubgroupKitId":"gom8xuo","paragraphRecommended":true,"faces":[{"typekitKey":"n3","name":"300","lookupKey":"299bc7952e314b7c314ba95ea2b3","weight":"300","style":"","subgroupName":"Museo Slab"},{"typekitKey":"i3","name":"300 Italic","lookupKey":"299bc7952e314b7c314ba95ea2b35cb2a74e88bdd3","weight":"300","style":"italic","subgroupName":"Museo Slab"},{"typekitKey":"n7","name":"700","lookupKey":"299bc7952e314b7c314ba95aa2b3","weight":"700","style":"","subgroupName":"Museo Slab"},{"typekitKey":"i7","name":"700 Italic","lookupKey":"299bc7952e314b7c314ba95aa2b35cb2a74e88bdd3","weight":"700","style":"italic","subgroupName":"Museo Slab"},{"typekitKey":"n9","name":"1000","lookupKey":"299bc7952e314b7c314ba95ca2b34c","weight":"900","style":"","subgroupName":"Museo Slab"}]},"Proxima Nova":{"subgroupName":"Proxima Nova","cssName":"proxima-nova","typekitPreviewId":"vcsm","typekitSubgroupKitId":"yfs6lii","paragraphRecommended":true,"faces":[{"typekitKey":"n1","name":"Thin","lookupKey":"349cdb88287c79301e46f20cbfd71492bd","weight":"100","style":"","subgroupName":"Proxima Nova"},{"typekitKey":"i1","name":"Thin Italic","lookupKey":"349cdb88287c79301e46f20cbfd71492bd0fada0d1ebd467","weight":"100","style":"italic","subgroupName":"Proxima Nova"},{"typekitKey":"n3","name":"Light","lookupKey":"349cdb88287c79301e46f20cbfcf159cbb5b","weight":"300","style":"","subgroupName":"Proxima Nova"},{"typekitKey":"i3","name":"Light Italic","lookupKey":"349cdb88287c79301e46f20cbfcf159cbb5bc49dc4e6d16d77","weight":"300","style":"italic","subgroupName":"Proxima Nova"},{"typekitKey":"n4","name":"Regular","lookupKey":"349cdb88287c79301e46f20cbfd1199ca64385a6","weight":"400","style":"","subgroupName":"Proxima Nova"},{"typekitKey":"i4","name":"Regular Italic","lookupKey":"349cdb88287c79301e46f20cbfd1199ca64385a690cec96578a056","weight":"400","style":"italic","subgroupName":"Proxima Nova"},{"typekitKey":"n5","name":"Medium","lookupKey":"349cdb88287c79301e46f20cbfce199fba5a89","weight":"500","style":"","subgroupName":"Proxima Nova"},{"typekitKey":"i5","name":"Medium Italic","lookupKey":"349cdb88287c79301e46f20cbfce199fba5a89f4f9f3dc687daa","weight":"500","style":"italic","subgroupName":"Proxima Nova"},{"typekitKey":"n6","name":"Semibold","lookupKey":"349cdb88287c79301e46f20cbfd01996ba4d8bb8d4","weight":"600","style":"","subgroupName":"Proxima Nova"},{"typekitKey":"i6","name":"Semibold Italic","lookupKey":"349cdb88287c79301e46f20cbfd01996ba4d8bb8d4a7f47075a55c75","weight":"600","style":"italic","subgroupName":"Proxima Nova"},{"typekitKey":"n7","name":"Bold","lookupKey":"349cdb88287c79301e46f20cbfc11397b7","weight":"700","style":"","subgroupName":"Proxima Nova"},{"typekitKey":"i7","name":"Bold Italic","lookupKey":"349cdb88287c79301e46f20cbfc11397b70fada0d1ebd467","weight":"700","style":"italic","subgroupName":"Proxima Nova"},{"typekitKey":"n8","name":"Extrabold","lookupKey":"349cdb88287c79301e46f20cbfc6048fa14e86bbdce3","weight":"800","style":"","subgroupName":"Proxima Nova"},{"typekitKey":"i8","name":"Extrabold Italic","lookupKey":"349cdb88287c79301e46f20cbfc6048fa14e86bbdce39d4d60a8597f9d","weight":"800","style":"italic","subgroupName":"Proxima Nova"},{"typekitKey":"n9","name":"Black","lookupKey":"349cdb88287c79301e46f20cbfc1109ab044","weight":"900","style":"","subgroupName":"Proxima Nova"},{"typekitKey":"i9","name":"Black Italic","lookupKey":"349cdb88287c79301e46f20cbfc1109ab044c49dc4e6d16d77","weight":"900","style":"italic","subgroupName":"Proxima Nova"}]},"PT Sans":{"subgroupName":"PT Sans","cssName":"pt-sans","typekitPreviewId":"lllr","typekitSubgroupKitId":"sys1rxz","paragraphRecommended":true,"faces":[{"typekitKey":"n4","name":"Regular","lookupKey":"34ba94a3207f6b3d024ce318fee20e","weight":"400","style":"","subgroupName":"PT Sans"},{"typekitKey":"i4","name":"Italic","lookupKey":"34ba94a3207f6b3d195de501fbe0","weight":"400","style":"italic","subgroupName":"PT Sans"},{"typekitKey":"n7","name":"Bold","lookupKey":"34ba94a3207f6b3d1246e809","weight":"700","style":"","subgroupName":"PT Sans"},{"typekitKey":"i7","name":"Bold Italic","lookupKey":"34ba94a3207f6b3d1246e809b2ca089abf4687","weight":"700","style":"italic","subgroupName":"PT Sans"}]},"PT Sans Narrow":{"subgroupName":"PT Sans Narrow","cssName":"pt-sans-narrow","typekitPreviewId":"rmcr","typekitSubgroupKitId":"xfq6xbo","paragraphRecommended":false,"faces":[{"typekitKey":"n4","name":"Regular","lookupKey":"34ba94a3207f6b301e48f61ffdf451a9b64891b8d1f5","weight":"400","style":"","subgroupName":"PT Sans Narrow"},{"typekitKey":"n7","name":"Bold","lookupKey":"34ba94a3207f6b301e48f61ffdf451b9bc4380","weight":"700","style":"","subgroupName":"PT Sans Narrow"}]},"PT Serif":{"subgroupName":"PT Serif","cssName":"pt-serif","typekitPreviewId":"xcqq","typekitSubgroupKitId":"lyd0hdu","paragraphRecommended":true,"faces":[{"typekitKey":"n4","name":"Regular","lookupKey":"34ba94a3246371767d7be10ae7ef1d89","weight":"400","style":"","subgroupName":"PT Serif"},{"typekitKey":"i4","name":"Italic","lookupKey":"34ba94a3246371767d60f00cfeea1f","weight":"400","style":"italic","subgroupName":"PT Serif"},{"typekitKey":"n7","name":"Bold","lookupKey":"34ba94a3246371767d6beb01f6","weight":"700","style":"","subgroupName":"PT Serif"},{"typekitKey":"i7","name":"Bold Italic","lookupKey":"34ba94a3246371767d6beb01f6a3358fb2438db7","weight":"700","style":"italic","subgroupName":"PT Serif"}]},"Voltage":{"subgroupName":"Voltage","cssName":"spark-voltage","typekitPreviewId":false,"typekitSubgroupKitId":"cjx2klj","paragraphRecommended":false,"faces":[{"typekitKey":"n3","name":"Light","lookupKey":"3281d88420767d3d1c40e305e6","weight":"300","style":"","subgroupName":"Voltage"},{"typekitKey":"n4","name":"Regular","lookupKey":"3281d88420767d3d024ce318fee20e","weight":"400","style":"","subgroupName":"Voltage"},{"typekitKey":"n7","name":"Bold","lookupKey":"3281d88420767d3d1246e809","weight":"700","style":"","subgroupName":"Voltage"}]},"Wanderlust Shine":{"subgroupName":"Wanderlust Shine","cssName":"spark-wanderlust-shine","typekitPreviewId":false,"typekitSubgroupKitId":"etu6mud","paragraphRecommended":false,"faces":[{"typekitKey":"n4","name":"Regular","lookupKey":"338fda9424637465235da43efaea129efe7d81b3c5ebdc76","weight":"400","subgroupName":"Wanderlust Shine"}]},"Raleway":{"subgroupName":"Raleway","cssName":"raleway","typekitPreviewId":"nqdy","typekitSubgroupKitId":"mce7zxv","paragraphRecommended":false,"faces":[{"typekitKey":"n4","name":"Regular","lookupKey":"368fd8953670613d024ce318fee20e","weight":"400","subgroupName":"Raleway"},{"typekitKey":"n9","name":"Heavy","lookupKey":"368fd8953670613d184ce51beb","weight":"900","subgroupName":"Raleway"}]}},"faces":{"258dc19d287f38402246a43ef7ee15db90408ab0d5e9ce6170e4797f99816d":{"typekitKey":"n3","name":"Light","lookupKey":"258dc19d287f38402246a43ef7ee15db90408ab0d5e9ce6170e4797f99816d","weight":"300","style":"","subgroupName":"Acumin Pro Semi Condensed"},"258dc19d287f38402246a43ef7ee15db90408ab0d5e9ce6170e4797f99816d23b74c91cf9a8b":{"typekitKey":"i3","name":"Light Italic","lookupKey":"258dc19d287f38402246a43ef7ee15db90408ab0d5e9ce6170e4797f99816d23b74c91cf9a8b","weight":"300","style":"italic","subgroupName":"Acumin Pro Semi Condensed"},"258dc19d287f38402246a43ef7ee15db90408ab0d5e9ce6170e4667393807b6c925c":{"typekitKey":"n6","name":"Semibold","lookupKey":"258dc19d287f38402246a43ef7ee15db90408ab0d5e9ce6170e4667393807b6c925c","weight":"600","style":"","subgroupName":"Acumin Pro Semi Condensed"},"258dc19d287f38402246a43ef7ee15db90408ab0d5e9ce6170e4667393807b6c925cd0ea87899a41d2":{"typekitKey":"i6","name":"Semibold Italic","lookupKey":"258dc19d287f38402246a43ef7ee15db90408ab0d5e9ce6170e4667393807b6c925cd0ea87899a41d2","weight":"600","style":"italic","subgroupName":"Acumin Pro Semi Condensed"},"258adb9224315b712345eb03b2d30e94fe7d81b3c5ebdc76":{"typekitKey":"n4","name":"Regular","lookupKey":"258adb9224315b712345eb03b2d30e94fe7d81b3c5ebdc76","weight":"400","style":"","subgroupName":"Adobe Caslon Pro"},"258adb9224315b712345eb03b2d30e94fe6690b5dceede":{"typekitKey":"i4","name":"Italic","lookupKey":"258adb9224315b712345eb03b2d30e94fe6690b5dceede","weight":"400","style":"italic","subgroupName":"Adobe Caslon Pro"},"258adb9224315b712345eb03b2d30e94fe7c81b9d9e5d26870":{"typekitKey":"n6","name":"Semibold","lookupKey":"258adb9224315b712345eb03b2d30e94fe7c81b9d9e5d26870","weight":"600","style":"","subgroupName":"Adobe Caslon Pro"},"258adb9224315b712345eb03b2d30e94fe7c81b9d9e5d26870e97c629f857060":{"typekitKey":"i6","name":"Semibold Italic","lookupKey":"258adb9224315b712345eb03b2d30e94fe7c81b9d9e5d26870e97c629f857060","weight":"600","style":"italic","subgroupName":"Adobe Caslon Pro"},"258adb9224315b712345eb03b2d30e94fe6d8bb8d4":{"typekitKey":"n7","name":"Bold","lookupKey":"258adb9224315b712345eb03b2d30e94fe6d8bb8d4","weight":"700","style":"","subgroupName":"Adobe Caslon Pro"},"258adb9224315b712345eb03b2d30e94fe6d8bb8d4a7f47075a55c75":{"typekitKey":"i7","name":"Bold Italic","lookupKey":"258adb9224315b712345eb03b2d30e94fe6d8bb8d4a7f47075a55c75","weight":"700","style":"italic","subgroupName":"Adobe Caslon Pro"},"2594dbd0127076637d65ed0afaf7":{"typekitKey":"n3","name":"Light","lookupKey":"2594dbd0127076637d65ed0afaf7","weight":"300","style":"","subgroupName":"Azo Sans"},"2594dbd0127076637d65ed0afaf75cb2a74e88bdd3":{"typekitKey":"i3","name":"Light Italic","lookupKey":"2594dbd0127076637d65ed0afaf75cb2a74e88bdd3","weight":"300","style":"italic","subgroupName":"Azo Sans"},"2594dbd0127076637d6beb01f6":{"typekitKey":"n7","name":"Bold","lookupKey":"2594dbd0127076637d6beb01f6","weight":"700","style":"","subgroupName":"Azo Sans"},"2594dbd0127076637d6beb01f6a3358fb2438db7":{"typekitKey":"i7","name":"Bold Italic","lookupKey":"2594dbd0127076637d6beb01f6a3358fb2438db7","weight":"700","style":"italic","subgroupName":"Azo Sans"},"268bd89c277e6a64707ae71ffbf308d69f4683bcc4":{"typekitKey":"n3","name":"Light","lookupKey":"268bd89c277e6a64707ae71ffbf308d69f4683bcc4","weight":"300","style":"","subgroupName":"Bellfort Script"},"268bd89c277e6a64707ae71ffbf308d6814a83a1dce6cf":{"typekitKey":"n4","name":"Regular","lookupKey":"268bd89c277e6a64707ae71ffbf308d6814a83a1dce6cf","weight":"400","style":"","subgroupName":"Bellfort Script"},"278fd89c347f793d024ce318fee20e":{"typekitKey":"n4","name":"Regular","lookupKey":"278fd89c347f793d024ce318fee20e","weight":"400","style":"","subgroupName":"Calluna"},"278fd89c347f793d195de501fbe0":{"typekitKey":"i4","name":"Italic","lookupKey":"278fd89c347f793d195de501fbe0","weight":"400","style":"italic","subgroupName":"Calluna"},"278fd89c347f793d1246e809":{"typekitKey":"n7","name":"Bold","lookupKey":"278fd89c347f793d1246e809","weight":"700","style":"","subgroupName":"Calluna"},"278fd89c347f793d1246e809b2ca089abf4687":{"typekitKey":"i7","name":"Bold Italic","lookupKey":"278fd89c347f793d1246e809b2ca089abf4687","weight":"700","style":"italic","subgroupName":"Calluna"},"2782d582247f7c7f3e09d008eaf75caba140c986d5e0c86875bb":{"typekitKey":"n4","name":"Regular","lookupKey":"2782d582247f7c7f3e09d008eaf75caba140c986d5e0c86875bb","weight":"400","style":"","subgroupName":"Clarendon Text Pro"},"2782d582247f7c7f3e09d008eaf75caba140c99dc4e6d16d77":{"typekitKey":"i4","name":"Italic","lookupKey":"2782d582247f7c7f3e09d008eaf75caba140c99dc4e6d16d77","weight":"400","style":"italic","subgroupName":"Clarendon Text Pro"},"2782d582247f7c7f3e09d008eaf75caba140c996dfebd9":{"typekitKey":"n7","name":"Bold","lookupKey":"2782d582247f7c7f3e09d008eaf75caba140c996dfebd9","weight":"700","style":"","subgroupName":"Clarendon Text Pro"},"2782d582247f7c7f3e09d008eaf75caba140c996dfebd9245dbd547a978a":{"typekitKey":"i7","name":"Bold Italic","lookupKey":"2782d582247f7c7f3e09d008eaf75caba140c996dfebd9245dbd547a978a","weight":"700","style":"italic","subgroupName":"Clarendon Text Pro"},"2781c18228746a30035de040c0e61b8ebf4e96":{"typekitKey":"n4","name":"Regular","lookupKey":"2781c18228746a30035de040c0e61b8ebf4e96","weight":"400","style":"","subgroupName":"Courier Std"},"2781c18228746a30035de040d0ec109f":{"typekitKey":"n7","name":"Bold","lookupKey":"2781c18228746a30035de040d0ec109f","weight":"700","style":"","subgroupName":"Courier Std"},"2087d09f35315075314de804fce651a9b64891b8d1f5":{"typekitKey":"n4","name":"Regular","lookupKey":"2087d09f35315075314de804fce651a9b64891b8d1f5","weight":"400","style":"","subgroupName":"Didot Headline"},"2087d09f35315075314de804fce651bfb6428d":{"typekitKey":"n6","name":"Demi","lookupKey":"2087d09f35315075314de804fce651bfb6428d","weight":"600","style":"","subgroupName":"Didot Headline"},"2087d09f35315075314de804fce651b9bc4380":{"typekitKey":"n7","name":"Bold","lookupKey":"2087d09f35315075314de804fce651b9bc4380","weight":"700","style":"","subgroupName":"Didot Headline"},"229bc085337038400404c908f6ea0996":{"typekitKey":"n5","name":"Medium","lookupKey":"229bc085337038400404c908f6ea0996","weight":"500","subgroupName":"Futura PT"},"229bc085337038400404cc08f3f505":{"typekitKey":"n7","name":"Heavy","lookupKey":"229bc085337038400404cc08f3f505","weight":"700","style":"","subgroupName":"Futura PT"},"288fc09f6c5d7177385d":{"typekitKey":"n3","name":"Light","lookupKey":"288fc09f6c5d7177385d","weight":"300","subgroupName":"Lato"},"288fc09f6c437d772545e51f":{"typekitKey":"n4","name":"Regular","lookupKey":"288fc09f6c437d772545e51f","weight":"400","subgroupName":"Lato"},"288fc09f6c586c713c40e7":{"typekitKey":"i4","name":"Italic","lookupKey":"288fc09f6c586c713c40e7","weight":"400","style":"italic","subgroupName":"Lato"},"288fc09f6c53777c34":{"typekitKey":"n7","name":"Bold","lookupKey":"288fc09f6c53777c34","weight":"700","subgroupName":"Lato"},"288fc09f6c5374713342a424e6e21092b0":{"typekitKey":"i9","name":"Black Italic","lookupKey":"288fc09f6c5374713342a424e6e21092b0","weight":"900","style":"italic","subgroupName":"Lato"},"2881d7912d315a62355ee11febae3e94bf4b":{"typekitKey":"n7","name":"Bold","lookupKey":"2881d7912d315a62355ee11febae3e94bf4b","weight":"700","style":"","subgroupName":"Local Brewery"},"2881d7912d315a62355ee11feba33a94a65dc986d5e0c86875bb":{"typekitKey":"n4","name":"Regular","lookupKey":"2881d7912d315a62355ee11feba33a94a65dc986d5e0c86875bb","weight":"400","subgroupName":"Local Brewery Four"},"28baf7d0037e7c7f3e40a45ca5b651a9b64891b8d1f5":{"typekitKey":"n4","name":"Regular","lookupKey":"28baf7d0037e7c7f3e40a45ca5b651a9b64891b8d1f5","weight":"400","style":"","subgroupName":"LTC Bodoni 175"},"28baf7d0037e7c7f3e40a45ca5b651b2a74e88bdd3":{"typekitKey":"i4","name":"Italic","lookupKey":"28baf7d0037e7c7f3e40a45ca5b651b2a74e88bdd3","weight":"400","style":"italic","subgroupName":"LTC Bodoni 175"},"299bc7952e314b713e5aa43ffdf6129fb64bc9e180b7":{"typekitKey":"n5","name":"500","lookupKey":"299bc7952e314b713e5aa43ffdf6129fb64bc9e180b7","weight":"500","style":"","subgroupName":"Museo Sans Rounded"},"299bc7952e314b713e5aa43ffdf6129fb64bc9e380b7":{"typekitKey":"n7","name":"700","lookupKey":"299bc7952e314b713e5aa43ffdf6129fb64bc9e380b7","weight":"700","style":"","subgroupName":"Museo Sans Rounded"},"299bc7952e314b7c314ba95ea2b3":{"typekitKey":"n3","name":"300","lookupKey":"299bc7952e314b7c314ba95ea2b3","weight":"300","style":"","subgroupName":"Museo Slab"},"299bc7952e314b7c314ba95ea2b35cb2a74e88bdd3":{"typekitKey":"i3","name":"300 Italic","lookupKey":"299bc7952e314b7c314ba95ea2b35cb2a74e88bdd3","weight":"300","style":"italic","subgroupName":"Museo Slab"},"299bc7952e314b7c314ba95aa2b3":{"typekitKey":"n7","name":"700","lookupKey":"299bc7952e314b7c314ba95aa2b3","weight":"700","style":"","subgroupName":"Museo Slab"},"299bc7952e314b7c314ba95aa2b35cb2a74e88bdd3":{"typekitKey":"i7","name":"700 Italic","lookupKey":"299bc7952e314b7c314ba95aa2b35cb2a74e88bdd3","weight":"700","style":"italic","subgroupName":"Museo Slab"},"299bc7952e314b7c314ba95ca2b34c":{"typekitKey":"n9","name":"1000","lookupKey":"299bc7952e314b7c314ba95ca2b34c","weight":"900","style":"","subgroupName":"Museo Slab"},"349cdb88287c79301e46f20cbfd71492bd":{"typekitKey":"n1","name":"Thin","lookupKey":"349cdb88287c79301e46f20cbfd71492bd","weight":"100","style":"","subgroupName":"Proxima Nova"},"349cdb88287c79301e46f20cbfd71492bd0fada0d1ebd467":{"typekitKey":"i1","name":"Thin Italic","lookupKey":"349cdb88287c79301e46f20cbfd71492bd0fada0d1ebd467","weight":"100","style":"italic","subgroupName":"Proxima Nova"},"349cdb88287c79301e46f20cbfcf159cbb5b":{"typekitKey":"n3","name":"Light","lookupKey":"349cdb88287c79301e46f20cbfcf159cbb5b","weight":"300","style":"","subgroupName":"Proxima Nova"},"349cdb88287c79301e46f20cbfcf159cbb5bc49dc4e6d16d77":{"typekitKey":"i3","name":"Light Italic","lookupKey":"349cdb88287c79301e46f20cbfcf159cbb5bc49dc4e6d16d77","weight":"300","style":"italic","subgroupName":"Proxima Nova"},"349cdb88287c79301e46f20cbfd1199ca64385a6":{"typekitKey":"n4","name":"Regular","lookupKey":"349cdb88287c79301e46f20cbfd1199ca64385a6","weight":"400","style":"","subgroupName":"Proxima Nova"},"349cdb88287c79301e46f20cbfd1199ca64385a690cec96578a056":{"typekitKey":"i4","name":"Regular Italic","lookupKey":"349cdb88287c79301e46f20cbfd1199ca64385a690cec96578a056","weight":"400","style":"italic","subgroupName":"Proxima Nova"},"349cdb88287c79301e46f20cbfce199fba5a89":{"typekitKey":"n5","name":"Medium","lookupKey":"349cdb88287c79301e46f20cbfce199fba5a89","weight":"500","style":"","subgroupName":"Proxima Nova"},"349cdb88287c79301e46f20cbfce199fba5a89f4f9f3dc687daa":{"typekitKey":"i5","name":"Medium Italic","lookupKey":"349cdb88287c79301e46f20cbfce199fba5a89f4f9f3dc687daa","weight":"500","style":"italic","subgroupName":"Proxima Nova"},"349cdb88287c79301e46f20cbfd01996ba4d8bb8d4":{"typekitKey":"n6","name":"Semibold","lookupKey":"349cdb88287c79301e46f20cbfd01996ba4d8bb8d4","weight":"600","style":"","subgroupName":"Proxima Nova"},"349cdb88287c79301e46f20cbfd01996ba4d8bb8d4a7f47075a55c75":{"typekitKey":"i6","name":"Semibold Italic","lookupKey":"349cdb88287c79301e46f20cbfd01996ba4d8bb8d4a7f47075a55c75","weight":"600","style":"italic","subgroupName":"Proxima Nova"},"349cdb88287c79301e46f20cbfc11397b7":{"typekitKey":"n7","name":"Bold","lookupKey":"349cdb88287c79301e46f20cbfc11397b7","weight":"700","style":"","subgroupName":"Proxima Nova"},"349cdb88287c79301e46f20cbfc11397b70fada0d1ebd467":{"typekitKey":"i7","name":"Bold Italic","lookupKey":"349cdb88287c79301e46f20cbfc11397b70fada0d1ebd467","weight":"700","style":"italic","subgroupName":"Proxima Nova"},"349cdb88287c79301e46f20cbfc6048fa14e86bbdce3":{"typekitKey":"n8","name":"Extrabold","lookupKey":"349cdb88287c79301e46f20cbfc6048fa14e86bbdce3","weight":"800","style":"","subgroupName":"Proxima Nova"},"349cdb88287c79301e46f20cbfc6048fa14e86bbdce39d4d60a8597f9d":{"typekitKey":"i8","name":"Extrabold Italic","lookupKey":"349cdb88287c79301e46f20cbfc6048fa14e86bbdce39d4d60a8597f9d","weight":"800","style":"italic","subgroupName":"Proxima Nova"},"349cdb88287c79301e46f20cbfc1109ab044":{"typekitKey":"n9","name":"Black","lookupKey":"349cdb88287c79301e46f20cbfc1109ab044","weight":"900","style":"","subgroupName":"Proxima Nova"},"349cdb88287c79301e46f20cbfc1109ab044c49dc4e6d16d77":{"typekitKey":"i9","name":"Black Italic","lookupKey":"349cdb88287c79301e46f20cbfc1109ab044c49dc4e6d16d77","weight":"900","style":"italic","subgroupName":"Proxima Nova"},"34ba94a3207f6b3d024ce318fee20e":{"typekitKey":"n4","name":"Regular","lookupKey":"34ba94a3207f6b3d024ce318fee20e","weight":"400","style":"","subgroupName":"PT Sans"},"34ba94a3207f6b3d195de501fbe0":{"typekitKey":"i4","name":"Italic","lookupKey":"34ba94a3207f6b3d195de501fbe0","weight":"400","style":"italic","subgroupName":"PT Sans"},"34ba94a3207f6b3d1246e809":{"typekitKey":"n7","name":"Bold","lookupKey":"34ba94a3207f6b3d1246e809","weight":"700","style":"","subgroupName":"PT Sans"},"34ba94a3207f6b3d1246e809b2ca089abf4687":{"typekitKey":"i7","name":"Bold Italic","lookupKey":"34ba94a3207f6b3d1246e809b2ca089abf4687","weight":"700","style":"italic","subgroupName":"PT Sans"},"34ba94a3207f6b301e48f61ffdf451a9b64891b8d1f5":{"typekitKey":"n4","name":"Regular","lookupKey":"34ba94a3207f6b301e48f61ffdf451a9b64891b8d1f5","weight":"400","style":"","subgroupName":"PT Sans Narrow"},"34ba94a3207f6b301e48f61ffdf451b9bc4380":{"typekitKey":"n7","name":"Bold","lookupKey":"34ba94a3207f6b301e48f61ffdf451b9bc4380","weight":"700","style":"","subgroupName":"PT Sans Narrow"},"34ba94a3246371767d7be10ae7ef1d89":{"typekitKey":"n4","name":"Regular","lookupKey":"34ba94a3246371767d7be10ae7ef1d89","weight":"400","style":"","subgroupName":"PT Serif"},"34ba94a3246371767d60f00cfeea1f":{"typekitKey":"i4","name":"Italic","lookupKey":"34ba94a3246371767d60f00cfeea1f","weight":"400","style":"italic","subgroupName":"PT Serif"},"34ba94a3246371767d6beb01f6":{"typekitKey":"n7","name":"Bold","lookupKey":"34ba94a3246371767d6beb01f6","weight":"700","style":"","subgroupName":"PT Serif"},"34ba94a3246371767d6beb01f6a3358fb2438db7":{"typekitKey":"i7","name":"Bold Italic","lookupKey":"34ba94a3246371767d6beb01f6a3358fb2438db7","weight":"700","style":"italic","subgroupName":"PT Serif"},"3281d88420767d3d1c40e305e6":{"typekitKey":"n3","name":"Light","lookupKey":"3281d88420767d3d1c40e305e6","weight":"300","style":"","subgroupName":"Voltage"},"3281d88420767d3d024ce318fee20e":{"typekitKey":"n4","name":"Regular","lookupKey":"3281d88420767d3d024ce318fee20e","weight":"400","style":"","subgroupName":"Voltage"},"3281d88420767d3d1246e809":{"typekitKey":"n7","name":"Bold","lookupKey":"3281d88420767d3d1246e809","weight":"700","style":"","subgroupName":"Voltage"},"338fda9424637465235da43efaea129efe7d81b3c5ebdc76":{"typekitKey":"n4","name":"Regular","lookupKey":"338fda9424637465235da43efaea129efe7d81b3c5ebdc76","weight":"400","subgroupName":"Wanderlust Shine"},"368fd8953670613d024ce318fee20e":{"typekitKey":"n4","name":"Regular","lookupKey":"368fd8953670613d024ce318fee20e","weight":"400","subgroupName":"Raleway"},"368fd8953670613d184ce51beb":{"typekitKey":"n9","name":"Heavy","lookupKey":"368fd8953670613d184ce51beb","weight":"900","subgroupName":"Raleway"}}}')},224:function(e,t,i){var n;void 0===(n=function(){return{DOM_VK_BACK_SPACE:8,DOM_VK_TAB:9,DOM_VK_RETURN:13,DOM_VK_ENTER:14,DOM_VK_ESCAPE:27,DOM_VK_SPACE:32,DOM_VK_LEFT:37,DOM_VK_UP:38,DOM_VK_RIGHT:39,DOM_VK_DOWN:40}}.apply(t,[]))||(e.exports=n)},241:function(e,t,i){var n,r;n=[i(16),i(9),i(11),i(2),i(63),i(37),i(111),i(1),i(6),i(680),i(13),i(692),i(198)],void 0===(r=function(e,t,i,n,r,o,a,s,c,l,u,d,h){"use strict";var g=new c.default({color:"firebrick",name:"App Storage"});return i.Model.extend({seedNewDoc:function(e){},initialize:function(){this.initPromise=r.storageReady()},initSyncGroup:function(){this.initPromise=r.storageReady()},setSaveThumbOnLoad:function(){this._saveThumbOnLoad=!0},saveThumbOnLoad:function(){var e=this._saveThumbOnLoad;return this._saveThumbOnLoad=!1,e},_startingCreateDoc:function(){},releaseBatonLock:function(){return d.releaseBatonAndCloseSession(this.currentDoc)},_createDoc:function(e){this.currentDoc=null,this._startingCreateDoc(),this.initPromise.then(function(t){this.createDocFromConfig(t,e,this.creationDefer),e.assetId&&(this.rootObjectId=e.assetId)}.bind(this),function(e){this.creationDefer.reject(e)}.bind(this)).catch(function(e){this.creationDefer.reject(e)}.bind(this)).done()},createDocFromConfig:function(e,t,i){t.assetUrn?this._createDocLoad(t,i):this._createDocNewACP(t,i)},_createDocLoad:function(e,t){r.syncEnter();var i=this.getSetting("syncGroup");h.load().then(function(t){return t.ACPSparkController.getCompositeDoc(e.assetUrn).then(function(t){if(!t){var i=new Error("_createDocLoad failed to get composite doc with urn: "+e.assetUrn);throw i.code="NO_COMPOSITE",i}return t.getMyApp().checkDocCompatibility(t,"opening").then(function(){return this.currentDoc=t,n.resolve()}.bind(this))}.bind(this))}.bind(this)).then(function(){o.setCurrentProjectId(e.assetUrn||e.assetId);var n=o.getProductName()||i;o.trackEvent("editor:loadedProject",{contextData:["projectId"]},n+":editor"),r.setSyncMode(r.MODE_EDITOR,this.currentDoc),r.syncLeave(),marvel.events.trigger("loaded-composite-doc",this.currentDoc),a.augmentLoadDoc(this.currentDoc,e),t.resolve(this.currentDoc)}.bind(this)).catch(function(e){this.currentDoc=null,t.reject(e)}.bind(this)).done()},_createDocNew:function(e,t,i){return this._createDocNewACP(t,i)},_createDocNewACP:function(e,t){var i=this.getSetting("syncGroup"),n=r.dcx.newEmptyComposite(this.getSetting("newDocName"),this.getSetting("doctype"));return this.currentDoc=new l({name:n.current.name,id:n.id,syncGroupName:i,compositeObj:n}),r.setSyncMode(r.MODE_EDITOR,this.currentDoc),this._setProjectContexts(this.currentDoc,e),a.augmentLoadDoc(this.currentDoc,e),a.augmentNewDoc(this.currentDoc,e).then(function(){return this.seedNewDoc(this.currentDoc),t.resolve(this.currentDoc),!0}.bind(this))},_setProjectContexts:function(e,i){if(i&&i.hasOwnProperty("projectContext")&&t.isObject(i.projectContext)){var n=e.getDCXRoot();t.each(i.projectContext,function(e,t){n.setValue("projectContext#"+t,e),"useCaseId"===t&&this._saveLastUsedUseCaseSession(e)}.bind(this))}},getProjectContexts:function(e,i){if(!(e=e||this.currentDoc))return{};var n,r=e.getDCXRoot();return i?n=t.reduce(i,(function(e,i){var n=r.getValue("projectContext#"+i);return t.isUndefined(n)||(e[i]=n),e}),{}):(n={},t.each(r._data,(function(e,t){0===t.indexOf("projectContext#")&&(n[t.split("projectContext#")[1]]=e)}))),t.each(n,(function(e,t){if("string"==typeof e&&0===e.indexOf("object:"))try{e=JSON.parse(e.substring(7)),n[t]=e}catch(i){g.warn("could not parse projectContext subobject:"+t,i)}})),n},_saveLaunchConfigSession:function(e){if(window.sessionStorage)try{sessionStorage.setItem("launch_config_tmp",JSON.stringify(e))}catch(t){g.error("error while saving launch config",t)}},_getAndClearLaunchConfigFromSession:function(){var e;try{if(!window.sessionStorage)return null;var t=sessionStorage.getItem("launch_config_tmp")||void 0;t&&(e=JSON.parse(t),sessionStorage.removeItem("launch_config_tmp"))}catch(i){g.error("error while getting launch config",i)}return e},_saveLastUsedUseCaseSession:function(e){if(window.sessionStorage)try{sessionStorage.setItem("last_used_usecase",JSON.stringify(e))}catch(t){g.error("error while saving launch config",t)}},createDocument:function(e){return this.creationDefer=n.defer(),r.setSyncMode(r.MODE_DISABLED),this.currentDoc?r.waitForQuiet(this.currentDoc).then(function(){this._createDoc(e)}.bind(this)):this._createDoc(e),this.creationDefer.promise},waitForQuiet:function(e){return(e=e||this.currentDoc)?r.waitForQuiet(e):n.resolve()},loadDocument:function(){return this.creationDefer.promise},storageManager:function(){return r},editorUnloadFinished:function(){this.currentDoc=null},getImage:function(t,i,r,o){if(!(o=o||this.currentDoc))return console.error("no doc for getImage",{pathOrComponent:t,query:i,buster:r}),n.reject(new Error("no doc for getImage:"+t));var a,s=o.getDCXComposite();if(!(a="string"==typeof t?s.current.getComponentWithAbsolutePath(t):t))return n.resolve(null);var c=new n.defer;return o.getImageComponentHref(a,i.size).then(function(t){var i=0;!function n(){var r=document.createElement("img"),o=function(e,t,r){i<2?n():a(r,t,"Image not accepting URL")},a=function(e,t,i){var n=i,r=1;"Image not accepting URL"!==i&&(r=e.status),c.reject({message:n,status:r})};r.onload=function(){var e=t.replace(new RegExp("^.*image_assets/[^/]*/"+s.id+"/"),"");c.resolve({path:e,size:{width:r.width,height:r.height},img:this})},r.onerror=function(){e.get(t).success(o).error(a)},i++,r.src=t}()}.bind(this)).catch(function(e){window.marvel.logger.error("app-storage-base caught error loading an image",e),c.reject(e)}.bind(this)).done(),c.promise},getPreviewHrefAsync:function(e){var t=(e=e||this.currentDoc).getMyApp().getPreviewComponent(e);return t?e.getImageComponentHref(t):n.resolve("")}})}.apply(t,n))||(e.exports=r)},301:function(e,t,i){var n,r;n=[i(9),i(11),i(2),i(101),i(687),i(17),i(693),i(13),i(33),i(1)],void 0===(r=function(e,t,i,n,r,o,a,s,c,l){"use strict";const u=a.LibraryImageLinksModel,d="&result_columns%5B%5D=thumbnail_500_url&result_columns%5B%5D=thumbnail_500_width&result_columns%5B%5D=thumbnail_500_height",h="result_columns%5B%5D=title&result_columns%5B%5D=is_licensed&result_columns%5B%5D=content_type&result_columns%5B%5D=thumbnail_160_url&result_columns%5B%5D=thumbnail_160_width&result_columns%5B%5D=thumbnail_160_height&result_columns%5B%5D=comps&result_columns%5B%5D=creator_name&result_columns%5B%5D=id&result_columns%5B%5D=premium_level_id&result_columns%5B%5D=nb_results",g={Standard:"royalty_free_standard",Extended:"royalty_free_extended",Limited:"royalty_free_limited"};function f(e){this.result=null,this._reachedEnd=!1,this.collection=new t.Collection,this.collection.model=u,this._searchAPI=e||f.searchPath,this._lastOpts=null}function m(e,t,i){if(!e)throw new Error("Argument Error: Required data parameter must be non-null");this.data=e,this._items=[],this._modelAttrs=[],this.filter=t,this.addExtra=i,this._parseData()}function p(e,t){if(!e)throw new Error("Argument Error: Required data parameter must be non-null");this.data=e,this.addExtra=t,this.links={},this._parseData()}function v(e){return!!(e.comps&&e.comps.Standard&&e.comps.Standard.url||1===e.media_type_id||2===e.media_type_id)}function b(){const e=o.getLocale();return l.unsupportedStockLocales.includes(e)?"en_US":e}return f.apiHost=l.stockApiHost,f.cdnSearchHost=l.stockSearchCdnHost,f.searchPath="/Rest/Media/1/Search/Files",f.infoPath="/api/v1/assets/",f.profilePath="/Rest/Libraries/1/Member/Profile",f.itemLicensePath="/Rest/Libraries/1/Content/License",f.licenseHistoryPath="/Rest/Libraries/1/Member/LicenseHistory",f.bulkMetadataPath="/Rest/Media/1/Files",f.licenseHistorySearchQuery="<<<[[[***LICENSE HISTORY***]]]>>>",f.maxNumSimultaneousBatchRequests=10,e.extend(f.prototype,{_shouldWeTranslateSearchRequest:function({page:e,query:t,locale:i}){return(!e||1===e)&&(t!==f.licenseHistorySearchQuery&&(0!==t.trim().length&&-1!==l.unsupportedStockLocales.indexOf(i||o.getLocale())))},_getTranslatedSearchString:function({query:e}){return window.marvel.SearchController.getTranslatedSearchString({textToTranslate:e,translationType:"guessToUs",guessIfUs:!1})},search:function(t){var i;if(t.translation)e.isUndefined(t.translation.err)?(i=t.translation,(t=e.cloneDeep(t.originalOptions)).query=i.translatedText,this._lastTranslation=i):t=t.originalOptions;else if(this._shouldWeTranslateSearchRequest(t)){if(!this._lastTranslation||this._lastTranslation.translatedText!==t.query)return void this._getTranslatedSearchString(t).then(function(e){this.search({translation:e,originalOptions:t})}.bind(this),function(e){this.search({translation:{err:e},originalOptions:t})}.bind(this));i=this._lastTranslation}this.result=null;var a=t.query===f.licenseHistorySearchQuery,c=t.stockUserInfo,u=!!c,g=!a&&c&&c.eFilter,p=c&&!c.canLicenseLimited,v={page:1,size:100,asset_type:"image",image_filter:[],source:[]};this._searchAPI===f.searchPath&&(v.query="landscape");var b=this._getParams(v,t),y=t.success,w=t.error;function C(e,i){if(!i.is_licensed&&i.data.premium_level_id>1)return!1;var n=M||t.image_filter;return!(n&&n.length&&!n.includes(i.links.original.type))&&(e&&"Limited"===i.is_licensed&&(i.is_licensed="",i.data.is_licensed&&(i.data.is_licensed=""),"string"===i.data.license&&(i.data.license="")),!0)}var M,L=!1;var k=(t.useSearchCdn?f.cdnSearchHost:f.apiHost)+this._searchAPI;this._lastOpts=e.extend({},b,t);var x,N={"search_parameters[offset]":(b.page-1)*b.size,"search_parameters[limit]":b.size,"search_parameters[filters][content_type:photo]":1};if(a||(void 0===c?N["search_parameters[filters][free]"]="false":c.canSeeLimited?N["search_parameters[filters][premium]"]="false":N["search_parameters[filters][free]"]="true"),t.collectionId&&(N["search_parameters[gallery_id]"]=t.collectionId),g&&(N["search_parameters[filters][offensive:e]"]="true"),this._searchAPI===f.licenseHistoryPath?x="result_columns%5B%5D=thumbnail_160_url&result_columns%5B%5D=thumbnail_160_width&result_columns%5B%5D=thumbnail_160_height&result_columns%5B%5D=premium_level_id":(t.ids?N["search_parameters[words]"]="#"+t.ids.join(" #"):b.query&&(N["search_parameters[words]"]=b.query),x=h+"&locale="+(t.locale||o.getLocale())),t.collectionId&&(x+="&ff_3252454847=1",x+="&ff_9909481692=1"),c&&(x+="&ff_1612049839=1&ff_8832344448=1",c.canSeeLimited&&!c.canLicenseLimited&&(x+=d),!a&&c.canSeeLimited)){var T=c.canLicenseLimited?"paid":"free";N["search_parameters[user_type]"]=T}if(t.previewLargeThumbs&&(x+="&result_columns%5B%5D=thumbnail_240_url&result_columns%5B%5D=thumbnail_240_width&result_columns%5B%5D=thumbnail_240_height"),t.template){var I={},D=n.parse("?"+x,!0).query;Object.assign(N,D),t.template.includes("result_columns")||c&&c.canSeeLimited&&!c.canLicenseLimited&&(L=!0,N["search_parameters[thumbnail_size]"]=500),t.template.includes("search_parameters%5Bfilters%5D%5Bcontent_type%3Aphoto%5D")||(M=["jpg","jpeg","png","image/jpeg","image/png"]),e.each(N,(e,t)=>{I[encodeURIComponent(t)]=e}),N={},k=r.parse(t.template).expand(I)}else k=k+"?"+x;return s.ajax({url:k,data:N,beforeSend:function(e){return e.setRequestHeader("X-api-key",l.stockApiKey),e.setRequestHeader("X-Product",l.stockApiKey),e.setRequestHeader("X-Product-Location","search"),!0},dataType:"json",traditional:!0}).done(function(t,i,n){var r=null;if(!t||e.isEmpty(t))r=new Error("No data received");else if(t.error_code)r=new Error(t.message);else try{this.result=new m(t,"image"===b.asset_type?C.bind(this,p):null,u);var o=this.result.getLength();if(o){L&&this.result._items.forEach((function(e){e.data.thumbnail_500_url=e.data.thumbnail_url,e.data.thumbnail_500_width=e.data.thumbnail_width,e.data.thumbnail_500_height=e.data.thumbnail_height}));var a=t.files.length,s=a-o;1===b.page?(this.offset=a,this.numFilteredOut=s):(this.offset+=a,this.numFilteredOut+=s),this.collection.reset(this.result._modelAttrs),a>=this.result.data.nb_results&&(this._reachedEnd=!0),this.numFilteredOut&&(this.result.data.nb_results-=this.numFilteredOut)}else this._reachedEnd=!0}catch(c){r=c}r?w&&w(n,"error",r):y&&(u&&(this.result.data.total=this.result.data.nb_results),y(this.result,i,n))}.bind(this)).fail(w)},searchNextSet:function(t){return this._lastOpts.page++,t=e.extend({add:!0},this._lastOpts,t),this.search(t)},reachedEnd:function(){return this._reachedEnd},hasMore:function(){return this._lastOpts&&!this.reachedEnd()},_getParams:function(t,i){if(t=e.extend({},t),i){var n=[];for(var r in t)n.push(r);n.unshift(i);var o=e.pick.apply(e,n);t=e.extend(t,o)}return t},getLength:function(){return this.collection.length},at:function(e){return this.collection.at(e)}}),e.extend(m.prototype,{_parseData:function(){for(var e=this.data.files,t=0,i=e.length;t<i;t++){var n=e[t];if(v(n)){var r=new p(n,this.addExtra);if(!this.filter||this.filter(r)){var o=r.getThumbURL(),a=r.getPreviewURL(),s=r.getOriginalURL();this._items.push(r),this._modelAttrs.push({source_id:n.id,title:n.title,mimeType:r.getMimeType(),image_url:s||a||o,preview_url:a||s||o,thumb_url:o||a||s})}}}},getLength:function(){return this._items.length},at:function(e){return this._items[e]}}),e.extend(p.prototype,{_parseData:function(){this.links.original=this.links.original||{},this.links.preview=this.links.preview||{},this.links.thumb=this.links.thumb||{},this.data.comps&&(this.links.original.href=this.data.comps.Standard.url,this.links.preview.href=this.data.comps.Standard.url,this.links.original.height=this.data.comps.Standard.height,this.links.original.width=this.data.comps.Standard.width,this.links.preview.height=this.data.comps.Standard.height,this.links.preview.width=this.data.comps.Standard.width),this.data.thumbnail_240_url&&(this.links.preview.href=this.data.thumbnail_240_url,this.links.preview.width=this.data.thumbnail_240_width,this.links.preview.height=this.data.thumbnail_240_height),this.links.thumb.href=this.data.thumbnail_160_url,this.links.thumb.height=this.data.thumbnail_160_height,this.links.thumb.width=this.data.thumbnail_160_width,this.is_licensed=this.data.is_licensed||this.data.license||"",this.premium_level_id=this.data.premium_level_id,this.links.thumb.type=this.links.preview.type=this.links.original.type=this.data.content_type,this.addExtra&&(this.data.source={name:f.STOCK_SOURCE_NAME})},setOriginalLinkFields:function(e){this.links.licensed?(e.link=this._sanitizeURL(this.links.licensed.url),e.height=this.links.licensed.height,e.width=this.links.licensed.width):(e.link=this._sanitizeURL(this.links.original.href),e.height=this.links.original.height,e.width=this.links.original.width)},getOriginalURL:function(){var e=this.links.licensed&&this.links.licensed.url||this.links.original.href;return this._sanitizeURL(e)},getPreviewURL:function(){return this._sanitizeURL(this.links.preview.href)},getThumbURL:function(){return this._sanitizeURL(this.links.thumb.href)},getMimeType:function(){return this.links.original.type},_sanitizeURL:function(e){return e},getAspect:function(){return{width:this.links.thumb.width,height:this.links.thumb.height}},getThumbHoverLabel:function(){return this.is_licensed&&o.getString("imagepicker-stock-licensed-image-hover-label")||""}}),f.addLocaleToParams=function(e){e.locale=b()},f.getLicensesAvailable=function(){var e=i.defer(),t=f.apiHost+f.profilePath,n={};return f.addLocaleToParams(n),s.ajax({url:t,data:n,beforeSend:function(e){return e.setRequestHeader("X-api-key",l.stockApiKey),e.setRequestHeader("X-Product",l.stockApiKey),e.setRequestHeader("X-Product-Location","search"),!0},dataType:"json",traditional:!0}).done((function(t,i,n){var r=!t.available_entitlement,o=t.available_entitlement?t.available_entitlement.quota:0,a=!!t.purchase_options&&t.purchase_options.requires_checkout,s=t.purchase_options&&"not_possible"===t.purchase_options.state,c=t.purchase_options&&t.purchase_options.url||!1,l=t.purchase_options&&t.purchase_options.message;marvel.logger.debug("AdobeStockRequest.getLicensesAvailable: Stock profile",t),e.resolve({numLicenses:o,requiresCheckout:a,notAllowedToPurchase:s,purchaseUrl:c,purchaseMessage:l,stockTotallyBlocked:r})})).fail((function(t){marvel.logger.error("AdobeStockRequest.getLicensesAvailable: Retrieve available licenses error",{error:t}),e.reject(t)})),e.promise},f.addFlagsToUrlForLicense=function(e,t){var i=b();return"en_US"!==i&&(e+=`${e.includes("?")?"&":"?"}locale=${i}`),"Limited"===t&&(e+=`${e.includes("?")?"&":"?"}ff_8832344448=1&ff_9217843733=1`),e},f.updatePurchaseDetailsDownloadSize=function(e,t){var i=t&&t.stockImageSuggestedSize;if(![400,800,1600,2400,3100,5e3].includes(i))return i&&marvel.logger.debug("AdobeStockRequest.updatePurchaseDetailsDownloadSize: asking for unknown size: "+i),void(e.url=f.addFlagsToUrlForLicense(e.url,e.license));if(-1===e.url.indexOf("size="))e.url+="?size="+i;else if(-1===e.url.indexOf("size="+i)){var n=e.url.split("size=");e.url=n[0]+"size="+i;var r=n[1].indexOf("&");-1!==r&&(e.url+=n[1].substring(r))}e.url=f.addFlagsToUrlForLicense(e.url,e.license)},f.licenseItem=function(e,t){var n=i.defer(),r=f.apiHost+f.itemLicensePath,o={content_id:e};return f.addLocaleToParams(o),s.ajax({url:r,data:o,beforeSend:function(e){return e.setRequestHeader("X-api-key",l.stockApiKey),e.setRequestHeader("X-Product",l.stockApiKey),e.setRequestHeader("X-Product-Location","search"),!0},dataType:"json",traditional:!0}).done((function(i){var r=i.contents[e];f.updatePurchaseDetailsDownloadSize(r.purchase_details,t);var o={url:r.purchase_details.url,licenseType:g[r.purchase_details.license],width:r.purchase_details.width,height:r.purchase_details.height,mimeType:r.purchase_details.content_type,thumb:r.thumbnail};n.resolve(o)})).fail((function(e){marvel.logger.error("AdobeStockRequest.licenseItem: stock license request error",{url:r,data:o,status:e.status,response:e.responseJSON||e.responseText}),n.reject(e)})),n.promise},f.STOCK_SOURCE_NAME="Adobe Stock",f.STOCK_COLLECTION_TYPE_FREE="free-stock",f.STOCK_COLLECTION_TYPE_LIMITED="limited-stock",f.STOCK_COLLECTION_TYPE_STOCK_PREMIUM="premium-stock",f.getStockAssetDetailsUrl=function(e){return f.getItemInfo(e.image_id,{params:["details_url"]}).then((function(e){return e&&e.details_url||""}),(function(e){return e.assetNotFound||marvel.logger.error("AdobeStockRequest.getStockAssetDetailsUrl: Get Stock page url error",{error:e}),i.resolve("")}))},f.getStockAssetDetailsUrlAndLicenseType=function(e){return f.getItemInfo(e.image_id,{params:["details_url","is_licensed"]}).then((function(e){return e?{detailsUrl:e.details_url,licenseType:g[e.is_licensed]}:(marvel.logger.error("AdobeStockRequest.getStockAssetDetailsUrlAndLicenseType: no data"),{})}),(function(e){return e.assetNotFound||marvel.logger.error("AdobeStockRequest.getStockAssetDetailsUrlAndLicenseType: Get Stock page url error",{error:e}),i.resolve({})}))},f.getItemInfo=function(e,t){t=t||{};const n=i.defer(),r=f.apiHost+f.searchPath,o={"search_parameters[media_id]":e,"search_parameters[offset]":0,"search_parameters[limit]":1};let a="";return a=t.params?"result_columns%5B%5D="+t.params.join("&result_columns%5B%5D="):h,t.includeDetailsUrl&&(a=`${a}&result_columns%5B%5D=details_url`),t.previewLargeThumbs&&(a+="&result_columns%5B%5D=thumbnail_240_url&result_columns%5B%5D=thumbnail_240_width&result_columns%5B%5D=thumbnail_240_height"),t.upgradeThumbnail&&(a+=d),f.addLocaleToParams(o),marvel.logger.info("AdobeStockRequest.getItemInfo",{id:e}),s.ajax({url:r+"?"+a,data:o,beforeSend:function(e){return e.setRequestHeader("X-api-key",l.stockApiKey),e.setRequestHeader("X-Product",l.stockApiKey),e.setRequestHeader("X-Product-Location","search"),!0},dataType:"json",traditional:!0}).done((function(t,i,a){if(t&&t.files&&t.files[0]){var s=t&&t.files&&t.files[0];n.resolve(s)}else if(t&&t.files)marvel.logger.info("AdobeStockRequest.getItemInfo: item not found: "+e),n.reject({assetNotFound:!0});else{var c=a&&a.getResponseHeader("x-request-id"),l=a&&a.responseText,u=a&&a.status;marvel.logger.error("AdobeStockRequest.getItemInfo: search request empty response",{url:r,data:o,"x-request-id":c,status:u,response:l,resultData:JSON.stringify(t)}),n.reject(new Error("AdobeStockRequest::getItemInfo"))}})).fail((function(e){var t=e&&e.getResponseHeader("x-request-id");marvel.logger.error("AdobeStockRequest.getItemInfo: search request error",{url:r,data:o,"x-request-id":t,status:e.status,response:e.responseText}),n.reject(new Error("AdobeStockRequest::getItemInfo"))})),n.promise},f.licenseInfoFromData=function(e,t,i){var n=e.creator_name,r=t||e.is_licensed||e.license,o={title:e.title,owner:{name:n},source:{name:"Adobe Stock",url:""},license:{short_name:r?{standard:"royalty_free_standard",extended:"royalty_free_extended",royalty_free_extended:"royalty_free_extended",royalty_free_standard:"royalty_free_standard",royalty_free:"royalty_free",limited:"royalty_free_limited",royalty_free_limited:"royalty_free_limited"}[r.toLowerCase()]:"royalty_free"},image_id:e.id};if(void 0!==i){let e;if(o.premium_level_id=i,1===i)e=f.STOCK_COLLECTION_TYPE_FREE;else if(0===i)e=f.STOCK_COLLECTION_TYPE_LIMITED;else{if(!(i>1))return;e=f.STOCK_COLLECTION_TYPE_STOCK_PREMIUM}o.stock_collection_type=e}return o},f.willUserBePermittedToLicenseStock=function(){return f.getLicensesAvailable().then(e=>!e.stockTotallyBlocked)},f.licenseLegacyImage=function(t,n,r){return f.getItemInfo(t.image_id,{includeDetailsUrl:!0,previewLargeThumbs:!0}).then((function(o){let a;return o.premium_level_id>1?a={premiumLevelGreaterThan1:!0}:0===o.premium_level_id&&(r.canSeeLimited?r.canLicenseLimited||(a={userNotPremium:!0}):a={ineligibleToLicense:!0}),a?i.reject(a):(t=e.assign({},t,{premium_level_id:o.premium_level_id,is_licensed:o.is_licensed,id:t.image_id}),f.licenseImage(t,n).then((function(t){return e.assign({},t.purchase_details,o,{licenseType:g[t.purchase_details.license],href:t.purchase_details.url,mimeType:t.purchase_details.content_type,thumb:{width:o.thumbnail_240_width,height:o.thumbnail_240_height,content_type:t.thumbnail.content_type,url:o.thumbnail_240_url}})})))}))},f.licenseImage=function(e,t){var n=i.defer(),r=f.apiHost+f.itemLicensePath,o=e.id,a=e.is_licensed||"string"==typeof e.license&&e.license;if(a&&e.download_url){var u={content_id:e.id+"",size:"Comp",purchase_details:{content_type:e.content_type,height:e.height,width:e.width,license:a,url:e.download_url}};return"N/A"!==a?(f.updatePurchaseDetailsDownloadSize(u.purchase_details,t),n.resolve(u)):f.getItemInfo(o,{params:["is_licensed"]}).then(function(e){u.purchase_details.license=e.is_licensed,n.resolve(u)}.bind(this)),n.promise}var d={content_id:o};return a?d.license=a:0===e.premium_level_id&&(d.license="Limited"),r+="?ff_1612049839=1",1===e.premium_level_id&&c.hasFeature("stock-small-free-daily-license-limit")&&(r+="&ff_8539759234=1"),r=f.addFlagsToUrlForLicense(r,d.license),s.ajax({url:r,data:d,beforeSend:function(e){return e.setRequestHeader("X-api-key",l.stockApiKey),e.setRequestHeader("X-Product",l.stockApiKey),e.setRequestHeader("X-Product-Location","search"),!0},dataType:"json",traditional:!0}).done((function(e,i,r){var a=e.contents[o];"not_possible"===a.purchase_details.state?n.reject({notAllowedToPurchase:!0}):(f.updatePurchaseDetailsDownloadSize(a.purchase_details,t),n.resolve(a))})).fail((function(e){var t=e.responseJSON&&e.responseJSON.code,i=e.responseJSON&&e.responseJSON.error;"202"===t?n.reject({maxDailyFreeQuotaReached:!0,userMessage:i}):"304"===t||"000"===t&&403===e.status?n.reject({ineligibleToLicense:!0,userMessage:i}):(t&&marvel.logger.error("AdobeStockRequest.licenseImage: non-202 error code: "+t,e),n.reject({xhr:e,userMessage:i}))})),n.promise},f.ensureImageLicensed=function(e,{canLicenseLimited:t},n){const{links:r,premium_level_id:o,is_licensed:a,data:s}=e;return r.licensed?i(e):t||0!==o||a&&"Limited"!==a?f.licenseImage(e.data,n).then((function(t){return r.licensed=t.purchase_details,e.licenseInfo=f.licenseInfoFromData(s,t.purchase_details.license,s.premium_level_id),e.is_licensed=e.links.licensed.license,e})):"Limited"===a||e.searchTxt?i.reject({userNotPremium:!0}):f.getItemInfo(e.data.id,{params:["is_licensed"]}).then((function(r){return r.is_licensed?(e.is_licensed=r.is_licensed,f.ensureImageLicensed(e,{canLicenseLimited:t},n)):i.reject({userNotPremium:!0})}))},f.ensureImagesLicensed=function(e,t,n){var r=f.maxNumSimultaneousBatchRequests;if(e.length<=r){var o=[];return e.forEach((function(e){o.push(f.ensureImageLicensed(e,t,n))})),i.allSettled(o).then((function(e){return e.map((function(e){return"fulfilled"===e.state?e.value:{error:e.reason}}))}))}var a=i.defer(),s=e.slice(0,r),c=e.slice(r),l=[],u=r,d=e.length,h=()=>{if(d--,c.length){var e=c.shift(),i=u;u++,f.ensureImageLicensed(e,t,n).then(e=>{l[i]=e},e=>{l[i]={error:e}}).finally(()=>{h()})}else d||a.resolve(l)};return s.forEach((function(e,i){f.ensureImageLicensed(e,t,n).then(e=>{l[i]=e},e=>{l[i]={error:e}}).finally(()=>{h()})})),a.promise},f.batchLicenseForUser=function(e,t){return function(e,t){const n=f.maxNumSimultaneousBatchRequests;if(e.length<=n){const n=[];return e.forEach((function(e,i){n.push(f.licenseImage(e,t))})),i.all(n)}var r=i.defer(),o=e.slice(0,n),a=e.slice(n),s=[],c=n,l=e.length,u=!1,d=()=>{if(!u)if(l--,a.length){var e=a.shift(),i=c;c++,f.licenseImage(e,t).then(e=>{s[i]=e,d()},e=>{u||(u=!0,r.reject(e))})}else l||r.resolve(s)};return o.forEach((function(e,i){f.licenseImage(e,t).then(e=>{s[i]=e,d()},e=>{u||(r.reject(e),u=!0)})})),r.promise}(e,t&&t.downloadSize)},f.getDefaultBatchLicenseInfo=function(){return{freeUnlicensed:[],freeLicensed:[],licensed:[],unlicensed:[],noLongerLicensed:[],noLongerAvailable:[]}},f.verifyOrLicenseIdsForUser=function(e,t,{canUseNoLongerAvailable:i}={}){return f.batchGetItemsInfo(e,{params:["is_licensed","id","premium_level_id"]}).then(e=>{const n=f.getDefaultBatchLicenseInfo(),r=[],o=[],a=[];if(e.forEach((function(e){e.notFound?(n.noLongerAvailable.push(e),o.push(`${e.id}`)):1===e.premium_level_id?""===e.is_licensed?n.freeUnlicensed.push(e):n.freeLicensed.push(e):""!==e.is_licensed?n.licensed.push(e):e.premium_level_id>1?(n.noLongerLicensed.push(e),a.push(`${e.id}`)):(n.unlicensed.push(e),r.push(`${e.id}`))})),a.length)return{unlicensedMegaPremiumIds:a,error:{containsMegaPremiumImages:!0}};if(n.noLongerAvailable.length&&!i)return{unavailableIds:o,error:{containsNoLongerAvailableImages:!0}};if(r.length&&!t.canLicenseLimited)return{unlicensedIds:r,error:{userNotPremium:!0}};if(n.unlicensed.length||n.freeUnlicensed.length){const e=n.unlicensed.concat(n.freeUnlicensed);return f.batchLicenseForUser(e).then(e=>{const t=e.reduce((e,t)=>(e[t.content_id]=t,e),{});return{lists:n,newlyLicensed:t}}).catch(e=>({error:{couldNotLicense:!0},subError:e}))}return{lists:n}})},f.getBatchLicenseInfoForExport=function(e){return f.batchGetItemsInfo(e,{params:["is_licensed","id","premium_level_id"]}).then(e=>e)},f.getBatchLicenseInfo=function(e,t){return f.batchGetItemsInfo(e,{params:["is_licensed","id","premium_level_id"]}).then(e=>{const i=f.getDefaultBatchLicenseInfo();if(e.forEach((function(e){e.notFound?i.noLongerAvailable.push(`${e.id}`):1===e.premium_level_id?""===e.is_licensed?i.freeUnlicensed.push(`${e.id}`):i.freeLicensed.push(`${e.id}`):""!==e.is_licensed?i.licensed.push(`${e.id}`):i.unlicensed.push(`${e.id}`)})),t&&t.length&&i.unlicensed.length){const e=new Set(t.map(e=>`${e}`));i.noLongerLicensed=i.unlicensed.filter(e.has,e)}return i})},f.batchGetItemsInfo=function(t,n){n=n||{};var r,o=e.uniq(t),a=o.length!==t.length,u=function(e){var t=100,i=e.length,n=[],r=0;for(c.hasFeature("small-stock-batch")&&(t=5),r=0;r<i;r+=t)n.push(e.slice(r,r+t).join(","));return n}(o),d="";return d=n.params?"result_columns%5B%5D="+n.params.join("&result_columns%5B%5D="):h,d+="&locale="+b(),r=u.map((function(e){return t=d,n=e,r=i.defer(),o=f.apiHost+f.bulkMetadataPath,marvel.logger.info("AdobeStockRequest.batchMetadataRequest",{idList:n}),s.ajax({url:o+"?"+t+"&ids="+n,beforeSend:function(e){return e.setRequestHeader("X-api-key",l.stockApiKey),e.setRequestHeader("X-Product",l.stockApiKey),e.setRequestHeader("X-Product-Location","search"),!0},dataType:"json",traditional:!0}).done((function(e,t,i){var n=i&&i.getResponseHeader("x-request-id"),a=i&&i.responseText,s=i&&i.status;e&&e.files?marvel.logger.info("AdobeStockRequest.batchMetadataRequest: batch reqeuest succeeded",{url:o,"x-request-id":n,status:s,response:a}):marvel.logger.error("AdobeStockRequest.batchMetadataRequest: batch request empty response",{url:o,"x-request-id":n,status:s,response:a,resultData:JSON.stringify(e)}),r.resolve(e.files)})).fail((function(e){var t=e&&e.getResponseHeader("x-request-id");marvel.logger.error("AdobeStockRequest.batchMetadataRequest: batch request error",{url:o,"x-request-id":t,status:e.status,response:e.responseText}),r.reject(new Error("AdobeStockRequest::batchMetadataRequest"))})),r.promise;var t,n,r,o})),i.all(r).then((function(e){var i=e.reduce((function(e,t){return e.concat(t)}),[]);if(o.length!=i.length){var n=new Set(i.map(e=>`${e.id}`)),r=[];o.forEach(e=>{n.has(e)||(i.push({id:e,notFound:!0}),r.push(e))}),marvel.logger.info(`AdobeStockRequest.batchGetItemsInfo: batch info had missing ids: ${r}`)}if(a){var s=i.reduce((function(e,t){return e[t.id]=t,e}),{});i=t.map((function(e){return s[e]}))}return i}))},f.getRequestType=function(e){return e?e._searchAPI===f.licenseHistoryPath?"history":"search":void 0},f}.apply(t,n))||(e.exports=r)},315:function(e,t,i){var n,r;n=[i(16),i(9),i(11),i(2),i(406),i(6)],void 0===(r=function(e,t,i,n,r,o){"use strict";new o.default({color:"periwinkle",name:"imageUtils"});return new(i.Model.extend({imageServices:{nonDooplo:["stock"],dooplo:["pixabay","the-noun-project","bing"],flagPrefixDooplo:"user-flag-image-source-dooplo-",showFlagPrefixDooplo:"show-user-flag-image-source-dooplo-"},_convertUrlToBlob:function(e,t,i){var o=n.defer(),a=new Image;return i&&a.setAttribute("crossOrigin","anonymous"),a.onload=function(e){var i=document.createElement("canvas"),n=i.getContext("2d");i.width=this.width,i.height=this.height,n.drawImage(this,0,0,this.width,this.height);try{o.resolve(r(i.toDataURL(t||"image/png")))}catch(a){o.reject(a)}},a.onerror=function(e){o.reject(e)},a.src=e,o.promise},convertUrlToBlob:function(e,t){return this._convertUrlToBlob(e,t,!1).then((function(e){return e}),function(i){return this._convertUrlToBlob(e,t,!0).then((function(e){return e}),(function(e){return n.reject(e)}))}.bind(this))},convertRenditionUrlToBlob:function(e,t,i){i=i||"jpg";var n=t;return e=e.replace("{format}",i).replace("{dimension}","width").replace("{size}",n),this.convertUrlToBlob(e).then(function(e){return e}.bind(this),function(e){return null}.bind(this))},getDataUrl:function(e){var t=n.defer(),i=new Image;return i.setAttribute("crossOrigin","anonymous"),i.onload=function(){var e=document.createElement("canvas");e.width=this.naturalWidth,e.height=this.naturalHeight,e.getContext("2d").drawImage(this,0,0);try{t.resolve(e.toDataURL("image/png"))}catch(i){t.reject(i)}},i.onerror=function(e){t.reject(e)},i.src=e,t.promise}}))}.apply(t,n))||(e.exports=r)},332:function(e,t,i){"use strict";i.r(t),i.d(t,"LibrariesController",(function(){return fe}));var n,r,o=i(210),a=i.n(o),s=i(27),c=i.n(s),l=i(4),u=i.n(l),d=i(3),h=i.n(d),g=i(62),f=i.n(g),m=i(98),p=i.n(m),v=i(114),b=i.n(v),y=i(64),w=i.n(y),C=i(2),M=i.n(C),L=i(22),k=i.n(L),x=(i(63),i(1)),N=i.n(x),T=(i(97),i(13)),I=i.n(T),D=i(127),S=i.n(D),_=i(83),A=i.n(_),F=i(6),E=i(99),z=new F.default({color:"green",name:"Asimov"}),P={fetch:function(e){return E.default.fetch(e).catch((function(e){throw z.error("SparkFetchUtil",e),e}))},_makeOptions:function(e,t,i){return{LOG_CATEGORY:"[CCLibraries:Asimov]",method:i||"POST",uri:e,headers:{"Content-Type":"application/json","x-request-id":k.a.v4()},body:t}},_makeOptionsJSON:function(e,t,i){return this._makeOptions(e,JSON.stringify(t),i)},parseFile:function(e,t,i,n){var r=e.size,o=0,a=null,s=function(s){null==s.target.error?(o+=s.target.result.byteLength,t(s.target.result),o>=r?n(e):a(o,5242880,e)):i(s.target.error)};(a=function(e,t,i){var n=new FileReader,r=i.slice(e,t+e);n.onload=s,n.readAsArrayBuffer(r)})(o,5242880,e)},uploadFile:function(e,t){var i=M.a.defer(),n=[],r=[],o=this,a=A.a.algo.MD5.create();z.info("Starting File processing for Asimov upload",e);return this.parseFile(e,(function(e){r.push(e);var t=A.a.lib.WordArray.create(e);a.update(t)}),(function(e){z.error("Failure while breaking file into chunks",e)}),(function(e){var s=k.a.v4(),c=a.finalize();a=c.toString(A.a.enc.Base64),z.info("Successfully broke file into chunks and calculated md5 hash",{fileChunksCount:r.length,md5:a}),o.createJob(a,t,s,e.type,e.size).then((function(t){var a=t.id,s=1;z.info("Successfully created new Asimov upload job",{jobId:a}),r.forEach((function(t){n.push(o.uploadFilePartToJobWithRetry(a,t,e.type,s,t.byteLength,5)),s++})),M.a.allSettled(n).then((function(e){e.forEach((function(e){"fulfilled"!==e.state&&i.reject("Exhausted retries for uploading some of the parts")})),z.info("All file part uploads complete. Now finalizing the job",{jobId:a}),o.finalizeJob(a,"POST").then((function(e){"VERIFYING"===e.status?o.pollJobStatus(a,"UPLOAD_COMPLETE",10).then((function(e){i.resolve(e)})).catch((function(e){i.reject("Failed to complete piecing the job together. Final job status response:",e)})):"UPLOAD_COMPLETE"===e.status?i.resolve(e):i.reject("Unexpected job status for jobId="+a,e)})).catch((function(e){i.reject("Failed to finalize the job after uploading all parts",e)}))}))}))})),i.promise},pollJobStatus:function(e,t,i){var n=this;return this.finalizeJob(e,"GET").then((function(r){return r.status===t?Promise.resolve(r):i>0?n.delay(1e3).then((function(){return n.pollJobStatus(e,t,i-1)})):Promise.reject(r)})).catch((function(r){return i>0?n.pollJobStatus(e,t,i-1):Promise.reject(r)}))},finalizeJob:function(e,t){var i=this._makeOptions("https://".concat(N.a.asimov,"/api/v1/uploads/").concat(e,"/finalize"),null,t);return this.fetch(i)},uploadFilePartToJobWithRetry:function(e,t,i,n,r,o){var a=this;return this.uploadFilePartToJob(e,t,n,r).then((function(e){return Promise.resolve(e)})).catch((function(s){return o>0?a.uploadFilePartToJobWithRetry(e,t,i,n,r,o-1):Promise.reject(s)}))},uploadFilePartToJob:function(e,t,i,n){var r=new Blob([t],{type:"application/octet-stream"}),o={partNumber:i,partSize:n},a=new Blob([JSON.stringify(o)],{type:"application/json"}),s=new FormData;s.append("uploadPartRequest",a),s.append("file",r);var c=this._makeOptions("https://".concat(N.a.asimov,"/api/v1/uploads/").concat(e),s,"PUT");return delete c.headers["Content-Type"],this.fetch(c)},delay:function(e){return new Promise((function(t){setTimeout(t,e)}))},createJob:function(e,t,i,n,r){var o=this._makeOptions("https://".concat(N.a.asimov,"/api/v1/uploads"),JSON.stringify({md5:e,composite:t,filename:i,contentType:n,contentLength:r}));return this.fetch(o)},createTemplateFromDocument:function(e,t,i){var n=this._makeOptionsJSON("https://".concat(N.a.asimov,"/api/v2/spark/snapshot"),{source:e,target:t});return i&&(n.headers["x-organization-id"]=i),this.fetch(n)},updateTemplateFromDocument:function(e,t,i,n){var r=this._makeOptionsJSON("https://".concat(N.a.asimov,"/api/v1/spark/snapshot"),{source:e,target:i,thumbnail:t,elementId:n},"PUT");return this.fetch(r)},createDocumentFromTemplate:function(e,t,i,n){var r=this._makeOptionsJSON("https://".concat(N.a.asimov,"/api/v1/spark/project"),{source:e,target:t,elementId:i||void 0});return n&&(r.headers["x-organization-id"]=n),r.expectTextResponse=!0,this.fetch(r)}},j={fetch:function(e){return E.default.fetch(e)},getLibrariesOrgId:function(){var e=I.a.getProfile();if(n&&r&&(e&&e.userId===n))return M.a.resolve(r);return this.fetch({uri:"https://".concat(N.a.rApi,"/index"),apiKey:N.a.key}).then((function(t){var i=t.children;if(!i)throw new Error("Org ID not found - children not found in response");var o=i[0];if(!o)throw new Error("Org ID not found - first child not found in children");var a=o._embedded;if(!a)throw new Error("Org ID not found - _embedded not found in first child");var s=a["http://ns.adobe.com/adobecloud/rel/metadata/repository"];if(!s)throw new Error("Org ID not found - repo metadata not found in _embedded");var c=s["repo:repositoryId"];if(!c)throw new Error("Org ID not found - orgId not found in repo metadata");return n=e?e.userId:void 0,r=c,c}))},getLibrariesEtag:function(){return I.a.getAccessToken().then((function(e){return window.fetch("https://".concat(N.a.ss,"/assets/adobe-libraries"),{method:"HEAD",headers:{"X-Api-Key":N.a.key,Authorization:"Bearer ".concat(e)}}).then((function(e){return e.headers.get("etag")}))}))},getLibraries:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all",i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-modified_date",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"collaboration,rendition_grid",a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],s=M.a.resolve();return a||!t.includes("incoming")&&!t.includes("all")||(s=this.getLibrariesOrgId().then((function(e){return{"x-organization-id":e}}))),s.then((function(a){var s={uri:"https://".concat(N.a.melville,"/api/v1/libraries?owner=").concat(t,"&orderBy=").concat(i,"&selector=").concat(o,"&start=").concat(n,"&limit=").concat(r),method:"GET",headers:a};return e.fetch(s)}))},getLibraryUrl:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];return"https://".concat(N.a.melville,"/api/v1/libraries/").concat(e)},getLibrary:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"collaboration,rendition_grid",n=(M.a.resolve(),"https://".concat(N.a.melville,"/api/v1/libraries/").concat(e));return i&&(n+="?selector=".concat(i)),this.getLibrariesOrgId().then((function(e){return{"x-organization-id":e}})).then((function(e){var i={uri:n,method:"GET",headers:e};return t.fetch(i)}))},getPublicLibrary:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"rendition_grid",i="https://".concat(N.a.melville,"/api/v1/public/libraries/").concat(e);t&&(i+="?selector=".concat(t));var n={uri:i,skipAuth:!0,method:"GET"};return this.fetch(n)},getElementsFromLib:function(e,t,i,n,r,o,a){var s=t||"modified_date",c=i||0,l=n||10,u=r||"default",d={},h="https://".concat(N.a.melville,"/api/v1/libraries/").concat(e,"/elements?orderBy=").concat(s,"&start=").concat(c,"&limit=").concat(l,"&selector=").concat(u);o&&(h+="&type=".concat(encodeURIComponent(o))),a&&(d["x-organization-id"]=a);var g={uri:h,method:"GET",headers:d};return this.fetch(g).catch((function(e){if(404===e.statusCode)return{total_count:0,elements:[]};throw e}))},getElementsFromPublicLib:function(e,t,i,n,r,o){var a=t||"modified_date",s=i||0,c=n||10,l=r||"default",u="https://".concat(N.a.melville,"/api/v1/public/libraries/").concat(e,"/elements?orderBy=").concat(a,"&start=").concat(s,"&limit=").concat(c,"&selector=").concat(l);o&&(u+="&type=".concat(encodeURIComponent(o)));var d={uri:u,skipAuth:!0,method:"GET"};return this.fetch(d).catch((function(e){if(404===e.statusCode)return{total_count:0,elements:[]};throw e}))},getElementFromPublicLib:function(e,t){var i={uri:"https://".concat(N.a.melville,"/api/v1/public/libraries/").concat(e,"/elements/").concat(t),skipAuth:!0,method:"GET"};return this.fetch(i).catch((function(e){if(404===e.statusCode)return null;throw e}))},createLibrary:function(e,t){var i={uri:"https://".concat(N.a.melville,"/api/v1/libraries").concat(t?"?invocation_mode=async":""),method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)};return this.fetch(i)},fetchAsyncMonitorHref:function(e){return this.fetch({uri:e,resolveRawResponse:!0})},deleteLibrary:function(e,t){var i={};t&&(i["x-organization-id"]=t);var n={uri:"https://".concat(N.a.melville,"/api/v1/libraries/").concat(e),method:"DELETE",headers:i};return this.fetch(n)},getRepresentationsForElement:function(e,t,i){var n={};i&&(n["x-organization-id"]=i);var r={uri:"https://".concat(N.a.melville,"/api/v1/libraries/").concat(e,"/elements/").concat(t,"/?selector=representations"),method:"GET",headers:n};return this.fetch(r).then((function(e){return e.representations}))},createElement:function(e,t,i,n,r,o,a){n=n||{device:"browser",deviceId:"browser",app:"spark.adobe.com"};var s={"Content-Type":"application/json"};a&&(s["x-organization-id"]=a);var c={uri:"https://".concat(N.a.melville,"/api/v1/libraries/").concat(e,"/elements"),method:"POST",headers:s,body:JSON.stringify({name:t,type:r,client:n,description:i,representations:o})};return this.fetch(c)},updateElementRepresentation:function(e,t,i,n,r,o,a){r=r||{device:"browser",deviceId:"browser",app:"spark.adobe.com"};var s={"Content-Type":"application/json"};a&&(s["x-organization-id"]=a);var c={uri:"https://".concat(N.a.melville,"/api/v1/libraries/").concat(e,"/elements/").concat(t,"/representations"),method:"PUT",headers:s,body:JSON.stringify({type:n,client:r,representations:o})};return this.fetch(c)},updateLibraryMetadata:function(e,t,i){var n={"Content-Type":"application/json"};i&&(n["x-organization-id"]=i);var r={uri:"https://".concat(N.a.melville,"/api/v1/libraries/").concat(e,"/metadata"),method:"PUT",headers:n,body:JSON.stringify(t)};return this.fetch(r)},updateElementMetadata:function(e,t,i){var n={"Content-Type":"application/json"};i&&(n["x-organization-id"]=i);var r={uri:"https://".concat(N.a.melville,"/api/v1/libraries/").concat(e,"/elements/metadata"),method:"PUT",headers:n,body:JSON.stringify({elements:t})};return this.fetch(r)},deleteElement:function(e,t,i){var n={};i&&(n["x-organization-id"]=i);var r={uri:"https://".concat(N.a.melville,"/api/v1/libraries/").concat(e,"/elements/").concat(t),method:"DELETE",headers:n};return this.fetch(r)},createRepresentation:function(e,t,i,n){var r="https://".concat(N.a.melville,"/api/v1/libraries/").concat(e,"/representations/content"),o={type:i},a={},s=new FormData;s.append("Representation-Data",JSON.stringify(o)),s.append("Representation-Content",t),n&&(a["x-organization-id"]=n);var c={uri:r,method:"POST",body:s,headers:a};return this.fetch(c)},getElementFromLib:function(e,t){var i={uri:"https://".concat(N.a.melville,"/api/v1/libraries/").concat(e,"/elements/").concat(t),method:"GET"};return this.fetch(i)},getBookmarks:function(){var e={uri:"https://".concat(N.a.melville,"/api/v1/libraries/bookmarks"),method:"GET"};return this.fetch(e)},deleteBookmark:function(e){var t={uri:"https://".concat(N.a.melville,"/api/v1/libraries/bookmarks/").concat(e),method:"DELETE"};return this.fetch(t)}},R=i(173),B=i.n(R),U=i(301),O=i.n(U),K=i(35),G=i(17),H=i.n(G),Y=i(104),Q=i.n(Y),V=i(375),q=i(376),X=i(150),W=i.n(X),$=i(158),J=i.n($),Z=function(e){return"public"===e.ownership?e.id:e.library_urn},ee=6e4,te=1,ie=function(){function e(){u()(this,e)}return h()(e,[{key:"reset",value:function(){var e=I.a.getProfile(),t=e?e.userId:"global";try{window.localStorage.removeItem("".concat(t,"librariescache"))}catch(i){window.marvel.logger.warn("[LibrariesController] Unable to clear cache in local storage",{error:i})}this.resetInMemory()}},{key:"resetInMemory",value:function(){this.cache=void 0}},{key:"writeToLocalStorage",value:function(){var e=I.a.getProfile(),t=e?e.userId:"global";try{window.localStorage.setItem("".concat(t,"librariescache"),JSON.stringify(this.cache))}catch(i){window.marvel.logger.warn("[LibrariesController] Unable to write cache to local storage",{error:i});try{window.localStorage.removeItem("".concat(t,"librariescache"))}catch(n){window.marvel.logger.warn("[LibrariesController] Unable to clear cache in local storage",{error:n})}}}},{key:"get",value:function(){if(this.cache)return this.cache;var e;try{var t=I.a.getProfile(),i=t?t.userId:"global",n=window.localStorage.getItem("".concat(i,"librariescache"));void 0===(e=n?JSON.parse(n):{}).version||e.version<te?(this.cache={version:te},this.writeToLocalStorage()):this.cache=e}catch(r){window.marvel.logger.warn("[LibrariesController] Unable to get cache from local storage",{error:r})}return this.cache}},{key:"libraryListHasExpired",value:function(e){if("public"===e.owner)return!0;var t=Date.now(),i=this.getLibraryList(e);return!!i&&(!i.updated||t-i.updated>=ee)}},{key:"elementListHasExpired",value:function(e,t){var i=Date.now(),n=this.getElementList(e,t);return!!n&&(!n.updated||i-n.updated>=ee)}},{key:"elementListHasExpiredByType",value:function(e,t){var i=Date.now(),n=this.getElementListByType(e,t);return!!n&&(!n.updated||i-n.updated>=ee)}},{key:"libraryHasExpired",value:function(e){var t=Date.now(),i=this.getLibrary(e);return!!i&&(!i.updated||t-i.updated>=ee)}},{key:"getLibraryList",value:function(e){var t=this.get();if(t&&t.libraryLists&&"public"!==e.owner){var i=w()(t.libraryLists,(function(t){return J()(t.params,e)}));if(i)return i}}},{key:"getLibraryListWithData",value:function(e){var t=this,i=this.getLibraryList(e);if(i&&"public"!==e.owner)return(i=b()(i)).libraries=i.libraries.map((function(e){return t.getLibrary(e)})),i}},{key:"getLibraryListIndex",value:function(e){var t=this.get();return t&&t.libraryLists&&"public"!==e.owner?W()(t.libraryLists,(function(t){return J()(t.params,e)})):-1}},{key:"getLibraryListIndexByOwner",value:function(e){var t=this.get();return t&&t.libraryLists&&"public"!==e?W()(t.libraryLists,(function(t){return t.params&&t.params.owner===e})):-1}},{key:"getLibrary",value:function(e){var t=this.get();if(t&&t.libraries)return t.libraries[e]}},{key:"getElementListSet",value:function(e){var t=this.get();if(t&&t.elementLists)return t.elementLists[e]}},{key:"getElementList",value:function(e,t){var i=this.get();if(i&&i.elementLists){var n=i.elementLists[e];if(n){var r=w()(n,(function(e){return J()(e.params,t)}));if(r)return r}}}},{key:"getElementListByType",value:function(e,t){var i=this.get();if(i&&i.elementLists){var n=i.elementLists[e];if(n){var r=w()(n,(function(e){return e.params.type===t}));if(r)return r}}}},{key:"getElementListWithData",value:function(e,t){var i=this,n=this.getElementList(e,t);if(n)return(n=b()(n)).elements=n.elements.map((function(t){return i.getElement(e,t)})),n}},{key:"getElementListIndex",value:function(e,t){var i=this.get();if(!(t&&e&&i&&i.elementLists))return-1;var n=i.elementLists[e];return n?W()(n,(function(e){return J()(e.params,t)})):void 0}},{key:"getElementListIndexByType",value:function(e,t){var i=this.get();if(!(t&&e&&i&&i.elementLists))return-1;var n=i.elementLists[e];return n?W()(n,(function(e){return e.params&&e.params.type===t})):void 0}},{key:"getElement",value:function(e,t){var i=this.get();if(i&&i.elements)return i.elements["".concat(e,"/").concat(t)]}},{key:"addLibraryList",value:function(e){var t=this.get();e.params&&"public"===e.params.owner||(t.libraryLists=t.libraryLists||[],t.libraryLists.push(e))}},{key:"addElementList",value:function(e,t){var i=this.get();i.elementLists=i.elementLists||{},i.elementLists[e]=i.elementLists[e]||[],i.elementLists[e].push(t)}},{key:"clearLibraryList",value:function(e,t){var i=this.get();if(i&&i.libraryLists&&(!e||"public"!==e.owner)){if(e){var n=this.getLibraryListIndex(e);n>=0&&i.libraryLists.splice(n,1)}else i.libraryLists=[];t||this.writeToLocalStorage(i)}}},{key:"clearLibraryListByOwner",value:function(e,t){var i=this.get();if(i&&i.libraryLists&&"public"!==e){if(e){var n=this.getLibraryListIndexByOwner(e);n>=0&&i.libraryLists.splice(n,1)}else i.libraryLists=[];t||this.writeToLocalStorage(i)}}},{key:"clearLibrary",value:function(e,t){var i=this.get();e&&i&&i.libraries&&(delete i.libraries[e],t||this.writeToLocalStorage(i))}},{key:"clearElementList",value:function(e,t,i){var n=this.get();if(e&&n&&n.elementLists){if(t){var r=this.getElementListIndex(e,t);r>=0&&n.elementLists[e].splice(r,1)}else n.elementLists[e]&&(n.elementLists[e]=[]);i||this.writeToLocalStorage(n)}}},{key:"clearElementListByType",value:function(e,t,i){var n=this.get();if(e&&n&&n.elementLists){if(t){var r=this.getElementListIndexByType(e,t);r>=0&&n.elementLists[e].splice(r,1)}else n.elementLists[e]&&(n.elementLists[e]=[]);i||this.writeToLocalStorage(n)}}},{key:"clearElementsListIfNecessary",value:function(e,t){var i=this;if(e){var n=this.get();e.forEach((function(e){var r=i.getLibrary(Z(e));n&&n.elementLists&&n.elementLists[Z(e)]&&r&&e.version!==r.version&&i.clearElementList(Z(e),void 0,t)}))}}},{key:"clearElement",value:function(e,t,i){var n=this.get();e&&t&&n&&n.libraries&&(delete n.elements["".concat(e,"/").concat(t)],i||this.writeToLocalStorage(n))}},{key:"updateLibraryName",value:function(e,t,i){var n=this.getLibrary(e);n&&(n.name=t,n.updated=Date.now()),i||this.writeToLocalStorage()}},{key:"updatePageOfLibraries",value:function(e,t,i,n,r){var o=this,a=this.getLibraryList(t);"public"!==t.owner&&(a||(a={},this.addLibraryList(a)),a.updated=Date.now(),a.params=t,a.totalCount=e.total_count,a.libraries=a.libraries||[],e.libraries.forEach((function(e,t){o.updateLibrary(e,!0),a.libraries[i+t]=Z(e)})),r||this.writeToLocalStorage())}},{key:"updateLibrary",value:function(e,t){var i=this.get();i.libraries=i.libraries||{},e.updated=Date.now(),i.libraries[Z(e)]=e,t||this.writeToLocalStorage()}},{key:"updateElementName",value:function(e,t,i,n){var r=this.getElement(e,t);r&&(r.updated=Date.now(),r.name=i),n||this.writeToLocalStorage()}},{key:"updatePageOfElements",value:function(e,t,i,n,r,o,a){var s=this,c=this.getElementList(t,i);c||(c={},this.addElementList(t,c)),c.updated=Date.now(),c.params=i,c.totalCount=e.total_count,c.elements=c.elements||[],e.elements.forEach((function(e,i){a||s.updateElement(e,t,!0),c.elements[n+i]=e.id})),o||this.writeToLocalStorage()}},{key:"updateElement",value:function(e,t,i){var n=this.get();n.elements=n.elements||{},e.updated=Date.now(),n.elements["".concat(t,"/").concat(e.id)]=e,i||this.writeToLocalStorage()}}]),e}(),ne={},re={getAuthController:function(){return ne["marvel-auth-controller"]||(ne["marvel-auth-controller"]=M.a.defer(),Promise.resolve().then(function(e){ne["marvel-auth-controller"].resolve(i(13))}.bind(null,i)).catch(i.oe)),ne["marvel-auth-controller"].promise}},oe=function(e){return"public"===e.ownership?e.id:e.library_urn||e.urn},ae=new F.default({color:"green",name:"LibrariesController"}),se="libraries",ce="elements",le={png:"image/png",jpg:"image/jpg",jpeg:"image/jpeg",gif:"image/gif",svg:"image/svg+xml",psd:"application/photoshop",ai:"application/postscript"},ue={png:"application/vnd.adobe.element.image+dcx",jpg:"application/vnd.adobe.element.image+dcx",jpeg:"application/vnd.adobe.element.image+dcx",gif:"application/vnd.adobe.element.image+dcx",svg:"application/vnd.adobe.element.image+dcx",psd:"application/vnd.adobe.element.image+dcx",ai:"application/vnd.adobe.element.image+dcx"},de="https://helpx.adobe.com/creative-cloud/kb/file-storage-quota.html",he="https://helpx.adobe.com/enterprise/admin-guide.html/enterprise/using/cce-storage.ug.html",ge={private:1,incoming:1,public:1},fe=function(){function e(){var t=this;u()(this,e),this.pagingStates={},this.pagingStates[se]=[],this.pagingStates[ce]=[],this.cache=new ie,this.acceptedUploadFileTypes={"image/png":!0,"image/jpg":!0,"image/jpeg":!0,"image/gif":!0,"image/svg+xml":!0,"application/octet-stream":["ai"],"application/postscript":["ai"],"image/vnd.adobe.photoshop":["ai"]},this.acceptedUploadFileTypesWithExt=".jpg,.jpeg,.png,.ai,.psd,.svg,.gif,image/gif,image/svg+xml,image/jpeg,image/png",re.getAuthController().then((function(){window.marvel.events.on("spark-invalidate-libraries-list-cache",t.invalidateLibrariesListCache.bind(t))}))}return h()(e,[{key:"getFileExtension",value:function(e){return e.name.replace(/^.*\.([^.]*)$/,"$1").toLowerCase()}},{key:"writeToLocalStorage",value:function(e,t){try{var i=I.a.getProfile().userId;window.localStorage.setItem("".concat(i).concat(e),t)}catch(n){window.marvel.logger.warn("[LibrariesController] Unable to write ".concat(e," to local storage"),{error:n})}}},{key:"getFromLocalStorage",value:function(e){var t;try{var i=I.a.getProfile().userId;t=window.localStorage.getItem("".concat(i).concat(e))}catch(n){window.marvel.logger.warn("[LibrariesController] Unable to get ".concat(e," from local storage"),{error:n})}return t}},{key:"getMaxFileSize",value:function(){return 5242880}},{key:"isFileTypeAllowed",value:function(e){var t=!0,i=this.acceptedUploadFileTypes[e.type];return i&&("object"!==c()(i)||i.includes(this.getFileExtension(e)))||(t=!1),t||(t=this.isPhotoshopFile(e)),t}},{key:"isPhotoshopFile",value:function(e){return e.type.includes("photoshop")||e.type.includes("psd")}},{key:"isSaveableAsTemplate",value:function(e){var t=M.a.defer();return e.getMyApp().batchCheckLicenses(e).then((function(e){t.resolve({lists:e,isSavable:!e.stockBlockType&&!e.noLongerLicensed.length&&!e.noLongerAvailable.length})})).catch((function(e){ae.error("Failed checking if doc can be saved as template",e),t.reject(e)})),t.promise}},{key:"invalidateLibrariesListCache",value:function(e){var t=e.owner;this.cache.clearLibraryListByOwner(t)}},{key:"resetPagingState",value:function(e){e?this.pagingStates[e]=[]:(this.pagingStates={},this.pagingStates[se]=[],this.pagingStates[ce]=[])}},{key:"reset",value:function(){this.cache.reset(),this.resetPagingState()}},{key:"getPagingState",value:function(e,t,i){var n=w()(this.pagingStates[e],(function(e){return e.id===i}));return n||(n={id:i,params:b()(t),lastStart:void 0},this.pagingStates[e].push(n)),n}},{key:"getLastStartIndex",value:function(e,t,i){return this.getPagingState(e,t,i).lastStart}},{key:"setLastStartIndex",value:function(e,t,i,n){this.getPagingState(e,t,n).lastStart=i}},{key:"loadAllLibraries",value:function(e,t,i){var n=this,r=M.a.defer(),o=[],a=!0,s=k()();return function c(){var l=a?0:void 0;a=!1,n.loadMoreLibraries(e,t,l,i,s).then((function(e){var t=e.libraries,i=e.allLoaded;o=o.concat(t),i?r.resolve(o):c()})).catch((function(e){r.reject(e)}))}(),r.promise}},{key:"loadLibraries",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"private",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-modified_date",i=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;return this.loadMoreLibraries(e,t,0,i,n)}},{key:"loadMoreLibraries",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"private",i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-modified_date",n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0,a=this.cache;return this.loadListViaCacheIfPossible(n,{getLastStartIndex:function(){return e.getLastStartIndex(se,{owner:t,orderBy:i},o)},cacheHasExpired:function(){return a.libraryListHasExpired({owner:t,orderBy:i})},clearCachedList:function(){return a.clearLibraryList({owner:t,orderBy:i})},getCachedList:function(){return a.getLibraryListWithData({owner:t,orderBy:i})},setLastStartIndex:function(n){return e.setLastStartIndex(se,{owner:t,orderBy:i},n,o)},getDataItemsFromCachedEntry:function(e){return e.libraries},fetchListFromServer:function(n){var s="LibraryFetchElementsMore";return K.SparkPerformanceTracker.mark(s),j.getLibraries(t,i,n,10,void 0,r).catch((function(e){throw e.statusCode>=500&&a.reset(),K.SparkPerformanceTracker.measure("".concat(s,":failure"),{detail:{error:e},start:s}),e})).then((function(r){var c={librariesReceived:r.libraries?r.libraries.length:void 0,totalCount:r.total_count,owner:t,orderBy:i,start:n};return ae.info("Successfully fetched libraries",c),K.SparkPerformanceTracker.measure("".concat(s,":success"),s),a.clearElementsListIfNecessary(r.libraries,!0),e.setLastStartIndex(se,{owner:t,orderBy:i},n,o),a.updatePageOfLibraries(r,{owner:t,orderBy:i},n,10),{totalCount:r.total_count,items:r.libraries}}))},prepReturnList:function(t){return M.a.all(t.reduce((function(t,i){var n=e.sparkLibraryFactory(i);return n?t.push(n):(window.marvel.logger.warn("[Libraries Controller] Invalid value ["+i+"] was found in LibrariesCache - ignoring for now but clearing LibrariesCache"),a.reset()),t}),[])).then((function(e){return{libraries:e}}))}})}},{key:"loadElements",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"-modified_date";return this.loadMoreElements(e,t,i,0)}},{key:"loadMoreElements",value:function(e,t){var i=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"-modified_date",r=arguments.length>3?arguments[3]:void 0,o=this.cache;return this.loadListViaCacheIfPossible(r,{getLastStartIndex:function(){return i.getLastStartIndex(ce,{type:t,orderBy:n})},cacheHasExpired:function(){return o.elementListHasExpired(oe(e),{type:t,orderBy:n})},clearCachedList:function(){return o.clearElementList(oe(e),{type:t,orderBy:n})},getCachedList:function(){return o.getElementListWithData(oe(e),{type:t,orderBy:n})},setLastStartIndex:function(e){return i.setLastStartIndex(ce,{type:t,orderBy:n},e)},getDataItemsFromCachedEntry:function(e){return e.elements},fetchListFromServer:function(r){var a;a=e.publinkMetadata||e.isPublic()?j.getElementsFromPublicLib(e.id,n,r,10,"details,representations",t):j.getElementsFromLib(e.urn,n,r,10,"details,representations",t,e.orgId);var s="LibraryFetchElements";return K.SparkPerformanceTracker.mark(s),a.catch((function(e){throw e.statusCode>=500&&o.reset(),K.SparkPerformanceTracker.measure("".concat(s,":failure"),s),e})).then((function(a){var c={elementsReceived:a.elements?a.elements.length:void 0,totalCount:a.total_count,isPublic:e.isPublic(),isTeam:e.isTeam(),orderBy:n,start:r,type:t};return ae.info("Successfully fetched library elements",c),K.SparkPerformanceTracker.measure("".concat(s,":success"),{detail:{type:t,startIndex:r},start:s}),i.setLastStartIndex(ce,{type:t,orderBy:n},r),o.updatePageOfElements(a,e.urn,{type:t,orderBy:n},r,10),{totalCount:a.total_count,items:a.elements}}))},prepReturnList:function(t){return M.a.resolve({elements:t.map((function(t){return i.sparkLibraryElementFactory(t,e)}))})}})}},{key:"loadListViaCacheIfPossible",value:function(e,t){var i,n,r=t.getLastStartIndex,o=t.cacheHasExpired,a=t.clearCachedList,s=t.getCachedList,c=t.setLastStartIndex,l=t.getDataItemsFromCachedEntry,u=t.fetchListFromServer,d=t.prepReturnList,h=(this.cache,e);if(void 0===h){var g=r();h=void 0===g?0:g+10}if(o())a();else{var f=s();if(f){n=f.totalCount;var m=l(f).slice(h,h+10);m.length===Math.min(n-h,10)&&!w()(m,(function(e){return void 0===e}))&&(c(h),i=M.a.resolve({totalCount:n,items:m}))}}return i||(i=u(h)),i.then((function(e){var t=e.items,i=e.totalCount;return d(t).then((function(e){return e.allLoaded=h+10>=i,e.totalCount=i,e}))}))}},{key:"getElementCount",value:function(e){return this.getElementCountOfType(e)}},{key:"getElementCountOfType",value:function(e,t){var i=this.cache,n="-modified_date",r=i.getElementListByType(oe(e),t);return r&&!i.elementListHasExpiredByType(oe(e),t)?M.a.resolve(r.totalCount):(e.publinkMetadata||e.isPublic()?j.getElementsFromPublicLib(e.id,n,0,10,"default",t):j.getElementsFromLib(e.urn,n,0,10,"default",t,e.orgId)).then((function(r){return i.updatePageOfElements(r,oe(e),{type:t,orderBy:n,selector:"default"},0,10,!1,!0),r.total_count}))}},{key:"filterNonSparkTemplates",value:function(e){return e?p()(e,(function(e){return e.getTemplateDcxRepresentation()})):e}},{key:"getCachedLibraryById",value:function(e){if(!this.cache.libraryHasExpired(e)){var t=this.cache.getLibrary(e);if(t)return this.sparkLibraryFactory(t)}}},{key:"pollLibraryStatus",value:function(e){j.getLibraryUrl(e);return B()((function(){return j.getLibrary(e)}),{maxAttempts:5,delay:500,shouldRetry:this._isRetryableError,counter_cb:function(){0}})()}},{key:"pollAndRefreshLibrary",value:function(e){var t=this;return this.pollLibraryStatus(e).then((function(e){return t.cache.updateLibrary(e),t.sparkLibraryFactory(e)}))}},{key:"fetchLastSelectedLibrary",value:function(){return this.lastSelectedLibraryUrn?this.fetchLibraryByUrn(this.lastSelectedLibraryUrn):M.a.resolve()}},{key:"fetchLibraryByUrn",value:function(e){var t=this,i=this.cache;return j.getLibrary(e).then((function(n){var r=i.getLibrary(e),o=i.getElementListSet(e);return t.cache.updateLibrary(n),o&&r&&!i.libraryHasExpired(e)&&n.version!==r.version&&i.clearElementList(n.library_urn),t.sparkLibraryFactory(n)}))}},{key:"createTemplateFromDocument",value:function(e,t,i,n,r){var o=this,a=t.orgId,s=e.getDCXComposite().assetId,c=e.getDocDimensions(),l=r||M.a.resolve(""),u=M()(null),d=k()(),h=!1;i&&(t.isTeam()?u=this._imagePathToLocalFile(i).then((function(e){return j.createRepresentation(t.urn,e,i.type,t.orgId).then((function(e){return{result:e}}))})):(h=!0,u=this.copyThumbnailForTemplate(e,t,d)));var g=P.createTemplateFromDocument(s,t.urn,t.orgId||k()());return M.a.all([l,K.SparkPerformanceTracker.measurePromise("LibraryThumbnailCopy",u),K.SparkPerformanceTracker.measurePromise("LibraryProjectSnapshot",g)]).spread((function(e,i,r){var s=i.result;if(!s)throw new Error("[LibrariesController] Could not find the result of the template thumbnail copy");h||(d=s.id);var l={asset_id:s.urn,content_length:s.content_length||s.size,etag:s.etag,id:d,md5:s.md5,name:"thumbnail.jpg",type:s.type,storage_href:"https://".concat(N.a.ss,"/id/").concat(t.urn,"?component_id=").concat(d),version:"0"};l.width=c.width,l.height=c.height,l.relationship="rendition";var u=r;u.name=n.name+".dcxucf",u.spark_tracking_data=n.spark_tracking_data||{},u.spark_tracking_data.content_summary=e||void 0,u.relationship="primary";var g=j.createElement(t.urn,n.name,n.description,void 0,"application/vnd.adobe.element.template+dcx",[l,u],a).then((function(e){o.cache.clearElementList(oe(t));var i=e&&e.elements&&e.elements[0];if(i)return o.sparkLibraryElementFactory(i,t)}));return K.SparkPerformanceTracker.measurePromise("LibraryElementSaved",g)}))}},{key:"pollTheJobToCopyTheTemplateThumbnail",value:function(e,t){var i=this;return M.a.delay(500).then((function(){var n=e.headers.get("content-type");return(n&&n.includes("json")?e.json():n&&n.includes("http")?e.text().then((function(e){var t=e.split("\n");return JSON.parse(t[t.length-1])})):M()(null)).then((function(e){var n=t||e&&e.href&&"https://".concat(N.a.ss).concat(e.href);if(n)return I.a.getAccessToken().then((function(e){return window.fetch(n,{headers:{Authorization:"Bearer "+e,"x-api-key":N.a.key}}).then((function(e){if(202===e.status)return i.pollTheJobToCopyTheTemplateThumbnail(e,n);if(200===e.status)return e.text().then((function(e){var t=e.split("\n");return JSON.parse(t[t.length-1])}));var t=new Error("[LibrariesController] Got status code from GET ".concat(n,": ").concat(e.status));throw t.status=e.status,t}))}));throw new Error("[LibrariesControlller] pollTheJobToCopyTheTemplateThumbnail: could not find an href to poll with")}))}))}},{key:"copyThumbnailForTemplate",value:function(e,t,i){var n=this,r=k()(),o=e.getMyApp().getSetting("syncGroup"),a=e.getImageRenditionComponent(),s="/assets/".concat(o,"/").concat(e.getDCXComposite().id,"/").concat(a.id),c=(t.urn,"/assets/adobe-libraries/".concat(t.id,"/").concat(i)),l="https://".concat(N.a.ss,"/ops");return I.a.getAccessToken().then((function(e){return window.fetch(l,{method:"POST",headers:{Authorization:"Bearer "+e,"x-api-key":N.a.key,"x-request-id":r,"Content-Type":"application/vnd.adobe.asset-operation+json"},body:JSON.stringify({op:"copy",source:{path:s},target:{path:c}})}).then((function(e){if(202===e.status)return n.pollTheJobToCopyTheTemplateThumbnail(e).catch((function(e){throw e.status?new Error("[LibrariesController] Attempted to copy project thumbnail into library ".concat(t.urn,". Got status code from POST ").concat(l,": ").concat(e.status)):e}));throw new Error("[LibrariesController] Attempted to copy project thumbnail into library ".concat(t.urn,". Got status code from POST ").concat(l,": ").concat(e.status))}))}))}},{key:"_ensureSyncGroup",value:function(e){var t=M.a.defer(),i="/sp-storage/init-temp-storage/"+e;return I.a.ajax({type:"GET",url:i,headers:{"x-api-key":window.marvel.settings.key}}).then((function(e,i,n){t.resolve()})).fail((function(e){t.reject(e)})),t.promise}},{key:"createTemporaryDocumentFromTemplate",value:function(e){var t=this;return this._ensureSyncGroup("adobe-sp-temp").then((function(){return window.marvel.logger.warn("sync group created..."),t.createDocumentFromTemplate(e,"/assets/adobe-sp-temp",{ignoreStockChecks:!0})}))}},{key:"createDocumentFromTemplate",value:function(e,t){var i,n,r,o,s=this,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},l=e.getRepresentationsByType(/dcx/)[0],u=e.id,d=e.library.isPublic(),h=l.storageHref&&-1===l.storageHref.search(/cc-api-storage/),g=h?e.library.orgId||k()():void 0;if(i=d?M.a.resolve(e.library.id):this._URN4HREF(l.storageHref,h),n=h||d?this._URN4HREF("https://".concat(N.a.ss,"/").concat(t),!1):M.a.resolve(t),!c.ignoreStockChecks){var f=e.getTemplateDcxRepresentation();f&&f.sparkTrackingData&&(o=[].concat(a()(f.sparkTrackingData.stock_licensed_ids||[]),a()(f.sparkTrackingData.stock_free_ids||[])))}r=o&&o.length?Q.a.getStockUserInfo().then((function(e){return O.a.verifyOrLicenseIdsForUser(o,e).then((function(e){if(e.error)return e.error.userNotPremium?M.a.reject({userDoesntHaveLicenses:!0,ids:e.unlicensedIds}):e.error.containsNoLongerAvailableImages?M.a.reject({containsNoLongerAvailableImages:!0,ids:e.unavailableIds}):e.error.containsMegaPremiumImages?M.a.reject({containsMegaPremiumImages:!0,ids:e.unlicensedMegaPremiumIds}):M.a.reject({error:e.error});var t=e.lists;return t.noLongerLicensed.length?M.a.reject({userDoesntHaveLicenses:!0,ids:t.noLongerLicensed}):null}))})):M.a.resolve();var m="LibraryTemplateCreateFlow";return K.SparkPerformanceTracker.mark(m),M.a.all([i,n,r]).spread((function(e,t){var i="LibraryProjectCreated";return K.SparkPerformanceTracker.mark(i),s.createDocumentFromTemplateSnapshot(e,t,u,g).then((function(e){return K.SparkPerformanceTracker.measure("LibraryCreatedProjectFromSnapShot",i),e}))}))}},{key:"createDocumentFromTemplateSnapshot",value:function(e,t,i,n){return P.createDocumentFromTemplate(e,t,i,n||k()())}},{key:"_imagePathToLocalFile",value:function(e){return fetch(e.path).then((function(e){return e.arrayBuffer()})).then((function(t){return new File([t],e.name,{type:e.type})}))}},{key:"_PATH4HREF",value:function(e){var t=e.substring("https://".length),i=t.indexOf("adobe.io/"),n=t.substring(i+"adobe.io/".length);return M.a.resolve(n)}},{key:"_URN4HREF",value:function(e,t){var i=this;this._urns4hrefs=this._urns4hrefs||{};var n=M.a.defer(),r=this._urns4hrefs[e];if(r)return r;if(t)return E.default.fetch({method:"HEAD",uri:e,resolveRawResponse:!0,headers:{"If-None-Match":""}}).then((function(t){var n=t.headers.get("x-resource-urn"),r=t.headers.get("x-resource-id"),o=n||r;return i._urns4hrefs[e]=o,o}));var o=e.substring("https://".length),a=o.indexOf("adobe.io/"),s="/resolve_assets_urn/"+o.substring(a+"adobe.io/".length);return I.a.ajax({type:"GET",url:s,headers:{"x-api-key":window.marvel.settings.key}}).then((function(e,t,i){var r=e.urn;n.resolve(r)})).fail((function(e){n.reject(e)})),n.promise}},{key:"getBookmarks",value:function(){return j.getBookmarks()}},{key:"fetchLibraryByPublinkId",value:function(e){var t=this,i=this.cache,n=window.adobeIMS&&window.adobeIMS.isSignedInUser();return E.default.fetch({uri:"https://".concat(N.a.links,"/api/v1/publinks/").concat(e,"?fields=owner"),skipAuth:!n,method:"GET"}).then((function(e){var n=e.resourceURL.replace(/^.*\/([^/]*)$/,"$1");return j.getPublicLibrary(n).then((function(r){var o=i.getLibrary(n),a=i.getElementListSet(n);return t.cache.updateLibrary(r),a&&o&&!i.libraryHasExpired(n)&&r.version!==o.version&&i.clearElementList(r.id),r.publink_metadata=e.metadata,r.owner_id=e.ownerId,r.bookmark=f()({},r.bookmark,{id:e.bookmarkId}),t.sparkLibraryFactory(r)}))}))}},{key:"fetchPublicLibrary",value:function(e){var t=this,i=this.cache;return j.getPublicLibrary(e).then((function(n){var r=i.getLibrary(e);return i.getElementListSet(e)&&r&&!i.libraryHasExpired(e)&&n.version!==r.version&&i.clearElementList(n.id),t.sparkLibraryFactory(n)}))}},{key:"publicLinkLibraryIsOwnedByUser",value:function(e){var t=I.a.getProfile();return!!t&&(e.ownerId&&e.ownerId===t.userId)}},{key:"renameLibrary",value:function(e,t){var i=this,n={name:t};return e.isTeam()&&(n.orgId=e.orgId,n.repository=e.orgId),j.updateLibraryMetadata(e.urn,n,e.orgId).then((function(){i.cache.clearLibraryList({owner:e.cacheList,orderBy:"-name"}),i.cache.clearLibraryList({owner:e.cacheList,orderBy:"name"}),i.cache.updateLibraryName(oe(e),t),e.name=t}))}},{key:"deleteLibrary",value:function(e){var t=this;return j.deleteLibrary(e.urn,e.orgId).then((function(){t.cache.clearLibrary(oe(e),!0),t.cache.clearLibraryList()}))}},{key:"createLibrary",value:function(e){var t=this;return j.createLibrary(e).then((function(e){return t.cache.clearLibraryList(),t.sparkLibraryFactory(f()(e,{ownership:"private"}))}))}},{key:"createLibraryAsync",value:function(e){var t=this;return j.createLibrary(e,!0).then((function(e){var i=e.href,n=1e3*e.retryAfter;return M.a.delay(n).then((function e(){return j.fetchAsyncMonitorHref(i).then((function(r){if(202===r.status)return M.a.delay(n).then(e);if(200===r.status){var o=r.headers.get("content-type");return o&&o.includes("http")?r.text().then((function(e){var i,n=e.split("\n"),r=n[n.length-1];r=(r=(r=(r=r.replace(/"etag":[^,}]*([,}])/g,"$1")).replace(/"manifest_etag":[^,}]*([,}])/g,"$1")).replace(/,,/g,",")).replace(/,}/g,"}");try{if("403.1"===(i=JSON.parse(r)).problem_type_code)throw new Error("403.1 - Storage quota exceeded")}catch(o){throw new Error("Attempted to parse the following as JSON: "+r+" - Got: "+o.message)}return t.cache.clearLibraryList(),t.sparkLibraryFactory(f()(i,{ownership:"private"}))})):null}throw new Error("[LibrariesController] Unexpected response for monitor href "+i)}))}))}))}},{key:"renameElement",value:function(e,t,i){var n=this;return j.updateElementMetadata(e.urn,[{id:t.id,name:i}],e.orgId).then((function(){n.cache.updateElementName(oe(e),t.id,i),t.name=i}))}},{key:"deleteElement",value:function(e,t){var i=this;return j.deleteElement(e.urn,t.id,e.orgId).then((function(){i.cache.clearLibrary(oe(e)),i.cache.clearLibraryList({owner:e.cacheList,orderBy:"-modified_date"}),i.cache.clearLibraryList({owner:e.cacheList,orderBy:"modified_date"}),i.cache.clearElement(oe(e),t.id,!0),i.cache.clearElementList(oe(e))}))}},{key:"createElement",value:function(e,t){var i=this;return this.uploadFile(e,t).then((function(t){i.cache.clearLibrary(oe(e)),i.cache.clearLibraryList({owner:e.cacheList,orderBy:"-modified_date"}),i.cache.clearLibraryList({owner:e.cacheList,orderBy:"modified_date"}),i.cache.clearElementList(oe(e));var n=t.elements;if(!n||!n.length)throw new Error("No element metadata returned after attempting to create a library element");var r=n[0],o=i.sparkLibraryElementFactory(r,e);return j.getRepresentationsForElement(e.urn,o.id,e.orgId).then((function(e){return o.setRepresentations(e),o}))}))}},{key:"uploadFile",value:function(e,t){var i=this.getFileExtension(t),n=ue[i],r=le[i],o=t.name;return t.size<5242880?j.createRepresentation(e.urn,t,r,e.orgId).then((function(t){return j.createElement(e.urn,o,void 0,void 0,n,[t],e.orgId)})):P.uploadFile(t,e.id).then((function(t){ae.info("Successfully uploaded file to Asimov",t);var r={id:t.fileDetails.id,asset_id:t.fileDetails.urn,storage_href:"/assets/adobe-libraries/"+t.composite+"/"+t.fileDetails.id+"/"+t.filename,type:t.contentType,etag:t.fileDetails.etag,content_length:t.contentLength,md5:t.md5,name:t.filename+"."+i,version:0};return j.createElement(e.urn,o,void 0,void 0,n,[r],e.isTeam())})).catch((function(e){throw ae.error("Failed uploading file to Asimov",e),e}))}},{key:"leaveLibrary",value:function(e){var t,i=this;if(e.isPublic()||e.isTeam()){if(!e.bookmark||!e.bookmark.id)throw new Error('Attempted to "leave" public library '+e.urn+" but did not have bookmark id");t=j.deleteBookmark(e.bookmark.id)}else t=S.a.inviteeRemoveSharedByURN(e.urn);return t.then((function(){i.cache.clearLibrary(oe(e),!0),i.cache.clearLibraryList()}))}},{key:"followPublicLibrary",value:function(e){var t=this;return E.default.fetch({uri:"https://".concat(N.a.links,"/api/v1/bookmarks/").concat(e),method:"POST"}).then((function(){t.cache.clearLibraryListByOwner("following")}))}},{key:"getElementFromPublicLibrary",value:function(e,t){var i=this,n=M.a.defer(),r=this.cache.getElement(e.id,t);return void 0!==r?n.resolve(r):j.getElementFromPublicLib(e.id,t).then((function(t){n.resolve(i.sparkLibraryElementFactory(t,e))})).catch((function(e){ae.error("Failed to fetch element from library",e),n.reject(e)})),n.promise}},{key:"sparkLibraryFactory",value:function(e){if(e){var t=b()(e);return M.a.resolve(new V.default(t))}}},{key:"sparkLibraryElementFactory",value:function(e,t){var i=b()(e);return i.library=t,i.representations&&i.representations.forEach((function(e){t.isPublic()&&(e.is_public=!0)})),new q.default(i)}},{key:"onPrivateQuotaBreach",value:function(){window.open(de,"_blank")}},{key:"onTeamQuotaBreach",value:function(){window.open(he,"_blank")}},{key:"triggerLibrariesQuotaErrorToast",value:function(e){var t={variant:"error"};e&&e.isTeam()?(t.message=H.a.formatMessage("libraries-quota-exceeded-team"),t.actionLabel=H.a.formatMessage("libraries-quota-exceeded-team-action"),t.onAction=this.onTeamQuotaBreach,t.closeOnAction=!0):e&&e.isSharedWithUser()?t.message=H.a.formatMessage("libraries-quota-exceeded-shared",{libraryName:e.name}):(t.message=H.a.formatMessage("libraries-quota-exceeded-private"),t.actionLabel=H.a.formatMessage("libraries-quota-exceeded-private-action"),t.onAction=this.onPrivateQuotaBreach,t.closeOnAction=!0),window.marvel.events.trigger("show-app-toast-message",t)}},{key:"saveSelectedTemplateId",value:function(e){if(window.sessionStorage)try{window.sessionStorage.setItem("selected-template-id",e)}catch(t){console.error("Failed to save selected-template-id"+e,t)}}},{key:"getSelectedTemplateId",value:function(){if(window.sessionStorage)try{var e=window.sessionStorage.getItem("selected-template-id");return e?(window.sessionStorage.removeItem("selected-template-id"),e):null}catch(t){return ae.warn("Failed getting or removing selected-template-id from session storage!",t),null}return null}},{key:"lastSelectedLibraryUrn",set:function(e){this._lastSelectedLibraryUrn=e,this.writeToLocalStorage("librarieslastselection",e)},get:function(){return this._lastSelectedLibraryUrn?this._lastSelectedLibraryUrn:this.getFromLocalStorage("librarieslastselection")}},{key:"lastActiveTab",set:function(e){this._lastActiveTab=e,this.writeToLocalStorage("librarieslastactivetab",e)},get:function(){var e=this._lastActiveTab;if(e)e=ge[e]?e:"private";else{this.lastActiveTab=e;var t=this.getFromLocalStorage("librarieslastactivetab");e=ge[t]?t:"private"}return e}}]),e}(),me=new fe;window.LibrariesController=me;t.default=me},3595:function(e,t,i){var n,r;n=[i(16),i(9),i(2),i(11),i(6),i(13),i(63),i(406),i(1593),i(22),i(97),i(33),i(3898),i(3899),i(3900),i(2156),i(1965),i(299),i(1655),i(127),i(2155),i(198)],void 0===(r=function(e,t,i,n,r,o,a,s,c,l,u,d,h,g,f,m,p,v,b,y,w,C){"use strict";var M=new r.default({color:"#0000ff",name:"authoring-context"}),L=["is-body-font","is-body-font-italic","is-body-font-bold","is-body-font-bold-italic"],k={"is-body-font":"Regular","is-body-font-italic":"Italic","is-body-font-bold":"Bold","is-body-font-bold-italic":"Bold Italic"};return n.Model.extend({CURRENT_AC_VERSION:2,CUSTOM_FONTS_AC_VERSION:3,COLLABORATION_AC_VERSION:4,CURRENT_FONT_METRICS_VERSION:1,initialize:function(e){this.collaborators=null,this._isDefault=e||!1},getACVersion:function(){return d.hasFeature("enable-custom-fonts")&&(this.CURRENT_AC_VERSION=this.CUSTOM_FONTS_AC_VERSION),this.CURRENT_AC_VERSION},setCollaboration:function(e){this.collaborators=e},getListOfCollaboratorNames:function(){return(this.collaborators||[]).map((function(e){return e.displayName||e.email}))},_getCanReshare:function(){var e=this._getCollabEntry();return!!e&&e.canShare},canShare:function(){return this.belongsToUser()||this._getCanReshare()},isSharedWithUser:function(){return"INCOMING"===this.composite.getCollaboration()},upgradeVersionForCollaboration:function(){return this.composite.saveChanges(function(e){return e.getValue("ac#version")<this.COLLABORATION_AC_VERSION&&e.setValue("ac#version",this.COLLABORATION_AC_VERSION),this}.bind(this),!0)},getTypeForAnalytics:function(){return this.isSharedWithUser()?"brandType:shared":"brandType:personal"},hasLegacyDefaultFlag:function(){return this.composite.getDCXRoot().getValue("ac#default")},isDefault:function(){return this._isDefault},getId:function(){return this.composite.getDCXComposite().id},getURN:function(){return this.composite.getDCXComposite().assetId},belongsToUser:function(){return this.composite.belongsToUser()},forcePull:function(){return this.syncGroup.getComposite(this.composite.get("id"),void 0,!0)},getCollaborationHref:function(){return"assets/"+this.composite.get("syncGroupName")+"/"+this.composite.get("id")},setComposite:function(e){this.composite=e},getComposite:function(){return this.composite},getType:function(){return this.composite.getDCXRoot().getValue("ac#type")||"brand-kit"},getVersion:function(){return this.composite.get("ac#version")},restrictedAccess:function(){return this.activated()&&!d.hasFeature("entitle-brand-kit")},activate:function(){this.composite.getDCXRoot().setValue("ac#activated",!0)},activated:function(){return!!this.composite.getDCXRoot().getValue("ac#activated")},deactivate:function(){this.composite.getDCXRoot().setValue("ac#activated",!1)},hasBeenEntitled:function(){return!!this.composite.getDCXRoot().getValue("ac#has-been-entitled")},recordEntitlmentIfInterested:function(){return!(this.hasBeenEntitled()||!d.hasFeature("entitle-brand-kit"))&&(this.composite.getDCXRoot().setValue("ac#activated",!0),!0)},getNameUI:function(e){e=e||30;var t,i=this.getName();if(i.length>e)for(t=i.split(" ");t.length&&i.length>e;)t.pop(),i=t.join(" ")+"...";return i},getDefaultName:function(){var e=o.getProfile().first_name||"";return e?e+"'s Authoring Context":"My Authoring Context"},getName:function(){return this.composite.get("name")||this.getDefaultName()},setName:function(e,t){if(t){var n=this.composite.getDCXRoot();return this.composite.set("name",e),n.setValue("name",e),i.resolve()}return this.composite.saveChanges((function(t){t.setValue("name",e)}))},save:function(e){return this.composite.saveChanges(function(e){return e.setValue("ac#version",this.CURRENT_AC_VERSION),this}.bind(this),e)},getAssetsWithRole:function(e,i){return this.composite.acquireNestedChildren(e,!0).then(function(e){return e=t.filter(e||[],function(e){return this.hasRole(e,i)}.bind(this))}.bind(this))},getAssetWithUniqueRole:function(e,t){return this.getAssetsWithRole(e,t).then((function(e){return e[0]}))},hasRole:function(e,i){e.getValue("ac#roles");return t.includes(e.getValue("ac#roles")||[],i)},removeRole:function(e,i){var n=e.getValue("ac#roles");n&&(n=t.without(n,i),e.setValue("ac#roles",n))},addRole:function(e,i){if("string"==typeof i&&(i=i&&i.replace(/^\s*/,"").replace(/\s*$/,""))){var n=e.getValue("ac#roles")||[];t.includes(n,i)||(n.push(i),e.setValue("ac#roles",n))}},setUniqueRoles:function(e,n,r,o){return this.composite.acquireNestedChildren(e,!0).then(function(e){return e=e||[],t.each(e,function(e){t.each(r,function(t){this.removeRole(e,t)}.bind(this))}.bind(this)),t.each(r,function(e){this.addRole(n,e)}.bind(this)),o?i.resolve():this.composite.saveChanges(function(e){}.bind(this))}.bind(this))},setUniqueRole:function(e,t,i){return this.setUniqueRoles(e,t,[i])},setUniqueRolesSync:function(e,i,n){var r=this.composite.acquireNestedChildrenSync(e);r=r||[],t.each(r,function(e){t.each(n,function(t){this.removeRole(e,t)}.bind(this))}.bind(this)),t.each(n,function(e){this.addRole(i,e)}.bind(this))},createTheme:function(e,t,n,r){return this.composite.acquireNestedMap("themes",!0).then(function(o){var a=this.composite.addChildPath(void 0,void 0,o);a.setValue("type","application/vnd.adobe.adobespark.theme+json"),a.setValue("ac#format",e),a.setValue("ac#created",(new Date).toISOString());var s=i.resolve(),c=t(a,this);return c&&c.then&&"function"==typeof c.then&&(s=c),s.then(function(){return this.updateThemeThumbnail(a,a.getValue("theme#data"),n)}.bind(this)).then(function(){return r?a:this.composite.saveChanges((function(){})).then((function(){return a}))}.bind(this))}.bind(this))},updateThemeThumbnail:function(e,i,n){var r=document.createElement("canvas");r.width=520,r.height=280;var o=n(r.getContext("2d"),e),a=this.composite.getDCXComposite().current,c=t.find(a.getComponentsOf(e),(function(e){return"rendition"===e.relationship})),l=this,u=function(){var t=s(r.toDataURL("image/jpeg"));return l.composite.pushComponentWithRetry({name:"thumbnail.jpg",path:"thumbnail",absolutePath:"/themes/"+e.id+"/thumbnail",parent:e,relationship:"rendition",type:"image/jpeg",file:t,isUpdate:!!c})};return o&&o.then&&"function"==typeof o.then?o.then(u):u()},updateThemeThumbnails:function(e){return i.all(t.map(e,function(e){var t=e.theme,i=e.themeController;if(i.generateThemeRendition&&"function"==typeof i.generateThemeRendition)return this.updateThemeThumbnail(t,t.getValue("theme#data"),i.generateThemeRendition.bind(i))}.bind(this)))},getThemeById:function(e){return this.composite.getChildWithMap("themes."+e)},getThemeThumbnailHrefAsync:function(e,n){var r=this.composite.getDCXComposite().current,o=t.find(r.getComponentsOf(e),(function(e){return"rendition"===e.relationship}));return o?this.composite.getImageComponentHref(o,n||500):i.resolve()},getFormatThemes:function(e){return this.composite.acquireNestedChildren("themes",!0).then(function(i){return i=t.filter(i||[],function(t){return t.getValue("ac#format")===e}.bind(this))}.bind(this))},duplicateTheme:function(e,t){var n=i.defer();return this.composite.acquireNestedMap("themes",!0).then(function(i){var n,r=i._owner,o=a.AdobeDCXUtil.generateUuid(),s=e.id;return e._data.id=o,e._data.path=o,n=r.copyChild(e,i,void 0,o,o),e._data.id=s,e._data.path=s,t?n:this.composite.saveChanges((function(e){})).then(function(){return n}.bind(this))}.bind(this)).then(function(e){n.resolve(e)}.bind(this)),n.promise},removeTheme:function(e,t){if(this.composite.removeChild(e),!t)return this.composite.saveChanges((function(e){}))},deleteNamedImageAsset:function(e,t){var i=this.composite.getDCXComposite().current,n=i.getComponentWithAbsolutePath("/"+t+"/"+e.getValue("path")+"/image");return n&&i.removeComponent(n),this.composite.removeChild(e),this.save()},_processImageAsset:function(e,t,n,r,o,a){var s=this.composite.getDCXRoot(),c=this.composite.getDCXComposite().current.getComponentWithAbsolutePath("/"+t+"/"+e+"/image");return this.composite.acquireNestedMap(t+"."+e,!0).then(function(e){return e.setValue("type","application/vnd.adobe.element.image+dcx"),e.setValue("ac#application","spark-web"),this.addRole(e,n),(r&&r.length?this.setUniqueRoles(t,e,r,a):i.resolve()).then(function(){return this.composite.pushComponentWithRetry(o(e,!!c)).then(function(){return a?(s.setValue("ac#version",this.CURRENT_AC_VERSION),e):this.composite.saveChanges(function(e){e.setValue("ac#version",this.CURRENT_AC_VERSION)}.bind(this)).then((function(){return e}))}.bind(this))}.bind(this))}.bind(this))},uploadImageAsset:function(e,t,n,r,o,a,c){var l,u=document.createElement("canvas"),d=u.getContext("2d");if(a){var h=i.defer(),g=new Image;g.onload=function(){var e=g.width,t=g.height,i=e/t;i>1&&e>a?t=1/i*(e=a):t>a&&(e=i*(t=a)),u.width=e,u.height=t,d.drawImage(g,0,0,e,t);var n=s(u.toDataURL("image/png"));h.resolve(n)},g.src=URL.createObjectURL(n),l=h.promise}else l=i.resolve(n);return l.then(function(i){return this._processImageAsset(e,t,r,o,function(n,r){var o={type:i.type,isUpdate:r,parent:n,relationship:"primary",file:i};return r?o.absolutePath="/"+t+"/"+e+"/image":o.path="image",o}.bind(this),c)}.bind(this))},updateImageAsset:function(e,t,i,n,r,o,a){return this._processImageAsset(e,t,o,a,function(o,a){var s={type:n||"image/jpg",path:"image",isUpdate:a,parent:o,relationship:"primary",copyFrom:{source:r,assetId:i}};return a?s.absolutePath="/"+t+"/"+e+"/image":s.path="image",s}.bind(this))},getMappedImageAsset:function(e,t,n){var r=this.composite.getChildWithMap(e);return r?this.composite.getImageComponentHref(r,t,n):i.resolve(null)},hrefForImage:function(e,t,i,n){return this.getMappedImageAsset(e+"."+t.getValue("path")+".!image",i,n)},_getCollabEntry:function(){var e=o.getProfile();return t.find(this.collaborators||[],(function(t){return e.userId&&t.id===e.userId}))},delete:function(){var e=this.getURN();return C.load().then(function(t){return this.composite.delete().then(function(){return t.SparkStorageLoader.flushLocalAuthoringContext(e)}.bind(this))}.bind(this))},getCCStorageURL:function(){return"https://"+window.marvel.settings.ss.replace(/-creativesdk/,"")+"/assets/"+this.composite.get("syncGroupName")+"/"+this.composite.get("id")},getColorsByRole:function(){return this.getColors().then((function(e){var i={};return t.each(e,(function(e){t.each(e.getRoles(),(function(t){i[t]=e}))})),i}))},getDerivedColors:function(e,n){return(e?i.resolve(e):this.getColorWithUniqueRole("base-color")).then(function(t){return e=t,this.getColors("derived-from-"+e.getId())}.bind(this)).then(function(i){i=t.sortBy(i,(function(e){return t.find(e.getRoles(),(function(e){return 0===e.search("shade-")})).replace(/^shade-/,"")}));var r=!1;return t.each(i,(function(t){if(t.hex()===e.hex()&&e.hasRole("base-color")&&!t.hasRole("base-color"))return r=!0,!1})),r?this.updateDerivedColors(e.hex()).then(function(){return this.getDerivedColors(void 0,n)}.bind(this)):t.filter(i,function(e){var i=!0;return t.each(n,(function(t){i&&(i=!e.hasRole(t))})),i}.bind(this))}.bind(this))},updateDerivedColors:function(e,n,r,o){var a,s=["base-color"],l=-1,u=c.hexToRgb(e),d=[],h=function(e,t,i){return this.addColorHexSync(t,[],i,["shade-"+e,"derived"])}.bind(this);return(n?this.getColors("derived-from-"+n.getId()):i.resolve([])).then(function(e){t.each(e,function(e){var i,n;t.each(e.getRoles(),(function(e){-1!=e.search("shade-")?i=e:-1!=e.search("derived-from-")&&(n=e)}));var r=e.getData();this.removeRole(r,n);var o=parseInt(i.replace(/^shade-/,""));e.hasRole("base-color")&&(l=o);for(var a=0,c=s.length;a<c;a++){var u=s[a];this.removeRole(r,u)}d[o]=e}.bind(this));var n,g=c.calcShints(u);t.each(g,function(e,t){var i=d[t];if(e.r===u.r&&e.g===u.g&&e.b===u.b){a=-1===l?i=h(t,c.rgbToHex(e)):i;for(var r=0,o=s.length;r<o;r++){var g=s[r];this.addRole(a.getData(),g)}n=t}i?i.setRGB(e):i=h(t,c.rgbToHex(e)),d[t]=i}.bind(this));var f,m=i.resolve();return o&&(f=n>3?n-2:n+2,m=i.all([this.setUniqueRoles("colors",d[1].getData(),["chrome-background-color","chrome-header-cta-background-color","chrome-footer-background-color"],r),this.setUniqueRoles("colors",d[f].getData(),["chrome-text-color"],r)])),t.each(d,function(e){e&&this.addRole(e.getData(),"derived-from-"+a.getId())}.bind(this)),r?m.then(function(){return{baseColor:a,shades:d}}.bind(this)):m.then(function(){return this.save().then(function(){return{baseColor:a,shades:d}}.bind(this))}.bind(this))}.bind(this))},removeDerivedColors:function(e){return this.composite.acquireNestedChildren("colors",!0).then(function(i){t.each(i,function(i){if(this.hasRole(i,"derived-from-"+e.getId())){var n=new g;n.setData(i),t.find(n.getRoles(),(function(e){return 0===e.indexOf("shade-")}))?this.removeColor(n,!0):console.warn("Unexpected no shade role",i.getRoles())}}.bind(this))}.bind(this))},getColorWithUniqueRole:function(e){return this.getAssetWithUniqueRole("colors",e).then(function(e){if(e){var t=new g;return t.setData(e),t}return null}.bind(this))},getColors:function(e,i){return this.composite.acquireNestedChildren("colors",!0).then(function(n){var r=[];return t.each(n,function(n){if(e&&!this.hasRole(n,e)||t.intersection(n.getValue("ac#roles"),i).length);else{var o=new g;o.setData(n),r.push(o)}}.bind(this)),r}.bind(this))},addColorHex:function(e,i,n,r){return this.composite.acquireNestedMap("colors",!0).then(function(o){var a=this.composite.addChildPath(void 0,void 0,o),s=new g;return s.setData(a),s.setHex(e),n?s.setName(n):s.generateName(),t.each(r||[],function(e){this.addRole(a,e)}.bind(this)),this.composite.saveChanges((function(){})).then(function(){return i&&i.length?this.setUniqueRoles("colors",a,i).then(function(){return s}.bind(this)):s}.bind(this))}.bind(this))},addColorHexSync:function(e,i,n,r){var o=this.composite.acquireNestedMapSync("colors"),a=this.composite.acquireNestedChildrenSync("colors"),s=this.composite.addChildPath(void 0,void 0,o),c=new g;return c.setData(s),c.setHex(e),n?c.setName(n):c.generateName(),t.each(r||[],function(e){this.addRole(s,e)}.bind(this)),t.each(a,function(e){t.each(i,function(t){this.removeRole(e,t)}.bind(this))}.bind(this)),t.each(i,function(e){this.addRole(s,e)}.bind(this)),c},removeColor:function(e,t){if(this.composite.removeChild(e.getData()),!t)return this.composite.saveChanges((function(e){}))},getFonts:function(e){return this.composite.acquireNestedChildren("fonts",!0).then(function(i){var n=[];return t.each(i,function(t){if(e&&!this.hasRole(t,e));else{var i=new f;i.setData(t),n.push(i)}}.bind(this)),n}.bind(this))},getFontWithUniqueRole:function(e){return d.hasFeature("enable-custom-fonts")?this.getFontWithRole(e):this.getAssetWithUniqueRole("fonts",e).then(function(e){if(e){var t=new f;return t.setData(e),t}return null}.bind(this))},addFontFace:function(e,t){var n=new m;return n.setAC(this),n.createFont(e,[t]),i.resolve(n)},addFontWithUniqueRoles:function(e,t,n,r){return this.composite.acquireNestedMap("fonts",!0).then(function(o){var a=this.composite.addChildPath(void 0,void 0,o),s=new f;a.setValue("type","application/vnd.adobe.element.font+dcx"),a.setValue("ac#application","spark-web"),s.setData(a),s.setName(e),s.setValue({source:t,lookupKey:e});var c=i.resolve();return n&&n.length&&(c=this.setUniqueRoles("fonts",a,n)),c.then(function(){if(!r)return this.composite.saveChanges((function(){}))}.bind(this)).then(function(){return s}.bind(this))}.bind(this))},addFont:function(e,n,r,o){return this.composite.acquireNestedMap("fonts",o).then(function(a){var s=this.composite.addChildPath(void 0,void 0,a),c=new f;s.setValue("type","application/vnd.adobe.element.font+dcx"),s.setValue("ac#application","spark-web"),c.setData(s),c.setName(e),c.setValue({source:n,lookupKey:e});i.resolve();return r&&t.each(r,function(e){this.addRole(s,e)}.bind(this)),o?c:this.save().then(function(){return c}.bind(this))}.bind(this))},addFauxFont:function(e,t,i,n,r,o){var a=this.composite.acquireNestedMapSync("all-fonts"),s=this.composite.addChildPath(void 0,void 0,a),c=new m;return s.setValue("type","application/vnd.adobe.element.font+dcx"),s.setValue("ac#application","spark-web"),c.setData(s),c.setName(e+" "+t),c.setValue({source:"faux-font",subgroupName:e,faceName:t,cssName:i,metrics:{metrics:{weight:n,style:r}}}),this.addRole(s,o),this.addRole(s,"custom"),c},findFauxFont:function(e,t,i,n){return this.getCustomFontSubgroup(e).find((function(e){return e.isFauxFont()&&e.fontStyle()==i&&e.fontWeight()==t}))},removeFont:function(e,t){return this.composite.removeChild(e.getData()),t?i.resolve():this.composite.saveChanges((function(e){}))},removeFontWithNode:function(e){return this.composite.removeChild(e),this.composite.saveChanges((function(e){}))},convertFontNodeToAuthoringContextFontFace:function(e){var t=new m;return t.setAC(this),t.setData(e),t},getAllFonts:function(e){var i=this.composite.acquireNestedChildrenSync("all-fonts"),n=[];return t.each(i,function(t){var i=new m;i.setAC(this),i.setData(t),e&&i.isFauxFont(),n.push(i)}.bind(this)),n},getFontById:function(e){var t=this.composite.getChildWithMap("all-fonts.[id="+e+"]");if(t){var i=new m;return i.setAC(this),i.setData(t),i}return null},getFontByLookupKey:function(e){var i=this.getAllFonts();return t.find(i,(function(t){return t.lookupKey()==e}))},getCustomFontByName:function(e,t){return this.composite.getChildWithMap(t+".[name="+e+"]")},getFontWithRole:function(e){return d.hasFeature("enable-custom-fonts")?this.getFontsWithRole(e)[0]:(console.warn("Illegalty, custom-font API without feature flag!"),this.getFontWithUniqueRole(e))},getFontsWithRole:function(e){var i=this.composite.acquireNestedChildrenSync("all-fonts"),n=[];return t.each(i,function(t){if(this.hasRole(t,e)){var i=new m;i.setAC(this),i.setData(t),n.push(i)}}.bind(this)),n},getFontWithRoles:function(e){return this.getFontsWithRoles(e)[0]},getFontsWithRoles:function(e){var i=this.composite.acquireNestedChildrenSync("all-fonts"),n=[];return t.each(i,function(i){var r=!1;if(t.each(e,function(e){if(this.hasRole(i,e))return r=!0,!1}.bind(this)),r){var o=new m;o.setAC(this),o.setData(i),n.push(o)}}.bind(this)),n},sortFontsAlphabetically:function(e){return e.sort((function(e,t){var i=new m,n=new m;return i.setData(e),n.setData(t),i.friendlyName()<n.friendlyName()?-1:1})),e},getFontSubgroups:function(e,i){var n=this.composite.acquireNestedChildrenSync("all-fonts"),r={};return n=this.sortFontsAlphabetically(n),t.each(n,function(t){var n=new m;n.setAC(this),n.setData(t),i&&n.isFauxFont()||(!e||n.isCustomFont()||n.isBodyFont())&&this._organizeBySubgroup(n,r)}.bind(this)),r},_organizeBySubgroup:function(e,t){var i=e.subgroupName(),n=t[i];n?n.push(e):t[i]=new p([e])},getCustomFontSubgroups:function(e,i){var n=this.getCustomFonts(i);n=this.sortFontsAlphabetically(n);var r={};return t.each(n,function(t){e&&!t.isBodyFont()||this._organizeBySubgroup(t,r)}.bind(this)),r},getCustomFontSubgroup:function(e,i){var n,r=this.getCustomFonts(i);return t.each(r,function(t){t.subgroupName()==e&&(n?n.push(t):n=new p([t]))}.bind(this)),n},getFontSubgroup:function(e,i){var n,r=this.getAllFonts(i);return t.each(r,function(t){t.subgroupName()==e&&(n?n.push(t):n=new p([t]))}.bind(this)),n},guessCustomBodyFontSet:function(e){var i=this.getCustomFontSubgroup(e),n=this.getCustomBodyFontSet(e),r=new p([]);return t.each(L,function(e){var t=n.getFontWithRole(e),o=-1!=e.search(/bold/i)?700:400,a=-1!=e.search(/italic/i)?"italic":"normal";t||i.each(function(e){if(e.fontWeight()==o&&e.fontStyle()==a)return t=e,!1}.bind(this)),r.add(t)}.bind(this)),r},establishCustomBodyFontSet:function(e){var i=this.getCustomFontSubgroup(e),n=this.getCustomBodyFontSet(e),r=new p([]),o=i.getPropFromFirst("cssName");return t.each(L,function(t){var a=n.getFontWithRole(t),s=-1!=t.search(/bold/i)?700:400,c=-1!=t.search(/italic/i)?"italic":"normal";if(!a&&(i.each(function(e){if(e.fontWeight()==s&&e.fontStyle()==c)return(a=e).addRole(t),!1}.bind(this)),!a)){if("is-body-font"==t)throw new Error("Normal face was not found - cannot establish body font set without a normal face");this.addFauxFont(e,k[t],o,s,c,t)}r.add(a)}.bind(this)),r},getCustomBodyFontSet:function(e){var i=this.getCustomFontSubgroup(e);if(i&&i.length){var n=new p([]);i.at(0);return t.each(L,function(e){var t=i.getFontWithRole(e);t&&n.add(t,{role:e})}.bind(this)),n}},getFontCollectionWithRoles:function(e){var t=this.getFontsWithRoles(e);return new p(t)},generateFontRenditions:function(e){return v.ENABLE_UPLOADED_FONTS_RENDITIONS?i.allSettled([this.generateFontRendition(e,e.friendlyName(),"rendition"),this.generateFontRendition(e,e.faceName(),"face-rendition"),this.generateFontRendition(e,e.subgroupName(),"family-rendition")]):i.resolve()},generateFontRendition:function(e,n,r){var o=i.defer(),a=e.getData(),c=this.composite.getDCXComposite().current.getComponentsOf(a),l=t.find(c,(function(e){return e.name==r}));return e.loadFont().then(function(){var t=w.generateCanvas(e.cssName(),n,{weight:e.fontWeight(),style:e.fontStyle(),padding:2,fnNormal:function(t){return v.getFontNormalized(t,e.getMetrics())}}),i=s(t.toDataURL("image/png"));o.resolve(this.composite.pushComponentWithRetry({type:"image/png",path:r,isUpdate:!!l,parent:a,relationship:"rendition",file:i},"image/png"))}.bind(this)),o.promise},uploadCustomFontMetrics:function(e,t,n){n.category="Spark Client Generated";var r=this.composite.getChildWithMap(t+".[name="+e+"]");return r?(r.getValue("font#data").metrics=n,this.composite.saveChanges(function(e){e.setValue("ac#version",this.CURRENT_AC_VERSION)}.bind(this))):(console.warn("Error: no font wrapper defined in dcx for metrics"),i.reject(new Error("AuthoringContextCls::uploadCustomFontMetrics")))},createFontCollection:function(e){var i=new p;return t.each(e,(function(e){i.add(e)})),i},convertPostFaceToJSON:function(e){return v.convertPostFaceToJSON(e)},convertPostFaceToAC:function(e){return v.convertPostFaceToAC(e)},createOrUpdateFontFiles:function(e,n){var r=this.composite.getDCXComposite(),s=r.current,c=s.getComponentsOf(e),u=t.reduce(c,function(e,t){return e[t.getValue("name")]=t.getValue("id"),e}.bind(this),{}),h=i.defer(),g=function(i,n,r){if(i)return M.error("Upload failed with "+i.message,i),0===c.length?(M.error("Removing newly created font node"),this.removeFontWithNode(e).then((function(){h.reject(i)}))):h.reject(i);var o;if(!!t.find(Object.keys(u),(function(e){return!!u[e]}))){var a=r.absolutePath||"/"+r.path;o=s.getComponentWithAbsolutePath(a),o=s.updateComponentWithUploadResults(o,n)}else o=s.addComponentWithUploadResults(r.name,r.relationship,r.path,e,n)}.bind(this),f=new FormData;f.append("calculateSubsets",d.hasFeature("enable-custom-fonts-subsets")),f.append("compositeId",r.id),f.append("componentList",encodeURIComponent(JSON.stringify(u))),t.each(n,(function(e,t){e&&f.append("file"+t,e)}));var m=l.v4(),p={otf:!0,ttf:!0,woff:!0},v={method:"PUT",url:"/fonts",dataType:"json",data:f,processData:!1,contentType:!1,beforeSend:function(e){e.setRequestHeader("X-Request-Id",m)},success:function(e,i,n){if(200!=n.status&&201!=n.status)return g(new Error("Upload came back with "+n.status+" "+n.responseText));var o=n.responseJSON;t.each(o,(function(e){var t=a.createUploadResults(r.id,r.assetId),i=a.createUploadRecord(e.componentId,e.etag,e.latestVersion,e.md5,e.size,e.type);t.addUploadRecord(e.componentId,i),g(null,t,{name:e.ext,path:e.ext,relationship:p[e.ext]?"primary":"subset"})})),h.resolve()},error:function(e){return g(e)}};return o.ajax(v),h.promise},createOrUpdateCustomFont:function(e,i,n,r){this.composite.getDCXComposite().current;var o,a,s=this.composite.getChildWithMap("all-fonts.[name="+name+"]");if(!s){o=this.composite.acquireNestedMapSync("all-fonts"),(s=this.composite.addChildPath(void 0,void 0,o)).setValue("name",e+" "+i),s.setValue("type","application/vnd.adobe.element.custom-font+dcx"),s.setValue("ac#application","spark-web"),this.addRole(s,"custom"),a={source:"user-uploaded",subgroupName:e,faceName:i,cssName:n};var c=s.getValue("font#data");s.setValue("font#data",t.extend({},c,a,r||{}))}var l=new m;return l.setAC(this),l.setData(s),l},acquireSparkFont:function(e){var t=this.getFontByLookupKey(e);if(t)return t;var i=this.composite.acquireNestedMapSync("all-fonts"),n=this.composite.addChildPath(void 0,void 0,i);n.setValue("type","application/vnd.adobe.element.font+dcx"),n.setValue("ac#application","spark-web"),n.setValue("font#data",{source:"spark-provided",lookupKey:e});var r=new m;return r.setAC(this),r.setData(n),r},_hrefForCustomFontRenditionAsync:function(e,n){i.defer();var r=this.composite.getDCXComposite().current.getComponentsOf(e),o=t.find(r,(function(e){return"rendition"===e.getValue("rel")&&(!n||e.getValue("path")===n)}));if(o)return this.composite._privateGetComponentHref(o).then((function(e){return e.indexOf("/id/")>=0&&(e=e.replace(/\/id/,"/image_assets")),e}))},getSubsetIdsForCharacterList:function(e){var i={},n=[];return t.each(e,function(e){for(var t=0,r=h.length;t<r;t++){var o=h[t],a=parseInt(o.range[0],16),s=parseInt(o.range[1],16);if(e>=a&&e<=s&&!i[o.id]){i[o.id]=!0,n.push(o.id);break}}}.bind(this)),n},_hrefForCustomFontAsync:function(e,n){var r;if("string"==typeof e)r=this.composite.getChildWithMap("all-fonts.[name="+e+"].!"+n);else{var o=e,a=this.composite.getDCXComposite().current.getComponentsOf(o);if(n)r=t.find(a,(function(e){return e.path==n}));else{var s,c,l=t.filter(a,(function(e){return"primary"==e.getValue("rel")}));if(1==l.length)r=l[0];else t.each(l,(function(e){"otf"==e.name&&(s=e),"ttf"==e.name&&(c=e)})),r=s||c||void 0}}return r?this.composite._privateGetComponentHref(r).then((function(e){0===e.search(/\/id/)?e=e.replace(/\/id/,"/image_assets"):0===e.search(/id/)&&(e=e.replace(/id/,"/image_assets"));var t=r.name;return t&&(e+="&mime=application/"+t),e})):i.resolve(null)},getComponentForCustomFont:function(e,i){var n,r=this.composite.getDCXComposite().current,o=e.getData(),a=r.getComponentsOf(o);if(i)n=t.find(a,(function(e){return e.path==i}));else{var s,c,l=t.filter(a,(function(e){return"primary"==e.getValue("rel")}));if(1==l.length)n=l[0];else t.each(l,(function(e){"otf"==e.name&&(s=e),"ttf"==e.name&&(c=e),"ttf"==e.name&&(c=e)})),n=s||c||void 0}return n},getCustomFonts:function(e){var i=this.getFontsWithRole("custom");return e?t.filter(i,(function(e){return!e.isFauxFont()})):i},getDataPageInfo:function(e,t){var i,n=this.composite.getChildWithMap(t);return n&&(i=n.getValue(t+"#data"))?e?i[e]:i:e?"":{}},setDataPageInfo:function(e,n,r,o){var a;return"object"==typeof e?a=e:(a={})[e]=n,this.composite.acquireNestedMap(r,!0).then(function(e){e.setValue("ac#application","spark-web"),e.setValue("type","application/vnd.adobe.spark."+r+"+dcx");var n=e.getValue(r+"#data")||{};return t.each(a,(function(e,t){n[t]=e})),e.setValue(r+"#data",n),o?i.resolve():this.composite.saveChanges(function(e){}.bind(this))}.bind(this))},getViewerPageInfo:function(e){return this.getDataPageInfo(e,"viewerpage")},setViewerPageInfo:function(e,t,i){return this.setDataPageInfo(e,t,"viewerpage",i)},getOutroInfo:function(e){return this.getDataPageInfo(e,"videooutro")},setOutroInfo:function(e,t,i){return this.setDataPageInfo(e,t,"videooutro",i)},fullUpdate:function(){},isFullUpdateNeeded:function(){},validateAndRepair:function(){return i.resolve(this)},upgrade:function(){var e=this.composite.getDCXRoot().getValue("ac#version");if(this.getACVersion(),e>this.CURRENT_AC_VERSION&&window.marvel.logger.traceflow("brand-kit","[BrandKit] found newer brand (v"+e+" > v"+this.CURRENT_AC_VERSION+")."),e<this.CURRENT_AC_VERSION&&d.hasFeature("enable-custom-fonts")){var t=this.composite.getChildWithMap("fonts"),i=this.composite.getChildWithMap("all-fonts");i&&t&&(this.composite.removeChild(i),i=null),t?t.setValue("path","all-fonts"):i||this.composite.acquireNestedMapSync("all-fonts"),this.composite.getDCXRoot().setValue("ac#version",this.CURRENT_AC_VERSION)}return this.validateAndRepair()},getThemeletById:function(e){var i=this.composite.acquireNestedChildrenSync("themes"),n=null;return t.each(i,(function(t,i){t.id===e&&(n=t)})),n},getThemeUpdateInterface:function(){var e=this,n=d.hasFeature("enable-brand-kit-in-progress"),r={};return i.all(t.map(u.apps,(function(t){var i=t.typeName;if(n||d.hasFeature("enable-brand-kit-"+i+"-themes"))return t.getThemeController(e).then((function(e){r[i]=e}))}))).then(function(){var o={themeControllers:r,forEachTheme:function(i){var o=e.composite.acquireNestedChildrenSync("themes"),a=[];return t.each(o,(function(e,t){var o=e.getValue("ac#format");if(n||d.hasFeature("enable-brand-kit-"+o+"-themes")){var s=r[o];a.push(i(e,s))}})),a},getThemesUsingAssets:function(e){var t=[];return o.forEachTheme((function(i,n){if(n.areAssetsUsed&&"function"==typeof n.areAssetsUsed)try{n.areAssetsUsed(i,e)&&t.push({theme:i,themeController:n})}catch(r){console.warn("ignoring exception from format themeController - please fix themeController.areAssetsUsed(theme, assets).",n)}})),t},updateThemesWithAssets:function(e,n){if(n)return i.all(t.map(e,(function(e){var t=e.theme,i=e.themeController;if(i.updateLinkedAssets&&"function"==typeof i.updateLinkedAssets)return i.updateLinkedAssets(t,n)})))},relinkThemesWithAssets:function(e,n){var r;if(n)return r=n[0]&&!t.isArray(n[0])?t.map(n,(function(e){return[e.old,e.new]})):t.extend([],n),i.all(t.map(e,(function(e){var t=e.theme,i=e.themeController;return i.relinkAssetsWithRoles&&"function"==typeof i.relinkAssetsWithRoles?i.relinkAssetsWithRoles(t,n):i.relinkAssets&&"function"==typeof i.relinkAssets?i.relinkAssets(t,r):void 0})))}};return o}.bind(this))}})}.apply(t,n))||(e.exports=r)},375:function(e,t,i){"use strict";i.r(t),i.d(t,"default",(function(){return M}));var n=i(4),r=i.n(n),o=i(3),a=i.n(o),s=i(29),c=i.n(s),l=i(28),u=i.n(l),d=i(30),h=i.n(d),g=i(64),f=i.n(g),m=i(98),p=i.n(m),v=(i(2),i(1)),b=i.n(v),y=i(13),w=i.n(y),C=i(132),M=function(e){function t(e){var i,n;if(r()(this,t),(i=c()(this,u()(t).call(this,e)))._links=e._links,i.id=e.id,i.urn=e.library_urn,i.name=e.name,i.version=e.version,i.created=e.created_date,i.modified=e.modified_date,i.ownership=e.ownership||"",i._canOnlyBeEditedByXD=!(!e.document_type&&!e.document_id),i.cacheList="team"===e.ownership?"incoming":e.ownership,e.collaboration&&e.collaboration.collaborators?i.collaborators=e.collaboration.collaborators:i.collaborators=[],i.storagePath=e.storage_path,i.bookmark=e.bookmark,i.orgId="team"===e.ownership?e.org_id:void 0,i.publinkMetadata=e.publink_metadata,i.ownerId=e.owner_id,i.hasPublicLink=e.collaboration&&e.collaboration.public,e.asset_acl)if(e.asset_acl.describedBy)n=e.asset_acl.describedBy;else{var o=e.asset_acl["*"];if(o)n=o;else{var a=Object.keys(e.asset_acl).find((function(e){return-1!==e.search("primary")})),s=e.asset_acl[a];if(s)n=s;else{var l=Object.keys(e.asset_acl).find((function(e){return-1!==e.search("repository")})),d=e.asset_acl[l];n=d||[]}}}var h=Array.from(new Set(n));i.acl=h.reduce((function(e,t){return e[t]=!0,e}),{});var g=e.rendition_grid,f=g&&g.main,m=g&&g.tiles;return i.renditionGrid=[],g&&(i.renditionGrid=f?[f.rendition]:[void 0],m&&(i.renditionGrid=i.renditionGrid.concat(m.map((function(e){return e?e.rendition:void 0}))))),i}return h()(t,e),a()(t,[{key:"toJSON",value:function(){return{id:this.id,urn:this.urn,name:this.name,version:this.version,created:this.created,modified:this.modified,ownership:this.ownership,collaborators:this.getListOfCollaboratorNames()}}},{key:"belongsToUser",value:function(){return"private"===this.ownership||"outgoing"===this.ownership}},{key:"isSharedWithUser",value:function(){return"incoming"===this.ownership||"team"===this.ownership}},{key:"hasCollaborators",value:function(){return"incoming"===this.ownership||this.collaborators&&this.collaborators.length>1}},{key:"isFollowedByUser",value:function(){return!!(this.isPublic()&&this.bookmark&&this.bookmark.created)}},{key:"isPublic",value:function(){return"public"===this.ownership}},{key:"isTeam",value:function(){return"team"===this.ownership}},{key:"hasRenditionGridTiles",value:function(){return!!this.renditionGrid&&this.renditionGrid.length>1}},{key:"getBookmarkId",value:function(){return this.bookmark?this.bookmark.id:void 0}},{key:"getRenditionHrefFromGrid",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0,i=this.renditionGrid[e];return i&&"string"==typeof i&&0===i.search(/^http/)&&t?this.getProxyRenditionHref(i,1e3):i}},{key:"getTemplateElements",value:function(){return p()(this.elements,(function(e){var t=e.getRepresentationsByType("application/vnd.adobe.theo.document+dcx");return t&&1===t.length}))}},{key:"getPrimaryRenditionHref",value:function(){return this.getRenditionHrefFromGrid(0,!0)}},{key:"setCollaboration",value:function(e){this.collaborators=e}},{key:"getListOfCollaboratorNames",value:function(){return(this.collaborators||[]).map((function(e){return e.displayName||e.email}))}},{key:"_getCollabEntry",value:function(){var e=w.a.getProfile();return f()(this.collaborators||[],(function(t){return e.userId&&t.collaborator===e.userId}))}},{key:"getRole",value:function(){if(this.bookmark&&"collab"===this.bookmark.type&&this.bookmark.role)return this.bookmark.role;var e=this._getCollabEntry();return e?e.role:void 0}},{key:"hasTeamAcl",value:function(e){return!!this.acl[e]}},{key:"canOnlyBeEditedByXD",value:function(){return this._canOnlyBeEditedByXD}},{key:"canEdit",value:function(){return this.isTeam()?!!this.hasTeamAcl("write"):this.belongsToUser()||"editor"===this.getRole()}},{key:"canDelete",value:function(){return this.belongsToUser()||this.isTeam()&&this.hasTeamAcl("delete")}},{key:"_getCanReshare",value:function(){if(this.isTeam())return!0;var e=this._getCollabEntry();return!!e&&e.canShare}},{key:"canShare",value:function(){return this.belongsToUser()||this._getCanReshare()}},{key:"getStorageURL",value:function(){var e=b.a.ss.replace("-creativesdk","");return"https://".concat(e,"/id/").concat(this.urn)}}]),t}(C.a)},376:function(e,t,i){"use strict";i.r(t),i.d(t,"default",(function(){return x}));var n=i(4),r=i.n(n),o=i(3),a=i.n(o),s=i(29),c=i.n(s),l=i(28),u=i.n(l),d=i(30),h=i.n(d),g=i(98),f=i.n(g),m=i(64),p=i.n(m),v=i(62),b=i.n(v),y=i(2),w=i.n(y),C=i(17),M=i.n(C),L=i(132),k=function(e){function t(e){var i;return r()(this,t),(i=c()(this,u()(t).call(this,e)))._links=e._links,i.library=e.library,i.id=e.id,i.type=e.type,i.version=e.version,i.relationship=e.relationship,i.path=e.path,i.isComponent=e.is_component,i.isPublic=e.is_public,i.isMocked=e.is_mocked,i.storageHref=e.storage_href,i.etag=e.etag,i.width=e.width,i.height=e.height,i.linkType=e.linktype,i.contentLength=e.content_length,i.stockData=e["adobestock#trackingdata"],i.sparkTrackingData=e.spark_tracking_data,i.brandUrn=i.sparkTrackingData?i.sparkTrackingData.brand_urn:void 0,i.theoPageCount=i.sparkTrackingData?i.sparkTrackingData.theoPageCount:void 0,i}return h()(t,e),a()(t,[{key:"getRenditionHref",value:function(e){return this.isMocked?this.storageHref:((t=this.getLink("rendition",{size:1e3}))||(t=this.getLink("primary")),t?this.getProxyRenditionHref(t,1e3):(t=(this.isPublic?"/image_assets/public/adobe-libraries/":"/image_assets/adobe-libraries/")+this.library.id+"/?asset_id="+this.id,this.type&&(t+="&size="+(e||1e3),-1===["image/jpg","image/jpeg","image/png"].indexOf(this.type)?t+="&mime="+encodeURIComponent("image/png"):t+="&mime="+encodeURIComponent(this.type)),t));var t}},{key:"toJSON",value:function(){var e={id:this.id,type:this.type,relationship:this.relationship,path:this.path};this.storageHref&&(e.storageHref=this.storageHref),this.etag&&(e.etag=this.etag),this.width&&(e.width=this.width),this.height&&(e.height=this.height),this.stockData&&(e.stockData=this.stockData);var t=this.getRenditionHref();return t&&(e.renditionHref=t),e}}]),t}(L.a);var x=function(e){function t(e){var i;return r()(this,t),(i=c()(this,u()(t).call(this,e)))._links=e._links,i.library=e.library,i.id=e.id,i.name=e.name,i.thumbnail=e.thumbnail?e.thumbnail.rendition:void 0,i.type=e.type,i.created_date=e.created_date?e.created_date:void 0,i.modified_date=e.modified_date?e.modified_date:void 0,i.description=e.details?e.details.description:void 0,i.storage_used=e.storage_used,i.setRepresentations(e.representations||[]),i}return h()(t,e),a()(t,[{key:"setRepresentations",value:function(e){var t=this;this.representations=e.map((function(e){return new k(b()(e,{library:t.library}))}))}},{key:"getTemplateDcxRepresentation",value:function(){return p()(this.representations,(function(e){return"application/vnd.adobe.theo.document+dcx"===e.type||"application/vnd.adobe.theo.document+dcxucf"===e.type}))}},{key:"getRepresentationsByType",value:function(e){return e instanceof RegExp?f()(this.representations,(function(t){return-1!==t.type.search(e)})):f()(this.representations,(function(t){return t.type===e}))}},{key:"getComponentRepresentation",value:function(){return p()(this.representations,(function(e){return e.isComponent}))}},{key:"getDateString",value:function(e){var t=60*(new Date).getTimezoneOffset()*1e3-252e5,i=new Date(e-t),n=i.toLocaleDateString(),r=i.getHours(),o=r>12;r=o?r-12:r;var a=i.getMinutes(),s=M.a.getString("timeformat-abbr-am"),c=M.a.getString("timeformat-abbr-pm");return"".concat(n,", ").concat(r,":").concat(a).concat(o?c:s)}},{key:"getPrimaryRepresentation",value:function(){if(!this.primaryRepresentation){var e=f()(this.representations,(function(e){return"primary"===e.relationship}));this.primaryRepresentation=e&&e.length>0?e[0]:void 0}return this.primaryRepresentation}},{key:"getPrimaryImageRepresentation",value:function(){return this.primaryImageRepresentation||(this.primaryImageRepresentation=this.getRepresentationsByType(/image/)[0]),this.primaryImageRepresentation}},{key:"getPrimaryImageRepresentationHref",value:function(){var e=this.getPrimaryImageRepresentation();return e||(e=this.representations&&this.representations.length>0?this.representations[0]:void 0),e?e.getRenditionHref():void 0}},{key:"getThumbnailHref",value:function(){if(this.thumbnail)return this.getProxyRenditionHref(this.thumbnail,1e3)}},{key:"loadPrimaryImageRepresentationHref",value:function(){var e=w.a.defer(),t=this.getPrimaryImageRepresentationHref();if(t){var i=new Image;i.onload=function(){e.resolve()},i.onerror=function(t){e.reject(t)},i.src=t}else e.resolve();return e.promise}},{key:"getPrimaryImageRepresentationType",value:function(){var e=this.getPrimaryImageRepresentation();return e?e.type:"unknown"}},{key:"getRenditionHref",value:function(){return this.getLink("rendition")}},{key:"toJSON",value:function(){return{id:this.id,name:this.name,type:this.type,created:this.created_date,modified:this.modified_date,representations:this.representations}}},{key:"addRepresentationWithMetadata",value:function(e){var t=new k(e);return this.representations.push(t),t}},{key:"size",get:function(){var e=this.getComponentRepresentation();if(e){var t=e.contentLength;if(void 0!==t)return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,i=M.a.getString("file-size-units-bytes"),n=M.a.getString("file-size-units-kilobytes"),r=M.a.getString("file-size-units-megabytes"),o=M.a.getString("file-size-units-gigabytes"),a=M.a.getString("file-size-units-terabytes"),s=M.a.getString("file-size-units-petabytes"),c=M.a.getString("file-size-units-exabytes"),l=M.a.getString("file-size-units-zetabytes"),u=M.a.getString("file-size-units-yottabytes");if(0===e)return"0 Bytes";var d=t<0?0:t,h=[i,n,r,o,a,s,c,l,u],g=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,g)).toFixed(d))+" "+h[g]}(t,1)}}},{key:"createdString",get:function(){return this.getDateString(this.created_date)}},{key:"modifiedString",get:function(){return this.getDateString(this.modified_date)}}]),t}(L.a)},3898:function(e){e.exports=JSON.parse('[{"name":"Control characters","id":"control-characters","range":["0000","001F"]},{"name":"Basic Latin","id":"basic-latin","range":["0020","007F"]},{"name":"Latin-1 Supplement","id":"latin-1-supplement","range":["0080","00FF"]},{"name":"Latin Extended-A","id":"latin-extended-a","range":["0100","017F"]},{"name":"Latin Extended-B","id":"latin-extended-b","range":["0180","024F"]},{"name":"IPA Extensions","id":"ipa-extensions","range":["0250","02AF"]},{"name":"Spacing Modifier Letters","id":"spacing-modifier-letters","range":["02B0","02FF"]},{"name":"Combining Diacritical Marks","id":"combining-diacritical-marks","range":["0300","036F"]},{"name":"Greek and Coptic","id":"greek-and-coptic","range":["0370","03FF"]},{"name":"Cyrillic","id":"cyrillic","range":["0400","04FF"]},{"name":"Cyrillic Supplement","id":"cyrillic-supplement","range":["0500","052F"]},{"name":"Armenian","id":"armenian","range":["0530","058F"]},{"name":"Hebrew","id":"hebrew","range":["0590","05FF"]},{"name":"Arabic","id":"arabic","range":["0600","06FF"]},{"name":"Syriac","id":"syriac","range":["0700","074F"]},{"name":"Arabic Supplement","id":"arabic-supplement","range":["0750","077F"]},{"name":"Thaana","id":"thaana","range":["0780","07BF"]},{"name":"NKo","id":"nko","range":["07C0","07FF"]},{"name":"Samaritan","id":"samaritan","range":["0800","083F"]},{"name":"Mandaic","id":"mandaic","range":["0840","085F"]},{"name":"Syriac Supplement","id":"syriac-supplement","range":["0860","086F"]},{"name":"Arabic Extended-A","id":"arabic-extended-a","range":["08A0","08FF"]},{"name":"Devanagari","id":"devanagari","range":["0900","097F"]},{"name":"Bengali","id":"bengali","range":["0980","09FF"]},{"name":"Gurmukhi","id":"gurmukhi","range":["0A00","0A7F"]},{"name":"Gujarati","id":"gujarati","range":["0A80","0AFF"]},{"name":"Oriya","id":"oriya","range":["0B00","0B7F"]},{"name":"Tamil","id":"tamil","range":["0B80","0BFF"]},{"name":"Telugu","id":"telugu","range":["0C00","0C7F"]},{"name":"Kannada","id":"kannada","range":["0C80","0CFF"]},{"name":"Malayalam","id":"malayalam","range":["0D00","0D7F"]},{"name":"Sinhala","id":"sinhala","range":["0D80","0DFF"]},{"name":"Thai","id":"thai","range":["0E00","0E7F"]},{"name":"Lao","id":"lao","range":["0E80","0EFF"]},{"name":"Tibetan","id":"tibetan","range":["0F00","0FFF"]},{"name":"Myanmar","id":"myanmar","range":["1000","109F"]},{"name":"Georgian","id":"georgian","range":["10A0","10FF"]},{"name":"Hangul Jamo","id":"hangul-jamo","range":["1100","11FF"]},{"name":"Ethiopic","id":"ethiopic","range":["1200","137F"]},{"name":"Ethiopic Supplement","id":"ethiopic-supplement","range":["1380","139F"]},{"name":"Cherokee","id":"cherokee","range":["13A0","13FF"]},{"name":"Unified Canadian Aboriginal Syllabics","id":"unified-canadian-aboriginal-syllabics","range":["1400","167F"]},{"name":"Ogham","id":"ogham","range":["1680","169F"]},{"name":"Runic","id":"runic","range":["16A0","16FF"]},{"name":"Tagalog","id":"tagalog","range":["1700","171F"]},{"name":"Hanunoo","id":"hanunoo","range":["1720","173F"]},{"name":"Buhid","id":"buhid","range":["1740","175F"]},{"name":"Tagbanwa","id":"tagbanwa","range":["1760","177F"]},{"name":"Khmer","id":"khmer","range":["1780","17FF"]},{"name":"Mongolian","id":"mongolian","range":["1800","18AF"]},{"name":"Unified Canadian Aboriginal Syllabics Extended","id":"unified-canadian-aboriginal-syllabics-extended","range":["18B0","18FF"]},{"name":"Limbu","id":"limbu","range":["1900","194F"]},{"name":"Tai Le","id":"tai-le","range":["1950","197F"]},{"name":"New Tai Lue","id":"new-tai-lue","range":["1980","19DF"]},{"name":"Khmer Symbols","id":"khmer-symbols","range":["19E0","19FF"]},{"name":"Buginese","id":"buginese","range":["1A00","1A1F"]},{"name":"Tai Tham","id":"tai-tham","range":["1A20","1AAF"]},{"name":"Combining Diacritical Marks Extended","id":"combining-diacritical-marks-extended","range":["1AB0","1AFF"]},{"name":"Balinese","id":"balinese","range":["1B00","1B7F"]},{"name":"Sundanese","id":"sundanese","range":["1B80","1BBF"]},{"name":"Batak","id":"batak","range":["1BC0","1BFF"]},{"name":"Lepcha","id":"lepcha","range":["1C00","1C4F"]},{"name":"Ol Chiki","id":"ol-chiki","range":["1C50","1C7F"]},{"name":"Cyrillic Extended C","id":"cyrillic-extended-c","range":["1C80","1C8F"]},{"name":"Sundanese Supplement","id":"sundanese-supplement","range":["1CC0","1CCF"]},{"name":"Vedic Extensions","id":"vedic-extensions","range":["1CD0","1CFF"]},{"name":"Phonetic Extensions","id":"phonetic-extensions","range":["1D00","1D7F"]},{"name":"Phonetic Extensions Supplement","id":"phonetic-extensions-supplement","range":["1D80","1DBF"]},{"name":"Combining Diacritical Marks Supplement","id":"combining-diacritical-marks-supplement","range":["1DC0","1DFF"]},{"name":"Latin Extended Additional","id":"latin-extended-additional","range":["1E00","1EFF"]},{"name":"Greek Extended","id":"greek-extended","range":["1F00","1FFF"]},{"name":"General Punctuation","id":"general-punctuation","range":["2000","206F"]},{"name":"Superscripts and Subscripts","id":"superscripts-and-subscripts","range":["2070","209F"]},{"name":"Currency Symbols","id":"currency-symbols","range":["20A0","20CF"]},{"name":"Combining Diacritical Marks for Symbols","id":"combining-diacritical-marks-for-symbols","range":["20D0","20FF"]},{"name":"Letterlike Symbols","id":"letterlike-symbols","range":["2100","214F"]},{"name":"Number Forms","id":"number-forms","range":["2150","218F"]},{"name":"Arrows","id":"arrows","range":["2190","21FF"]},{"name":"Mathematical Operators","id":"mathematical-operators","range":["2200","22FF"]},{"name":"Miscellaneous Technical","id":"miscellaneous-technical","range":["2300","23FF"]},{"name":"Control Pictures","id":"control-pictures","range":["2400","243F"]},{"name":"Optical Character Recognition","id":"optical-character-recognition","range":["2440","245F"]},{"name":"Enclosed Alphanumerics","id":"enclosed-alphanumerics","range":["2460","24FF"]},{"name":"Box Drawing","id":"box-drawing","range":["2500","257F"]},{"name":"Block Elements","id":"block-elements","range":["2580","259F"]},{"name":"Geometric Shapes","id":"geometric-shapes","range":["25A0","25FF"]},{"name":"Miscellaneous Symbols","id":"miscellaneous-symbols","range":["2600","26FF"]},{"name":"Dingbats","id":"dingbats","range":["2700","27BF"]},{"name":"Miscellaneous Mathematical Symbols-A","id":"miscellaneous-mathematical-symbols-a","range":["27C0","27EF"]},{"name":"Supplemental Arrows-A","id":"supplemental-arrows-a","range":["27F0","27FF"]},{"name":"Braille Patterns","id":"braille-patterns","range":["2800","28FF"]},{"name":"Supplemental Arrows-B","id":"supplemental-arrows-b","range":["2900","297F"]},{"name":"Miscellaneous Mathematical Symbols-B","id":"miscellaneous-mathematical-symbols-b","range":["2980","29FF"]},{"name":"Supplemental Mathematical Operators","id":"supplemental-mathematical-operators","range":["2A00","2AFF"]},{"name":"Miscellaneous Symbols and Arrows","id":"miscellaneous-symbols-and-arrows","range":["2B00","2BFF"]},{"name":"Glagolitic","id":"glagolitic","range":["2C00","2C5F"]},{"name":"Latin Extended-C","id":"latin-extended-c","range":["2C60","2C7F"]},{"name":"Coptic","id":"coptic","range":["2C80","2CFF"]},{"name":"Georgian Supplement","id":"georgian-supplement","range":["2D00","2D2F"]},{"name":"Tifinagh","id":"tifinagh","range":["2D30","2D7F"]},{"name":"Ethiopic Extended","id":"ethiopic-extended","range":["2D80","2DDF"]},{"name":"Cyrillic Extended-A","id":"cyrillic-extended-a","range":["2DE0","2DFF"]},{"name":"Supplemental Punctuation","id":"supplemental-punctuation","range":["2E00","2E7F"]},{"name":"CJK Radicals Supplement","id":"cjk-radicals-supplement","range":["2E80","2EFF"]},{"name":"Kangxi Radicals","id":"kangxi-radicals","range":["2F00","2FDF"]},{"name":"Ideographic Description Characters","id":"ideographic-description-characters","range":["2FF0","2FFF"]},{"name":"CJK Symbols and Punctuation","id":"cjk-symbols-and-punctuation","range":["3000","303F"]},{"name":"Hiragana","id":"hiragana","range":["3040","309F"]},{"name":"Katakana","id":"katakana","range":["30A0","30FF"]},{"name":"Bopomofo","id":"bopomofo","range":["3100","312F"]},{"name":"Hangul Compatibility Jamo","id":"hangul-compatibility-jamo","range":["3130","318F"]},{"name":"Kanbun","id":"kanbun","range":["3190","319F"]},{"name":"Bopomofo Extended","id":"bopomofo-extended","range":["31A0","31BF"]},{"name":"CJK Strokes","id":"cjk-strokes","range":["31C0","31EF"]},{"name":"Katakana Phonetic Extensions","id":"katakana-phonetic-extensions","range":["31F0","31FF"]},{"name":"Enclosed CJK Letters and Months","id":"enclosed-cjk-letters-and-months","range":["3200","32FF"]},{"name":"CJK Compatibility","id":"cjk-compatibility","range":["3300","33FF"]},{"name":"CJK Unified Ideographs Extension A","id":"cjk-unified-ideographs-extension-a","range":["3400","4DBF"]},{"name":"Yijing Hexagram Symbols","id":"yijing-hexagram-symbols","range":["4DC0","4DFF"]},{"name":"CJK Unified Ideographs","id":"cjk-unified-ideographs","range":["4E00","9FFF"]},{"name":"Yi Syllables","id":"yi-syllables","range":["A000","A48F"]},{"name":"Yi Radicals","id":"yi-radicals","range":["A490","A4CF"]},{"name":"Lisu","id":"lisu","range":["A4D0","A4FF"]},{"name":"Vai","id":"vai","range":["A500","A63F"]},{"name":"Cyrillic Extended-B","id":"cyrillic-extended-b","range":["A640","A69F"]},{"name":"Bamum","id":"bamum","range":["A6A0","A6FF"]},{"name":"Modifier Tone Letters","id":"modifier-tone-letters","range":["A700","A71F"]},{"name":"Latin Extended-D","id":"latin-extended-d","range":["A720","A7FF"]},{"name":"Syloti Nagri","id":"syloti-nagri","range":["A800","A82F"]},{"name":"Common Indic Number Forms","id":"common-indic-number-forms","range":["A830","A83F"]},{"name":"Phags-pa","id":"phags-pa","range":["A840","A87F"]},{"name":"Saurashtra","id":"saurashtra","range":["A880","A8DF"]},{"name":"Devanagari Extended","id":"devanagari-extended","range":["A8E0","A8FF"]},{"name":"Kayah Li","id":"kayah-li","range":["A900","A92F"]},{"name":"Rejang","id":"rejang","range":["A930","A95F"]},{"name":"Hangul Jamo Extended-A","id":"hangul-jamo-extended-a","range":["A960","A97F"]},{"name":"Javanese","id":"javanese","range":["A980","A9DF"]},{"name":"Myanmar Extended-B","id":"myanmar-extended-b","range":["A9E0","A9FF"]},{"name":"Cham","id":"cham","range":["AA00","AA5F"]},{"name":"Myanmar Extended-A","id":"myanmar-extended-a","range":["AA60","AA7F"]},{"name":"Tai Viet","id":"tai-viet","range":["AA80","AADF"]},{"name":"Meetei Mayek Extensions","id":"meetei-mayek-extensions","range":["AAE0","AAFF"]},{"name":"Ethiopic Extended-A","id":"ethiopic-extended-a","range":["AB00","AB2F"]},{"name":"Latin Extended-E","id":"latin-extended-e","range":["AB30","AB6F"]},{"name":"Cherokee Supplement","id":"cherokee-supplement","range":["AB70","ABBF"]},{"name":"Meetei Mayek","id":"meetei-mayek","range":["ABC0","ABFF"]},{"name":"Hangul Syllables","id":"hangul-syllables","range":["AC00","D7AF"]},{"name":"Hangul Jamo Extended-B","id":"hangul-jamo-extended-b","range":["D7B0","D7FF"]},{"name":"High Surrogates","id":"high-surrogates","range":["D800","DB7F"]},{"name":"High Private Use Surrogates","id":"high-private-use-surrogates","range":["DB80","DBFF"]},{"name":"Low Surrogates","id":"low-surrogates","range":["DC00","DFFF"]},{"name":"Private Use Area","id":"private-use-area","range":["E000","F8FF"]},{"name":"CJK Compatibility Ideographs","id":"cjk-compatibility-ideographs","range":["F900","FAFF"]},{"name":"Alphabetic Presentation Forms","id":"alphabetic-presentation-forms","range":["FB00","FB4F"]},{"name":"Arabic Presentation Forms-A","id":"arabic-presentation-forms-a","range":["FB50","FDFF"]},{"name":"Variation Selectors","id":"variation-selectors","range":["FE00","FE0F"]},{"name":"Vertical Forms","id":"vertical-forms","range":["FE10","FE1F"]},{"name":"Combining Half Marks","id":"combining-half-marks","range":["FE20","FE2F"]},{"name":"CJK Compatibility Forms","id":"cjk-compatibility-forms","range":["FE30","FE4F"]},{"name":"Small Form Variants","id":"small-form-variants","range":["FE50","FE6F"]},{"name":"Arabic Presentation Forms-B","id":"arabic-presentation-forms-b","range":["FE70","FEFF"]},{"name":"Halfwidth and Fullwidth Forms","id":"halfwidth-and-fullwidth-forms","range":["FF00","FFEF"]},{"name":"Specials","id":"specials","range":["FFF0","FFFF"]},{"name":"Linear B Syllabary","id":"linear-b-syllabary","range":["10000","1007F"]},{"name":"Linear B Ideograms","id":"linear-b-ideograms","range":["10080","100FF"]},{"name":"Aegean Numbers","id":"aegean-numbers","range":["10100","1013F"]},{"name":"Ancient Greek Numbers","id":"ancient-greek-numbers","range":["10140","1018F"]},{"name":"Ancient Symbols","id":"ancient-symbols","range":["10190","101CF"]},{"name":"Phaistos Disc","id":"phaistos-disc","range":["101D0","101FF"]},{"name":"Lycian","id":"lycian","range":["10280","1029F"]},{"name":"Carian","id":"carian","range":["102A0","102DF"]},{"name":"Coptic Epact Numbers","id":"coptic-epact-numbers","range":["102E0","102FF"]},{"name":"Old Italic","id":"old-italic","range":["10300","1032F"]},{"name":"Gothic","id":"gothic","range":["10330","1034F"]},{"name":"Old Permic","id":"old-permic","range":["10350","1037F"]},{"name":"Ugaritic","id":"ugaritic","range":["10380","1039F"]},{"name":"Old Persian","id":"old-persian","range":["103A0","103DF"]},{"name":"Deseret","id":"deseret","range":["10400","1044F"]},{"name":"Shavian","id":"shavian","range":["10450","1047F"]},{"name":"Osmanya","id":"osmanya","range":["10480","104AF"]},{"name":"Osage","id":"osage","range":["104B0","104FF"]},{"name":"Elbasan","id":"elbasan","range":["10500","1052F"]},{"name":"Caucasian Albanian","id":"caucasian-albanian","range":["10530","1056F"]},{"name":"Linear A","id":"linear-a","range":["10600","1077F"]},{"name":"Cypriot Syllabary","id":"cypriot-syllabary","range":["10800","1083F"]},{"name":"Imperial Aramaic","id":"imperial-aramaic","range":["10840","1085F"]},{"name":"Palmyrene","id":"palmyrene","range":["10860","1087F"]},{"name":"Nabataean","id":"nabataean","range":["10880","108AF"]},{"name":"Hatran","id":"hatran","range":["108E0","108FF"]},{"name":"Phoenician","id":"phoenician","range":["10900","1091F"]},{"name":"Lydian","id":"lydian","range":["10920","1093F"]},{"name":"Meroitic Hieroglyphs","id":"meroitic-hieroglyphs","range":["10980","1099F"]},{"name":"Meroitic Cursive","id":"meroitic-cursive","range":["109A0","109FF"]},{"name":"Kharoshthi","id":"kharoshthi","range":["10A00","10A5F"]},{"name":"Old South Arabian","id":"old-south-arabian","range":["10A60","10A7F"]},{"name":"Old North Arabian","id":"old-north-arabian","range":["10A80","10A9F"]},{"name":"Manichaean","id":"manichaean","range":["10AC0","10AFF"]},{"name":"Avestan","id":"avestan","range":["10B00","10B3F"]},{"name":"Inscriptional Parthian","id":"inscriptional-parthian","range":["10B40","10B5F"]},{"name":"Inscriptional Pahlavi","id":"inscriptional-pahlavi","range":["10B60","10B7F"]},{"name":"Psalter Pahlavi","id":"psalter-pahlavi","range":["10B80","10BAF"]},{"name":"Old Turkic","id":"old-turkic","range":["10C00","10C4F"]},{"name":"Old Hungarian","id":"old-hungarian","range":["10C80","10CFF"]},{"name":"Rumi Numeral Symbols","id":"rumi-numeral-symbols","range":["10E60","10E7F"]},{"name":"Brahmi","id":"brahmi","range":["11000","1107F"]},{"name":"Kaithi","id":"kaithi","range":["11080","110CF"]},{"name":"Sora Sompeng","id":"sora-sompeng","range":["110D0","110FF"]},{"name":"Chakma","id":"chakma","range":["11100","1114F"]},{"name":"Mahajani","id":"mahajani","range":["11150","1117F"]},{"name":"Sharada","id":"sharada","range":["11180","111DF"]},{"name":"Sinhala Archaic Numbers","id":"sinhala-archaic-numbers","range":["111E0","111FF"]},{"name":"Khojki","id":"khojki","range":["11200","1124F"]},{"name":"Multani","id":"multani","range":["11280","112AF"]},{"name":"Khudawadi","id":"khudawadi","range":["112B0","112FF"]},{"name":"Grantha","id":"grantha","range":["11300","1137F"]},{"name":"Newa","id":"newa","range":["11400","1147F"]},{"name":"Tirhuta","id":"tirhuta","range":["11480","114DF"]},{"name":"Siddham","id":"siddham","range":["11580","115FF"]},{"name":"Modi","id":"modi","range":["11600","1165F"]},{"name":"Mongolian Supplement","id":"mongolian-supplement","range":["11660","1167F"]},{"name":"Takri","id":"takri","range":["11680","116CF"]},{"name":"Ahom","id":"ahom","range":["11700","1173F"]},{"name":"Warang Citi","id":"warang-citi","range":["118A0","118FF"]},{"name":"Zanabazar Square","id":"zanabazar-square","range":["11A00","11A4F"]},{"name":"Soyombo","id":"soyombo","range":["11A50","11AAF"]},{"name":"Pau Cin Hau","id":"pau-cin-hau","range":["11AC0","11AFF"]},{"name":"Bhaiksuki","id":"bhaiksuki","range":["11C00","11C6F"]},{"name":"Marchen","id":"marchen","range":["11C70","11CBF"]},{"name":"Masaram Gondi","id":"masaram-gondi","range":["11D00","11D5F"]},{"name":"Cuneiform","id":"cuneiform","range":["12000","123FF"]},{"name":"Cuneiform Numbers and Punctuation","id":"cuneiform-numbers-and-punctuation","range":["12400","1247F"]},{"name":"Early Dynastic Cuneiform","id":"early-dynastic-cuneiform","range":["12480","1254F"]},{"name":"Egyptian Hieroglyphs","id":"egyptian-hieroglyphs","range":["13000","1342F"]},{"name":"Anatolian Hieroglyphs","id":"anatolian-hieroglyphs","range":["14400","1467F"]},{"name":"Bamum Supplement","id":"bamum-supplement","range":["16800","16A3F"]},{"name":"Mro","id":"mro","range":["16A40","16A6F"]},{"name":"Bassa Vah","id":"bassa-vah","range":["16AD0","16AFF"]},{"name":"Pahawh Hmong","id":"pahawh-hmong","range":["16B00","16B8F"]},{"name":"Miao","id":"miao","range":["16F00","16F9F"]},{"name":"Ideographic Symbols and Punctuation","id":"ideographic-symbols-and-punctuation","range":["16FE0","16FFF"]},{"name":"Tangut","id":"tangut","range":["17000","187FF"]},{"name":"Tangut Components","id":"tangut-components","range":["18800","18AFF"]},{"name":"Kana Supplement","id":"kana-supplement","range":["1B000","1B0FF"]},{"name":"Kana Extended-A","id":"kana-extended-a","range":["1B100","1B12F"]},{"name":"Nushu","id":"nushu","range":["1B170","1B2FF"]},{"name":"Duployan","id":"duployan","range":["1BC00","1BC9F"]},{"name":"Shorthand Format Controls","id":"shorthand-format-controls","range":["1BCA0","1BCAF"]},{"name":"Byzantine Musical Symbols","id":"byzantine-musical-symbols","range":["1D000","1D0FF"]},{"name":"Musical Symbols","id":"musical-symbols","range":["1D100","1D1FF"]},{"name":"Ancient Greek Musical Notation","id":"ancient-greek-musical-notation","range":["1D200","1D24F"]},{"name":"Tai Xuan Jing Symbols","id":"tai-xuan-jing-symbols","range":["1D300","1D35F"]},{"name":"Counting Rod Numerals","id":"counting-rod-numerals","range":["1D360","1D37F"]},{"name":"Mathematical Alphanumeric Symbols","id":"mathematical-alphanumeric-symbols","range":["1D400","1D7FF"]},{"name":"Sutton SignWriting","id":"sutton-signwriting","range":["1D800","1DAAF"]},{"name":"Glagolitic Supplement","id":"glagolitic-supplement","range":["1E000","1E02F"]},{"name":"Mende Kikakui","id":"mende-kikakui","range":["1E800","1E8DF"]},{"name":"Adlam","id":"adlam","range":["1E900","1E95F"]},{"name":"Arabic Mathematical Alphabetic Symbols","id":"arabic-mathematical-alphabetic-symbols","range":["1EE00","1EEFF"]},{"name":"Mahjong Tiles","id":"mahjong-tiles","range":["1F000","1F02F"]},{"name":"Domino Tiles","id":"domino-tiles","range":["1F030","1F09F"]},{"name":"Playing Cards","id":"playing-cards","range":["1F0A0","1F0FF"]},{"name":"Enclosed Alphanumeric Supplement","id":"enclosed-alphanumeric-supplement","range":["1F100","1F1FF"]},{"name":"Enclosed Ideographic Supplement","id":"enclosed-ideographic-supplement","range":["1F200","1F2FF"]},{"name":"Miscellaneous Symbols and Pictographs","id":"miscellaneous-symbols-and-pictographs","range":["1F300","1F5FF"]},{"name":"Emoticons (Emoji)","id":"emoticons-(emoji)","range":["1F600","1F64F"]},{"name":"Ornamental Dingbats","id":"ornamental-dingbats","range":["1F650","1F67F"]},{"name":"Transport and Map Symbols","id":"transport-and-map-symbols","range":["1F680","1F6FF"]},{"name":"Alchemical Symbols","id":"alchemical-symbols","range":["1F700","1F77F"]},{"name":"Geometric Shapes Extended","id":"geometric-shapes-extended","range":["1F780","1F7FF"]},{"name":"Supplemental Arrows-C","id":"supplemental-arrows-c","range":["1F800","1F8FF"]},{"name":"Supplemental Symbols and Pictographs","id":"supplemental-symbols-and-pictographs","range":["1F900","1F9FF"]},{"name":"CJK Unified Ideographs Extension B","id":"cjk-unified-ideographs-extension-b","range":["20000","2A6DF"]},{"name":"CJK Unified Ideographs Extension C","id":"cjk-unified-ideographs-extension-c","range":["2A700","2B73F"]},{"name":"CJK Unified Ideographs Extension D","id":"cjk-unified-ideographs-extension-d","range":["2B740","2B81F"]},{"name":"CJK Unified Ideographs Extension E","id":"cjk-unified-ideographs-extension-e","range":["2B820","2CEAF"]},{"name":"CJK Unified Ideographs Extension F","id":"cjk-unified-ideographs-extension-f","range":["2CEB0","2EBEF"]},{"name":"CJK Compatibility Ideographs Supplement","id":"cjk-compatibility-ideographs-supplement","range":["2F800","2FA1F"]},{"name":"Tags","id":"tags","range":["E0000","E007F"]},{"name":"Variation Selectors Supplement","id":"variation-selectors-supplement","range":["E0100","E01EF"]}]')},3899:function(e,t,i){var n,r;n=[i(16),i(9),i(2),i(2030),i(1593)],void 0===(r=function(e,t,i,n,r){"use strict";return n.extend({type:"color",valueProp:"color#data",friendlyName:function(){return this._data.getValue("name")},setPrivate:function(){return this._data.setValue("private",!0)},generateName:function(){this.setName(r.nameThatColor(this.rgb()))},isBaseColor:function(){return t.includes(this.getRoles()||[],"base-color")},isDerived:function(){return t.includes(this.getRoles()||[],"derived")},setRGB:function(e){var t={mode:"RGB",value:e};this._data.setValue("type","application/vnd.adobe.color+json"),this._data.setValue("color#data",t),this._data.setValue("ac#application","spark-web")},setHex:function(e){this.setRGB(r.hexToRgb(e))},getValue:function(){return this.rgb()},rgb:function(){var e=this._getValue();return e?e.value:{r:0,g:0,b:0}},hex:function(){return r.rgbToHex(this.rgb())},hsl:function(){return r.rgbToHsl(this.rgb())},lightened:function(e){return r.lighten(this.rgb(),e)}})}.apply(t,n))||(e.exports=r)},3900:function(e,t,i){var n,r;n=[i(16),i(9),i(2),i(2030),i(299)],void 0===(r=function(e,t,i,n,r){"use strict";return n.extend({type:"font",valueProp:"font#data",friendlyName:function(){return this._data.getValue("name")},getFontFaceName:function(e,t){return t||console.warn("NOTE: AuthoringContextFont.getFontFaceName() has been deprecated - use AuthoringContextFont.getFontFace() instead."),r.getFont(e||this.getLookupKey()).then((function(e){return e&&e.face?e.face.metrics.family:""}))},getFontSubgroupName:function(e,t){return t||console.warn("NOTE: AuthoringContextFont.getFontSubgroupName() has been deprecated - use AuthoringContextFont.getFontSubgroup() instead."),r.getFont(e||this.getLookupKey()).then((function(e){return e&&e.face?e.subgroup.name+" "+e.face.name:""}))},getFontFace:function(e){return r.getFont(e||this.getLookupKey()).then((function(e){return e&&e.subgroup&&e.face?e.subgroup.name+" "+e.face.name:""}))},getFontSubgroup:function(e){return r.getFont(e||this.getLookupKey()).then((function(e){return e&&e.subgroup?e.subgroup.name:""}))},getLookupKey:function(){var e=this._getValue();if(e)return e.lookupKey},setLookupKey:function(e){var t=this._getValue();"object"==typeof e&&"tk-synced"===e.type?this._setTypekitSyncedFont(e,t):t.lookupKey=e,this.setValue(t)},_setTypkitSyncedFont:function(e,t){console.warn("set synced font info",e),t.lookupKey=null,t.source="tk-synced"},getCSSName:function(e){return r.getFont(e||this.getLookupKey()).then((function(e){return e?e.subgroup.cssName:""}))},getInfo:function(e){return i.all([this.getFontFaceName(e,!0),this.getFontSubgroupName(e,!0),this.getCSSName(e),this.getFontStyles(e),this.getFontFace(e),this.getFontSubgroup(e)]).spread(function(t,i,n,r,o,a){return{acFont:this,id:e||this.getId(),lookupKey:e||this.getLookupKey(),faceName:t,subgroupName:i,cssName:n,fontStyle:r.style,fontWeight:r.weight,face:o,subgroup:a}}.bind(this))},getFontStyles:function(e){return r.getFont(e||this.getLookupKey()).then((function(e){if(e&&e.face){var t=e.face.typekitKey.split("");return{style:{i:"italic",n:"normal"}[t[0]],weight:{1:100,2:200,3:300,4:400,5:500,6:600,7:700,8:800,9:900}[t[1]]}}}))}})}.apply(t,n))||(e.exports=r)},3901:function(e,t,i){i(9);var n,r,o,a=i(3902),s=i(2),c=!1;try{c=!!window}catch(l){}e.exports&&!c||(n=i(1),r=n.cps,o=n.key);e.exports=function(e,t){return a.extend({host:r,endPoints:{resource:"/api/v2/resources/:resourcePath",resourceS3:"/api/v2/resources/:resourcePath/\\:S3",resourceMetadata:"/api/v2/resources/:resourcePath/\\:metadata",alias:"/api/v2/"+e+"/alias",asset:"/api/v2/"+e+"/assets/:assetId",assets:"/api/v2/"+e+"/assets",health:"/api/v2/health",videoEmbed:"/api/v2/"+e+"/assets/:asset_id/video/embed",website:"/api/v2/"+e+"/assets/:asset_id/website",site:"/content/2/site/:assetId/:itemPath",like:"/api/v2/"+e+"/assets/:assetId/likes",unlike:"/api/v2/"+e+"/assets/:assetId/likes",report:"/api/v2/"+e+"/assets/:assetId/report",artwork:"/api/v2/"+e+"/assets/:assetId/artwork",original:"/api/v2/"+e+"/assets/:assetId/original",originalForPath:"/api/v2/"+e+"/assets/:assetId/original/:path",originalForPathAndVersion:"/api/v2/"+e+"/assets/:assetId/original/:path/version/:version",serverCopy:"/api/v2/resources/:resourcePath/\\:copy"},protocol:"https:",defaultParams:{api_key:o},getResourceMetadata:function(e,t){return this.request({method:"GET",url:this.url("resourceMetadata",{},e),token:t})},checkAsset:function(e){return this.request({method:"GET",url:this.url("asset",{},e)}).then((function(e){return 200==e.statusCode}))},getAsset:function(e){return this.request({method:"GET",url:this.url("asset",{},e)})},getOriginalForPath:function(e,t,i){var n;return n=i?this.url("originalForPathAndVersion",{},e,t,i):this.url("originalForPath",{},e,t),this.request({method:"GET",url:n})},getMetadata:function(e){return this.request({method:"GET",url:this.url("asset",{},e)}).then((function(e){return e.body}))},checkResource:function(e,t){return this.request({method:"GET",url:this.url("resourceS3",{},e),token:t}).then((function(e){return 200==e.statusCode}))},uploadResource:function(e,i,n,r,o){var a={"Content-Type":i};r&&(a["If-Match"]="*");var s={method:"PUT",url:this.url("resource",{},e),body:n,headers:a,token:o};return"application/json"==i&&(s.json=!0),this.request(s).then((function(e){return t?e:e.body}))},publishAsset:function(e,i,n,r,o,a){var s,c,l;return n?(c="PUT",l=this.url("asset",{},n),s=r):(c="POST",l=this.url("assets"),s={resource_path:e,resource_type:i,metadata:r}),this.request({method:c,url:l,json:!0,body:s,token:o,serviceToken:a}).then((function(e){if(t)return e;var i=e.headers.Location||e.headers.location;if(i){var r=i.replace(/\/*$/,"").split("/");n=r[r.length-1]}return n}))},updateMetadata:function(e,t){return this.publishAsset(void 0,void 0,e,t)},serverSideCopy:function(e,t){if(!t||!t.length)return s.resolve([]);var i=s.defer(),r=function(e){this.request({method:"GET",url:e+"?api_key="+n.key}).then((function(t){var n=t.body;"in_progress"==n.status||"queued"==n.status?setTimeout((function(){r(e)}),500):"done"==n.status?i.resolve(n.outputs):"failed"==n.status?i.reject(new Error("CP server side copy failed with error code: "+n.error_code)):i.reject(new Error("CP server side copy returned illegal status: "+n.status+" : url:"+t.responseURL))})).catch((function(e){i.reject(new Error("CP server side copy failed with error: "+e.message+" "+e.stack))}))}.bind(this);return this.request({method:"POST",url:this.url("serverCopy",{},e),json:!0,body:{copy:{files:t}}}).then((function(e){var t=e.headers.Location||e.headers.location;r(t)})),i.promise},updateArtwork:function(e,t,i){return this.request({method:"PUT",url:this.url("artwork",{},e),token:i,json:!0,body:{resource_path:t}})},reserveAlias:function(e){return this.request({method:"POST",url:this.url("alias",{}),token:e}).then((function(e){if(console.log({type:"pageServerPublish",message:"alias was not passed in meaning we need to reserve one. got: "+e.body.alias}),200==e.statusCode)return e.body.alias;throw new Error("CP came back with "+e.statusCode+" "+e.body)}))}})}},3902:function(e,t,i){var n,r=i(9),o=i(2);function a(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}var s=i(3903),c=!1;try{c=!!window}catch(d){}if(e.exports&&!c)n=function(e){return o.resolve(e)};else{var l=i(13);n=function(){return l.getAccessToken()}}var u={methods:{setHost:function(e){this.host=e},setDefaultParams:function(e){this.defaultParams=e},setProtocol:function(e){this.protocol=e},url:function(e,t){var i=Array.prototype.slice.call(arguments);if(e=this.endPoints[e]){var n,o=2,a=!1,s=e.replace(/[^\\]{1}\:([^\/]*)/g,(function(e,t){if("string"==typeof(n=i[o++])||"number"==typeof n)return"/"+n;a=!0}));if(s=s.replace(/\\\:/,":"),o>2&&o!=i.length)throw new Error("URL helper must be called with same number of path params to match endpoint string");if(a)throw new Error("URL helper must be called with string arguments only");t=r.extend({},this.defaultParams,t||{});var c="";for(var l in o=0,t)t.hasOwnProperty(l)&&(c+=(o?"&":"?")+l+"="+t[l],o++);return(this.protocol||"http:")+"//"+this.host+s+c}},request:function(e){var t=r.extend({},e),i=r.extend({},t.headers),c=a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a();i["X-Request-Id"]=c,t.json&&(i["Content-Type"]="application/json",t.body=JSON.stringify(t.body)),delete t.json;t.method,t.url;return n(t.token).then(function(e){return t.serviceToken?(i["X-User-Token"]=e,i.Authorization=t.serviceToken):i.Authorization=e,delete t.token,delete t.serviceToken,t.headers=i,function(e){var t=o.defer();return s(e,(function(e,i){e?t.reject(e):t.resolve(i)})),t.promise}(t)}.bind(this)).then((function(e){var t;try{t=JSON.parse(e.body)}catch(i){t=e.body}return e.body=t,!e.headers&&e.getAllResponseHeaders&&(e.headers=function(e){var t={};if(!e)return t;for(var i=(e=e.replace(/^(\r?\n)*/,"")).split("\r\n"),n=0;n<i.length;n++){var r=i[n],o=r.indexOf(": ");if(o>0){var a=r.substring(0,o),s=r.substring(o+2);t[a]=s}}return t}(e.getAllResponseHeaders())),e}))}},mixin:function(e){return e.prototype=r.extend(e.prototype,u.methods),e},extend:function(e){return r.extend(e,u.methods)}};e.exports=u},3904:function(e,t,i){var n,r;n=[i(16),i(9),i(2),i(2030),i(1593)],void 0===(r=function(e,t,i,n,r){"use strict";return n.extend({type:"logo",valueProp:void 0,setContext:function(e){this._context=e},getHrefAsync:function(e,t){t=t||"image/png";var n=this._context,r=this.getData();if(n){var o=n.composite.getChildWithMap("logos."+r.getValue("path")+".!image");if(o)return n.composite.getImageComponentHref(o,e,t)}return i.resolve(null)},load:function(e,t){var n=i.defer();return this.getHrefAsync(e,t).then(function(e){var t=new Image;t.onload=function(){n.resolve(e)},t.onerror=function(e){n.reject(e)},e?t.src=e:(console.warn("href for logo "+this.getId()+" could not be found"),n.resolve(void 0))}.bind(this)).catch((function(e){n.reject(e)})),n.promise}})}.apply(t,n))||(e.exports=r)},407:function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjIxMTAgLTE0MjggMjAgMjAiPjxkZWZzPjxzdHlsZT4uYXtmaWxsOiNmZmY7fS5ie2ZpbGw6IzM1NDE0Yzt9PC9zdHlsZT48L2RlZnM+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTQyNSAtMTg3MSkiPjxjaXJjbGUgY2xhc3M9ImEiIGN4PSIxMCIgY3k9IjEwIiByPSIxMCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNjg1IDQ0MykiLz48cGF0aCBjbGFzcz0iYiIgZD0iTTU4MC42LDE0Ny4xbC0yLjctMi43LDIuNy0yLjdhLjc3OC43NzgsMCwxLDAtMS4xLTEuMWgwbC0yLjcsMi43LTIuNy0yLjdhLjc3OC43NzgsMCwxLDAtMS4xLDEuMWgwbDIuNywyLjctMi43LDIuN2EuNzc4Ljc3OCwwLDAsMCwxLjEsMS4xaDBsMi43LTIuNywyLjcsMi43YS43NzguNzc4LDAsMCwwLDEuMS0xLjFaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMTguMjI1IDMwOC42MjUpIi8+PC9nPjwvc3ZnPg=="},607:function(e,t,i){var n,r;n=[i(16),i(9),i(11),i(2),i(13),i(6),i(112)],void 0===(r=function(e,t,i,n,r,o,a){"use strict";var s,c,l=new o.default({color:"rebeccapurple",name:"marketingController"}),u=["spark-newsletter"];return c=i.Model.extend({emailListSettings:{},_getBrowserStorage:function(){return this.browserStorage||(this.browserStorage=new a(window.sessionStorage)),this.browserStorage},showedNewsletterPitch:function(){this._showedNewsletterPitch=!0},setNewsletterOptedIn:function(){try{window.sessionStorage.setItem("dismissed-spark-newsletter-pitch","true"),window.localStorage.setItem("spark-newsletter-pitches","4")}catch(e){}},newsletterOptedOut:function(){try{window.sessionStorage.setItem("dismissed-spark-newsletter-pitch","true");var e=parseInt(window.localStorage.getItem("spark-newsletter-pitches")||"1");e++,window.localStorage.setItem("spark-newsletter-pitches",String(e))}catch(t){}},resetNewsletterOptOut:function(){try{window.localStorage.setItem("spark-newsletter-pitches","1"),window.sessionStorage.setItem("dismissed-spark-newsletter-pitch","true")}catch(e){}},getModelForOptinViewIfUserCanReceiveEmail:function(e,n){if(!this.userQualifiesToReceiveEmail())return null;var o=t.assign({mode:e},n||{});return t.isUndefined(o.showGlobalMarketingChoice)&&(o.showGlobalMarketingChoice=!r.getMarketingChoiceForUser()),new i.Model(o)},userQualifiesToReceiveMarketing:function(){var e=!1,i=r.getUserEmail();if(!t.isEmpty(i)&&!r.isEnterprise()&&!r.isAutomatedTestUser()){var n=i.split("@");if(2===n.length){var o=n[1];e=!/(k12)|(usd)|(\.edu)|(\.ac)|(cvsdvt\.org)|(m3-creative\.com)|(merck\.com)|(fedins\.com)/.test(o.toLowerCase())}}return e},userQualifiesToReceiveEmail:function(){return"US"===r.getUserCountry()&&this.userQualifiesToReceiveMarketing()},shouldSeeNewsletterPitch:function(){var e;if(!this._showedNewsletterPitch)try{if(!("true"===window.sessionStorage.getItem("dismissed-spark-newsletter-pitch"))){try{e=parseInt(window.localStorage.getItem("spark-newsletter-pitches")||"1",10)}catch(t){e=1}if(e<=3&&this.userQualifiesToReceiveEmail())return this.getEmailListOptInStatus("sparknewsletter").then(function(t){return t&&"subscribed"===t.status?n.reject(new Error("MarketingControllerCls::shouldSeeNewsletterPitch")):e}.bind(this))}}catch(i){}return n.reject(new Error("MarketingControllerCls::shouldSeeNewsletterPitch"))},getSettingIfEmailList:function(e){return this.emailListSettings.hasOwnProperty(e)?{value:this.emailListSettings[e]}:null},emailListSettingsLoaded:function(){return this.statusesDeferred||(this.statusesDeferred=n.defer(),this.userQualifiesToReceiveEmail()?this._getAllEmailListSubscriptionStatuses().then(this._initEmailListSubscriptionStatuses.bind(this)).done():this.statusesDeferred.resolve("unqualifiedToReceiveEmail")),this.statusesDeferred.promise},_initEmailListSubscriptionStatuses:function(e){var i=[];t.each(e,function(e){var n,r,o;"fulfilled"===e.state?(r="subscribed"===(n=e.value).status,o=t.find(u,(function(e){return e.replace(/-/g,"")===n.listId})),this.emailListSettings[o]=r):"rejected"===e.state&&(l.error("email list subscription status failed to be initialized",e.reason),i.push(e.reason))}.bind(this)),t.isEmpty(i)?this.statusesDeferred.resolve("success"):this.statusesDeferred.resolve("unableToLoadEmailSettingsForQualifiedUser")},_getAllEmailListSubscriptionStatuses:function(){var e,i=[];return t.each(u,function(t){var r=t.replace(/-/g,"");e=s.getEmailListOptInStatus(r).then((function(e){return e.listId=r,e}),(function(e){return l.error("unable to get opt-in status for email list "+r,e),n.reject(e)})),i.push(e)}.bind(this)),n.allSettled(i)},getFilteredChanges:function(e){var i={},n={};return t.each(e,function(e,t){this.emailListSettings.hasOwnProperty(t)&&(i[t]={value:e,changed:this.emailListSettings[t]!==e},i[t].changed&&(n[t]=e,l.debug("MarketingController.getFilteredChanges differences has "+t+" with value "+e)))}.bind(this)),t.isEmpty(n)?{settings:i}:{settings:i,differences:n}},saveAndUpdateSettings:function(e){var i,r=[];return t.each(e,(function(e,t){if(u.indexOf(t)>-1){var o=t.replace(/-/g,"");i=s.updateEmailListOptInForUser(e,o).then((function(i){var n=e?"subscribed":"unsubscribed";return l.info("Updated Status of Email List: "+o+" to: "+n),{settingId:t,status:e}}),(function(e){return l.error("unable to update opt-in status for email list "+o,e),n.reject(e)})),r.push(i)}})),n.allSettled(r).then(function(e){var i=[];if(t.each(e,function(e){"fulfilled"===e.state?this.emailListSettings[e.value.settingId]=e.value.status:"rejected"===e.state&&(l.error("failed to save updated opt-in status for email list",e.reason),i.push(e.reason))}.bind(this)),i.length>0)return n.reject(i)}.bind(this))},_fetchEmailListOptinStatus:function(e){var t=n.defer();return r.isSignedInUser().then(function(i){return i?r.ajax({type:"GET",url:"/list/subscription-status/"+e,success:function(e,i,n){t.resolve(e)},error:function(e,i,n){t.reject(n)}}):t.resolve({status:"unsubscribed"})}.bind(this),(function(e){t.reject(e)})).done(),t.promise},getEmailListOptInStatus:function(e){return this._getBrowserStorage().get("spark-mrkt-subscription-"+e+"-status")?n.resolve({status:this._getBrowserStorage().get("spark-mrkt-subscription-"+e+"-status")}):this._fetchEmailListOptinStatus(e)},_saveOptInValue:function(e,t){var i="subscribe"===t?"subscribed":"unsubscribed";this._getBrowserStorage().set("spark-mrkt-subscription-"+e+"-status",i)},updateEmailListOptInForUser:function(e,t){var i=n.defer(),o=e?"subscribe":"unsubscribe";return r.isSignedInUser().then(function(e){return e?r.ajax({type:"GET",url:"/list/"+o+"/"+t,success:function(e,n,r){this._saveOptInValue(t,o),i.resolve(e)}.bind(this),error:function(e,t,n){i.reject(n)}.bind(this)}):i.reject(new Error("MarketingController.updateEmailListOptInForUser - Anonymous user can't "+o))}.bind(this),function(e){i.reject(e)}.bind(this)),i.promise}}),s=new c}.apply(t,n))||(e.exports=r)},611:function(e,t,i){"use strict";i.r(t);var n=i(4),r=i.n(n),o=i(3),a=i.n(o),s=i(2),c=i.n(s),l=i(33),u=i.n(l),d=i(155),h=i(13),g=i.n(h),f=new(i(6).default)({color:"rebeccapurple",name:"UDSController"}),m={classroom_role:"none",ssp_role:"none",loadStatus:"200"},p=new(function(){function e(){r()(this,e)}return a()(e,[{key:"init",value:function(){var e=this;this._udsDataLoaded=c.a.defer(),g.a.isSignedInUser().then((function(t){if(!t)return e._udsDataLoaded.resolve(Object.assign({},m)),void window.marvel.events.on(d.default.FEATURES_REFRESHED_ON_AUTH,e.init.bind(e));u.a.allFeaturesLoaded().then((function(){e._getUserDataFromUDS().then((function(t){var i=t.data;e._udsDataLoaded.resolve(Object.assign({},m,i))}))})).done()})).done()}},{key:"getUdsData",value:function(){return this._udsDataLoaded.promise}},{key:"getUdsValue",value:function(e){return this._udsDataLoaded.promise.then((function(t){return t[e]}))}},{key:"_getUserDataFromUDS",value:function(){return window.fetch("/uds/v2/",{credentials:"include"}).then((function(e){return e.status<200||e.status>=300?(404!==e.status?f.info("Got non-404 non-200 response from UDS, assuming user has no roles: "+e.status):f.info("Got 404 response from UDS, assuming user has no roles: "+e.status),{data:{loadStatus:e.status+""}}):e.json().then((function(t){return f.info("Got 2xx response from UDS: "+e.status,t.data),t}))})).catch((function(e){return f.warn("Got an error attempting to call UDS, assuming user has no roles.",e),{data:{loadStatus:"fetch-error"}}}))}}]),e}());t.default=p},617:function(e,t,i){var n,r;n=[i(16),i(9),i(2),i(11),i(65),i(13),i(315),i(33),i(607),i(6),i(1),i(611)],void 0===(r=function(e,t,i,n,r,o,a,s,c,l,u,d){"use strict";var h=new l.default({color:"rebeccapurple",name:"userProfile"}),g=r.default;return n.Model.extend({userTypeMap:{B:"Free",IN:"Individual",INS:"Individual",ENTS:"Enterprise",ENT:"Enterprise",TM:"Teams",TMS:"Teams",K12F:"EDU Spark K12 Free",HEDF:"Edu Spark HED free",K12P:"EDU CC All apps K12 paid",Unknown:"Unknown"},appsThatIgnoreStockFlags:["theo"],_getAnonymousProfile:function(){return{userId:"anonymous@AdobeID"}},initProfile:function(e){var t=i.defer();return o.isSignedInUser().then(function(i){var n=i?o.getProfile():this._getAnonymousProfile();n&&(this._acProfile=n,this._init(e,i),this._isSignedIn=i,i?(this.getUDSDataWhenLoaded().done(),this.profile.avatar._data=new Promise((e,t)=>{this.loadProfileImage(this.profile.avatar,100).then((function(t){e(t)}),(function(t){e("")}))})):this.profile.avatar._data=Promise.resolve(""),t.resolve())}.bind(this)),t.promise},getUDSDataWhenLoaded:function(){return d.default.getUdsData().then(function(e){return this.udsData=e,e}.bind(this))},getUserPublishMaybeBlockedBasedOnSSPRole:function(){return this.getUDSDataWhenLoaded().then(function(e){return"none"!==e.ssp_role}.bind(this))},getSparkUserOrg:function(){var e,t,i=this.getSparkServiceAccountsAndProductContexts();if(i.productContexts.length&&(e=1===i.productContexts.length?i.productContexts[0]:i.productContexts.reduce(function(e,t){if(t.owningEntity){if(!e)return t;if(this._serviceLevelToInt(t.serviceLevel)>this._serviceLevelToInt(e.serviceLevel))return t}}.bind(this),null))&&e.owningEntity)return e.owningEntity;if(i.saos.length&&(t=1===i.saos.length?i.saos[0]:i.saos.reduce(function(e,t){if(t.ownerAuthSrc&&t.ownerGuid){if(!e)return t;if(this._serviceLevelToInt(t.serviceLevel)>this._serviceLevelToInt(t.serviceLevel))return t}}.bind(this),null)))return t.ownerGuid+"@"+t.ownerAuthSrc;return null},_init:function(e,i){this._id=e.profileId,this._type=e.profileType,this._settings=t.assign({},this.defaults),this.profile=t.clone(this._settings),this.udsData={loadStatus:"loading"},i&&(this.profile.displayName=this.getSetting("displayName"),this._settings.displayName=this.profile.displayName,this.profile.email=this.getSetting("email"),this.profile.getUserProfilePictureUrl=this.getUserProfilePictureUrl.bind(this))},defaults:{category:"",avatar:{default:"/images/icon-generic-avatar.svg"}},_getValueFromAuthControllerProfile:function(e){return this._acProfile[e]},getSetting:function(e){if(-1===e.indexOf("-")){if("first_name"===e||"last_name"===e){var i=this._settings.displayName;if(i===this._acProfile.displayName)return this._getValueFromAuthControllerProfile(e);var n=i&&i.split(" ")||[""];return 1===n.length?"first_name"===e?n[0]:"":"first_name"===e?n.slice(0,-1).join(" "):n[n.length-1].trim()}return"usertype"===e?this.getUserType():"udsData"===e?this.udsData:t.isUndefined(this._settings[e])?this._acProfile[e]:this._settings[e]}var r=c.getSettingIfEmailList(e);return r?r.value:s.hasFeature(e)},_serviceLevelToInt:function(e){return 0===e.indexOf("PAID_LVL")?parseInt(e.substring(9),10):u.serviceLevelFree},_getMaxServiceLevelFromContexts:function(e){return e.length?t.reduce(e,function(e,t){var i=this._serviceLevelToInt(t.serviceLevel);return Math.max(i,e)}.bind(this),u.serviceLevelFree):this._serviceLevelToInt("FREE_BASIC")},_getAllSparkProductContextsFromAll:function(e){return t.reduce(e||[],(function(e,t){return"spark"===t.prodCtx.serviceCode&&e.push(t.prodCtx),e}),[])},getPaidLevel:function(){var e=this.getSparkServiceAccountsAndProductContexts(),t=e.saos&&e.saos.length&&e.saos[0];return Math.max(this._serviceLevelToInt(t?t.serviceLevel:"FREE_BASIC"),this._getMaxServiceLevelFromContexts(e.productContexts))},getSparkServiceAccountsAndProductContexts:function(){var e=this.getSetting("serviceAccounts"),i=t.filter(e,(function(e){return"spark"===e.serviceCode})),n=this.getSetting("projectedProductContext")||[];return{saos:i,productContexts:this._getAllSparkProductContextsFromAll(n)}},getUserTypeId:function(){var e;return t.find(this.userTypeMap,function(t,i){var n="user-type-"+i;if(s.hasFeature(n)&&this.userTypeMap[i])return e=i,!0}.bind(this)),e&&"Unknown"!==e||(e="Unknown"),e},getUserType:function(){var e=this.getUserTypeId();return this.userTypeMap[e]},isEDUAccount:function(){var e=this.getUserTypeId();return-1!==["K12F","HEDF","K12P"].indexOf(e)||!!s.hasFeature("_enterprise-safe-search")},getStockUserInfo:function(e){var t=s.hasFeature("_stock-safe-search"),i=!!t;return{eFilter:t,canSeeLimited:s.hasFeature("_stock-can-see-limited")&&(!g.isEmbeddedCCEverywhereFirstPartyHost()||s.hasFeature("_stock-can-license-limited")),canLicenseLimited:s.hasFeature("_stock-can-license-limited"),hideDetailLink:i}},getSearchUserEntitlementHeaders:function(e){var t=s.getUserProperty("search-user-entitlement"),i=s.getUserProperty("search-user-restrictions"),n=o.getUserCountry(),r=(e.getUserPrefs().createFor||[]).map((function(t){return e.CARD_LIST_FOR_YOU[t]})).sort().join(",");"Unknown"===n&&(n="US");var a={"x-ccx-user-entitlement":t,"x-ccx-ims-country-code":n,"x-ccx-user-restrictions":i};r&&(a["x-ccx-interest-groups"]=r);var c=[];return i||(delete a["x-ccx-user-restrictions"],c.push("userRestrictions")),t||(delete a["x-ccx-user-entitlement"],c.push("entitlement")),c.length&&h.error("missing data in getSearchUserEntitlementHeaders: "+c.join(",")),a},isFreeHigherEducationUser:function(){return"HEDF"===this.getUserTypeId()},isAllAppsK12User:function(){return"K12P"===this.getUserTypeId()},isNonEnterpriseUser:function(){return"type1"===this._acProfile.account_type},getClassroomManagerLinkWhenLoaded:function(){return this.getUDSDataWhenLoaded().then(function(e){return"teacher"===e.ssp_role&&u.classroomManagerLink}.bind(this))},isAdobeAccount:function(){var e=o.getUserEmail();return/@adobe(test)?\.com$/i.test(e)},getProfileHomeSettings:function(){return{isEDUAccount:this.isEDUAccount(),isAdobeAccount:this.isAdobeAccount(),userType:this.getUserType(),userTypeId:this.getUserTypeId(),isFreeHigherEducationUser:this.isFreeHigherEducationUser(),canSeeInAppUpgradeMarketing:this._canSeeInAppUpgradeMarketing(),canSeeMarketing:c.userQualifiesToReceiveMarketing(),canSeePaidUserMarketing:this._canSeePaidUserMarketing()}},_canSeeInAppUpgradeMarketing:function(){return!s.hasFeature("entitle-brand-kit")&&c.userQualifiesToReceiveMarketing()},_canSeePaidUserMarketing:function(){return s.hasFeature("entitle-brand-kit")&&c.userQualifiesToReceiveMarketing()},stockBlocked:function(e){return""},canShowNonDooploImageSourceForUser:function(e,t){return"stock"===(e=e.toLowerCase())?!this.stockBlocked(t):"giphy"!==e||!!s.hasFeature("image-picker-suppports-giphy")&&(!!s.hasFeature("giphy-picker-enable-in-"+t)&&this.getSetting("user-flag-image-source-giphy"))},filterDooploBitmapServicesForUser:function(e,i){var n={enabled:[],blocked:[],show:[]},r=-1!==this.appsThatIgnoreStockFlags.indexOf(i),o=function(e,t,o){if(r&&-1!==e.indexOf("stock")){var a=!this.stockBlocked(i);o?a&&n.enabled.push(t):a||n.blocked.push(t)}else this.getSetting(e)?o?n.enabled.push(t):n.show.push(t):o||n.blocked.push(t)}.bind(this);return e&&e.length?t.each(e,function(e){var t=e.toLowerCase().split(" ").join("-"),i=a.imageServices.flagPrefixDooplo+t;o(i,e,!0);var n=a.imageServices.showFlagPrefixDooplo+t;o(n,e,!1)}.bind(this)):t.each(a.imageServices.dooplo,function(e){var t=e.toLowerCase().split(" ").join("-"),i=a.imageServices.flagPrefixDooplo+t;o(i,e,!0);var n=a.imageServices.showFlagPrefixDooplo+t;o(n,e,!1)}.bind(this)),n.enabled=t.filter(n.enabled,(function(e){return"The Noun Project"!==e&&"unsplash"!==e})),n},getGetNoticedSettings:function(){var e={supported:this.isNonEnterpriseUser(),value:!1};return e.supported&&(e.value=!this.getSetting("share-default-to-unlisted")),e},isUserProfileDefaultUrl:function(e){return e===this.defaults.avatar.default},getUserProfilePictureUrl:function(e){return this.getSizedProfileImage(e)},getSizedProfileImage:function(e){return this.profile&&this.profile.avatar?this.profile.avatar._data:Promise.resolve("")},loadProfileImage:function(e,t){return e.componentName?this.getNamedImageAsset(e.componentName,t):o.getUserProfilePictureUrl("max").then(function(t){return t||e.default}.bind(this),function(t){return h.error("error loading user profile image, using default instead",t),e.default}.bind(this))},getUserProfileImageForTransload:function(e){var t,n=this.profile[e],r=i.defer();if(n)if(n._data)n._data.then(e=>{0===e.indexOf("https")||e===this.defaults.avatar.default?r.resolve(e):a.convertUrlToBlob(e).then((function(e){t={source:"file",file:e},r.resolve(t)}),(function(e){r.reject(e)}))});else{var o=this.getNamedImageAssetComponent(e);o&&(t={source:"component",component:o}),r.resolve(t)}else r.resolve();return r.promise},getUserDisplayName:function(e){var t,i=this._settings&&this._settings.displayName;return e.preferFirstPlusInitial?this._getValueFromAuthControllerProfile("displayName")===i&&(t=this._getValueFromAuthControllerProfile("last_name")||"",""!==(i=this._getValueFromAuthControllerProfile("first_name")||"")?(i=i.charAt(0).toLocaleUpperCase()+i.substring(1),""!==t&&(i+=" "+t.charAt(0).toLocaleLowerCase())):i=t):e.preferFirst&&(i=this._getValueFromAuthControllerProfile("first_name")||"Friend"),i},emailListSettingsLoaded:function(){return c.emailListSettingsLoaded()},saveUpdatedProfileSettings:function(e){var n=e.featureFlipperChanges,r=n&&n.authenticated||{},o=[],a=c.getFilteredChanges(e),l=n&&n.numUnauthenticated?n.unauthenticated:null;return t.each(e,(function(e,t){-1!==t.indexOf("-")&&(a.settings[t]||"featureFlipperChanges"===t||(r[t]=e))})),a.differences&&o.push(c.saveAndUpdateSettings(a.differences)),t.isEmpty(r)&&!l||o.push(s.setUserFlagsBothKinds(r,l)),o.length>0?i.allSettled(o).then((function(e){return n&&n.total&&(r.featureFlipperChanges=n),r})):i.resolve(r)},uploadNamedImageAsset:function(e,t){var i=this.composite.getDCXComposite().current,n={name:e,path:e,isUpdate:!!i.getComponentWithAbsolutePath("/"+e),parent:i.getChildrenOf()[0],relationship:"rendition",type:t.type,file:t};return this.composite.pushComponentWithRetry(n).then(function(){return this.composite.saveChanges((function(){}))}.bind(this))},updateNamedImageAsset:function(e,t,i,n){var r=this.composite.getDCXComposite().current,o={name:e,relationship:"rendition",type:i||"image/jpg",path:e,isUpdate:!!r.getComponentWithAbsolutePath("/"+e),parent:r.getChildrenOf()[0],copyFrom:{source:n,assetId:t}};return this.composite.pushComponentWithRetry(o)},getNamedImageAssetComponent:function(e){return this.composite.getDCXComposite().current.getComponentWithAbsolutePath("/"+e)},getNamedImageAsset:function(e,t){var n=this.getNamedImageAssetComponent(e);return n?this.composite.getImageComponentHref(n,t):i.reject("UserProfile: no component found for "+e)}})}.apply(t,n))||(e.exports=r)},680:function(e,t,i){var n,r;n=[i(9),i(11),i(2),i(712),i(198),i(63),i(715),i(37),i(97),i(33),i(1),i(13),i(111)],void 0===(r=function(e,t,n,r,o,a,s,c,l,u,d,h,g){"use strict";var f=a.logger,m=0;return t.Model.extend({defaults:{name:"",type:"private-collection",id:null,syncGroupName:"",components:null,compositeObj:null,publishProgress:null},_commitQueue:null,_commitInProgress:!1,_saveQueue:null,initialize:function(i){this._commitQueue=[],this._saveQueue=[],this._initDefer=n.defer(),this.iGUID=m++;var r=new t.Collection([],{model:s});this.set("components",r),this._doSaveChanges=this._doSaveChanges.bind(this),this._saveChangesDebounce=e.debounce(this._doSaveChanges,500)},linkSparkAsset:function(e){this._linkedSparkAsset=e},setName:function(e){this.getDCXComposite().current.name=e,this.set("name",e)},getEtag:function(){return this.getDCXComposite().current.manifestEtag},getDocData:function(e){var t=this.getDCXRoot(),i="";return t&&(i=t.getValue(e)),i},setIsMounted:function(e){this._isMounted=e},isMounted:function(){return!!this._isMounted},setCollaboration:function(e){this._collaboration=e},getCollaboration:function(){return this._collaboration||this.get("collaboration")||this.changed&&this.changed.collaboration||this.attributes&&this.attributes.collaboration},belongsToUser:function(){return"INCOMING"!==this.getCollaboration()},getCollaborationForAnalytics:function(){var e=this.getCollaboration();return"INCOMING"===e?"collabRecipient":"OUTGOING"===e?"collabOwner":"collabNone"},acquireNestedMap:function(e,t){return this._acquireNestedMap(e,t)},acquireNestedMapSync:function(e,t){return this._acquireNestedMap(e,!0,!0,t)},_acquireNestedMap:function(t,i,r,o){var a,s,c=this.getChildWithMap(t,o),l=!1;return c||(t=t.split("."),s="",e.each(t,function(e,t){s&&(s+="."),"{new}"!==e?(s+=e,(c=this.getChildWithMap(s,o))||(l=!0,c=this.addChildPath(void 0,e,a))):(l=!0,c=this.addChildPath(void 0,void 0,a),s+=c.getValue("path")),a=c}.bind(this)),!l||i)?r?c:n.resolve(c):this.saveChanges((function(){})).then((function(){return n.resolve(c)}))},acquireNestedChildren:function(e,t){return this.acquireNestedMap(e,t).then(function(e){return this.getChildrenOf(e)}.bind(this))},acquireNestedChildrenSync:function(e,t){if("all-fonts"===e&&!u.hasFeature("enable-custom-fonts"))return console.warn("Illegal custom fonts API call w/o feature flag",(new Error).stack),[];var i=this.acquireNestedMapSync(e,t);return this.getChildrenOf(i,t)},getChildWithMap:function(t,i){for(var n,r,o,a,s,c,l,u=i||this.getDCXComposite().current,d=u.getChildrenOf(),h=u.getComponentsOf(),g=function(e){if(e.getValue(c)==l)return r=e,a||(d=u.getChildrenOf(e),h=u.getComponentsOf(e)),!1},f=function(e){if(e.path==o)return r=e,a||(d=u.getChildrenOf(e),h=u.getComponentsOf(e)),!1},m=0,p=(t=t.split(".")).length;m<p;m++){if(o=t[m],s=/^\[([^\]\=]*)\=([^\]\=]*)\]$/.exec(o),-1!=o.search(/^\!/)?(a=!0,o=o.replace(/^\!/,"")):a=!1,!d)return;if(n=r,s?(c=s[1],l=s[2],e.find(a?h:d,g)):e.find(a?h:d,f),void 0!==r&&void 0!==n&&n==r)return}return r},getChildrenOf:function(e,t){return(t||this.getDCXComposite().current).getChildrenOf(e)},addChild:function(e,t){return this.getDCXComposite().current.addChild(e,void 0,-1,t)},addChildPath:function(e,t,i){var n=this.getDCXComposite().current.addChild(e,void 0,-1,i);return n.path=t||n.id,n},removeChild:function(e){return this.getDCXComposite().current.removeChild(e)},isNew:function(){return!this.getDCXComposite().current.manifestEtag},getDCXComposite:function(){return this.get("compositeObj")},getDCXRoot:function(){var e=this.get("compositeObj");return e?e.current.rootNode:null},setAndSaveDataToRoot:function(e,t){this.saveChanges((function(i){i.setValue(e,t)}))},getDataFromRoot:function(e){return this.getDCXRoot().getValue(e)},addComponent:function(e){e.composite=this.getDCXComposite();var t=this.get("components"),i=new s(e);return t.add(i),i},removeComponent:function(e){this.get("components").remove(e);var t=this.getDCXComposite().current,i=t.getComponentWithAbsolutePath("/"+e.get("path"));return t.removeComponent(i),e},getComponentWithAbsolutePath:function(e){return this.get("components").find((function(t){return t.get("path")==e.replace(/^\//,"")}))},getComponent:function(e,t){return a.getComponent(e,this.getDCXComposite(),t)},_privateResolveComponent:function(e){return e instanceof String||"string"==typeof e?this.getDCXComposite().current.getComponentWithAbsolutePath(e):e},getImageComponentHref:function(e,t,i){if(this.isMounted()&&!u.hasFeature("dcx-href-calc-enabled")){var r=this._privateResolveComponent(e);t=t||"full";var o="";i&&(o="&mime="+i);var s=(r.etag||"").replace(/['"]+/g,""),c="/image_assets/"+this.getMyApp().getSetting("syncGroup")+"/"+this.getDCXComposite().id+"/"+r.path+"?asset_id="+r.id+"&size="+t+"&img_etag="+s+o;return n.resolve(c)}return a.getComponentRenditionHref(this.getDCXComposite(),e,t,i)},_privateGetComponentHref:function(e,t){if(this.isMounted()&&!u.hasFeature("dcx-href-calc-enabled")){var i=(e.etag||"").replace(/['"]+/g,""),r="/image_assets/"+this.getURN()+"/"+e.path+"?asset_id="+e.id+"&img_etag="+i;return n.resolve(r)}return a._privateGetComponentHref(this.getDCXComposite(),e,t).then((function(e){return e}))},getFirstChildNode:function(){return this.getDCXComposite().current.getChildrenOf()[0]},findComponent:function(e,t){for(var i=this.getDCXComposite().current.getComponentsOf(e),n=0,r=i.length;n<r;n++){var o=i[n],a=!0;for(var s in t)if(t.hasOwnProperty(s)){var c=t[s];if(o[s]!=c){a=!1;break}}if(a)return o}},setProjectName:function(e){this.getMyApp().setProjectName(this,e)},getProjectName:function(e){return this.getMyApp().getProjectName(this,e)},preloadImageRendition:function(e){var t=n.defer();return this.getImageRendition(e).then(function(e){var i,n;e&&(i=e.url),i?((n=new Image).onload=function(){t.resolve(i)},n.onerror=function(){t.reject(new Error("Image rendition "+i+" came back with 404"))},n.src=i):t.resolve()}.bind(this)).catch((function(e){window.marvel.logger.error("failed to get image rendition",e),t.reject(e)})).done(),t.promise},getImageRendition:function(e){var t,i=this.getDCXComposite().current,r=this.getDCXRoot(),o=r.getValue("slate#coverpath");e=e||400;var a,s="center",c="center";if(r.type.match("luca")&&o){t=i.getComponentWithAbsolutePath("/"+o),s=r.getValue("slate#coverx"),c=r.getValue("slate#covery");var l=r.getValue("slate#data");a=l&&l.themeName&&"vintage"==l.themeName.toLowerCase()?"grayscale(1)":void 0}else t=this.getImageRenditionComponent();if(t){return e&&{size:e},this.getImageComponentHref(t,e).then(function(e){return{url:e,position:s+" "+c,filter:a}}.bind(this))}return n.reject(new Error("failed to find rendition component"))},getImageRenditionComponent:function(){if("function"==typeof this.getMyApp().getPreviewComponent)return this.getMyApp().getPreviewComponent(this);var t=this.getDCXComposite().current;return e.find(t.getComponentsOf(),(function(e){return e&&e.type.match(/^image/)&&"rendition"==e.relationship&&"shareImage"!=e.name&&"embed"!=e.name}))},getInfoForComponents:function(t,i){var r,o=this.getMyPrimaryApp(),a=o.getAppTypeID(),s={},c=(e.isArray(t),{GooglePhotosImagePickerContext:"google",DropboxImagePickerContext:"dropbox",DooploImagePickerContext:"dooplo",FacebookImagePickerContext:"facebook",AdobestockImagePickerContext:"stock",CCImagePickerContext:"creativeCloud",LightroomImagePickerContext:"lightroom",UploadedImagePickerContext:"uploaded",undefined:"uploaded"}),l={Google:"google",Dropbox:"dropbox",Dooplo:"dooplo",Facebook:"facebook",AdobeStock:"stock",CreativeCloud:"creativeCloud",Lightroom:"lightroom",Uploaded:"uploaded",undefined:"uploaded"};return"slate"===a?this.getComponent("/luca.json",i).then(function(t){return o.load().then(function(){var i,a;if(i=o.getStorageImpl().getData("imagePickerContexts",this),a={},e.each(i,(function(e){a[e.asset_id]=e})),t)try{r=JSON.parse(t)}catch(l){return n.reject(l)}return r&&r.pages&&r.pages.length&&e.each(r.pages[0].sections,(function(t){e.each(t.content_items,(function(e){if("img"===e.type&&e.image){s[e.image.image_url.split("?")[0]]=e.image;var t=a[e.image.id];e.image.pickerContext=a[t],e.image.srcName=c[t?t.class_name:void 0]}}))})),s}.bind(this))}.bind(this)).catch((function(e){return n.reject(e)})):"voice"==a?this.getComponent("/PageSequence.json",i).then(function(t){var i;try{i=JSON.parse(t)}catch(o){return n.reject(o)}var r=e.find(i,(function(e){return"PageSequence"==e.className}));return r&&r.data&&r.data.pages&&e.each(r.data.pages,(function(t){var i;t&&t.data&&t.data.layout&&t.data.layout.data&&(i=t.data.layout.data.items),i&&e.each(i,(function(e){if(e.data&&"Image"==e.data.contentType){var t,i=e.data.content,n=e.data.searchTerm;n&&(t=-1==n.search(/\//)?"Dooplo":n.replace(/^\s*/,"").replace(/\/.*$/,"")),s[i]={srcName:l[t]||"uploaded"}}}))})),s}.bind(this)).catch((function(e){return n.reject(e)})):n.resolve()},_lazyLoadPublishUtils:function(){return this._videoPublishLazyLoadDefer||(this._videoPublishLazyLoadDefer=n.defer(),Promise.all([i.e("m-react-spectrum"),i.e(0),i.e(1),i.e(2),i.e("gic-voice-publishUtils")]).then(function(e){var t=i(865);this._videoPublishLazyLoadDefer.resolve(t)}.bind(this).bind(null,i)).catch(i.oe)),this._videoPublishLazyLoadDefer.promise},getImageComponents:function(t,i){var r=this.getMyPrimaryApp().getAppTypeID(),o=this.getDCXComposite().current;return t=t||{},"voice"!==r||t.publishUtils?this.getInfoForComponents("images",i).then(function(i){var a,s=[];if("slate"===r?a=e.find(o.getChildrenOf(),(function(e){return"page"===e.name})):"voice"===r?a=e.find(o.getChildrenOf(),(function(e){return"Media"===e.name})):"theo"===r&&(a=e.find(o.getChildrenOf(),(function(e){return"application/vnd.adobe.theo.content+dcx"===e.type&&"/content"===e.absolutePath}))),a){var c,l,u=o.getComponentsOf(a);if("slate"===r)e.each(u,(function(e){(l=i[e.path])&&s.push({component:e,data:l})}));else if("theo"===r)(c=a._data.children)&&c.length&&(c=c[0].children)&&(s=[],e.each(c,(function(t){if("image"===t["theo#kind"]){var i=t.components?o.getComponentWithId(t.components[0].id):o.getComponentWithId(t.path);if(i){var n=t["theo#media-metadata"]||{};"adobestock"===n.source&&((n=e.assign({},n)).license=e.assign({},n)),s.push({component:i,data:n})}}})));else if("voice"===r){var d={};c=a._data.children,s=[],e.each(c,(function(t){var n;t.components&&e.each(t.components,(function(e){if(e&&e.type.match(/^image/)&&(n=o.getComponentWithId(e.id))&&i[e.id]){var r=t["ginger#data"],a={component:n,data:r};s.push(a),d[n.id]=a}}))}));var h=[];return e.each(s,function(e){h.push(t.publishUtils.makeMetadataPromise(this.id,e.component.id))}.bind(this)),n.allSettled(h).then((function(t){var n=[];return e.each(t,(function(t){if("fulfilled"==t.state){var r=t.value.contentID,o=d[r];if(o){var a=t.value,s=i[r];o.data=e.extend({},a,s)}}else n.push(t.reason)})),n.length&&window.marvel.logger.warn("errors fetching video metadatata in getImageComponents",n),s}))}}return s}.bind(this)):this._lazyLoadPublishUtils().then(function(e){return t.publishUtils=e,this.getImageComponents(t,i)}.bind(this))},pushComponent:function(e,t){return this._pushComponent(e,!1,t)},pushComponentWithRetry:function(e,t){return this._pushComponent(e,!0,t)},_pushComponent:function(t,i,n){var r=this.getDCXComposite(),o=this.get("syncGroupName"),s=t.isUpdate,c=e.pick(t,["id","name","relationship","type","path","absolutePath","file","parent","copyFrom","cover"]);return this.ensureCompositeIsSaved((function(){return i?a.pushComponent(c,r,o,s,n):a.pushComponentWithoutRetry(c,r,o,s,n)}),n)},isMidCommit:function(){return!!this._commitInProgress},pull:function(e){var t=n.defer(),i=this.getDCXComposite();return a.pullComposite(i,e).then((function(e){t.resolve(e)})),t.promise},_resolveOrganizerProjectRenameConflict:function(e,t,i,n,o){if(e.current.rootNode.name!==t.rootNode.name||i.rootNode.name!==t.rootNode.name){var a=i.copy();if(e.current.rootNode.name!==t.rootNode.name){for(var s=r(e.current._data,t._data)||[],c=!1,l=0,u=s.length;l<u;l++){var d=s[l].path[0];if("local"===d||"state"===d);else{if("name"!==d)return f.error("Unexpected property changed in Organizer view",{propName:d,diffResults:s}),void n.reject(o);a.rootNode.name=e.current.rootNode.name,c=!0}}if(!c)return f.error('_resolveOrganizerProjectRenameConflict "diff" reported no project name change?'),void n.reject(o)}else f.warn("_resolveOrganizerProjectRenameConflict: How'd we encounter a conflict and the local project name hasn't changed?");e.resolvePullWithBranch(a,function(e){e?n.reject(e):(n.resolve(),this.saveChanges((function(){}),!0))}.bind(this))}else n.reject(o)},_resolveConflict:function(t,i,r){var s=this.getDCXComposite();return a.pullCompositeManifestOnly(s,r).then(function(r){return n.all([a.loadBaseBranch(s),o.load()]).then(function(o){var a=o[0],c=o[1].ACPSparkController.isEditorOpen();e.each(i,function(e){if(c){var i=this.getMyApp();i.resolveConflict?i.resolveConflict(r,e.recoverData,e.commitDefer,this,s,a,t):e.commitDefer.reject(t)}else this._resolveOrganizerProjectRenameConflict(s,a,r,e.commitDefer,t)}.bind(this));var l=[];return e.each(i,(function(e){e.commitDefer&&l.push(e.commitDefer.promise)})),n.all(l)}.bind(this)).then((function(e){return n.resolve()})).catch((function(e){return f.error("CompositeDocModel._resolveConflict ignoring caught errors. Returning original UPDATE_CONFLICT error.",e),n.reject(t)}))}.bind(this)).catch((function(n){f.error("CompositeDocModel caught error during conflict resolution pullCompositeManifestOnly",{outerErr:t,caughtErr:n}),e.each(i,(function(e){e.commitDefer&&e.commitDefer.reject(t)}))}))},downloadComponents:function(e){var t=[],i=this.getDCXComposite(),r=i.current.allComponents();return r instanceof Array&&(t=r.map((function(t){return a.getComponent(t,i,e)}))),n.allSettled(t)},_doSaveChanges:function(t){var i;if(!this._commitInProgress){marvel.events.trigger("sync-start",!0),this._commitInProgress=!0,i=this.get("syncGroupName"),this.setModifiedDate(new Date((new Date).getTime()+864e5)),this.isNew()?!0:marvel.events.trigger("saved-composite-doc",this);var r,o=this.getDCXRoot(),s=this._commitQueue;this._commitQueue=[],e.each(s,(function(e){e.override&&(r=!0),e.fnSet(o)})),this.set("name",this.getDCXComposite().current.name),this.ensureCompositeIsSaved(function(){return this.pushModifiedComponents(t).then(function(){return this.getMyApp().usesContentModifiedEtags()&&this.setContentModifiedIfNeeded(),a.pushComposite(this.getDCXComposite(),i,r,t).then(function(){f.debug("[compositeDoc saved]"),marvel.events.trigger("saved-composite-doc",this),this._commitInProgress=!1,marvel.events.trigger("sync-stop",!0),e.each(s,(function(e){e.commitDefer.resolve()})),this._commitQueue.length&&this._saveChangesDebounce(t)}.bind(this))}.bind(this))}.bind(this)).catch(function(i){try{if(f.error("CompositeDocModel error while saving",{err:i}),this._commitInProgress=!1,i&&"UPDATE_CONFLICT"===i.code)return this._resolveConflict(i,s,t);if(i&&"EXCEEDS_QUOTA"===i.code)return console.warn("TBD: handle EXCEEDS_QUOTA"),n.reject(i);e.each(s,(function(e){return e.commitDefer.reject(i)}))}catch(r){return f.error("CompositeDocModel caught error during error handling",{outerErr:i,caughtErr:r}),n.reject(i)}}.bind(this)).done()}},triggerProjectCreatedAnalytics:function(e){(e=e||{}).contextData&&c.addContextData(e.contextData);var t=this.getMyApp(),i=this;if(t.isaProjectFormat()){var n=this.getMyApp().typeName;"theo"!==n&&"post"!==n||c.setProductName("theo"),c.setCurrentProjectId(this.get("id")),c.trackEvent("projectCreated",{contextData:["projectId","workflow","projectType","contextString","exampleId","remixableAssetId","createdFromId"]},e.env||this.getMyApp().typeName+":editor",function(){c.removeContextData(["type","contextString","exampleId","remixableAssetId","createdFromId"])}.bind(this)),t.isBranded(this).then((function(n){n&&g.getCreatedAnalytics(i).then((function(i){c.trackEvent("createdBrandedProject",i,e.env||t.typeName+":editor")}))}))}},ensureCompositeIsSaved:function(t,i){if(this.isNew()&&!this._isBeingCreatedPromise){var r=this.getDCXComposite(),s=this.get("syncGroupName"),c=a.AdobeDCXUtil.appendPathElements("assets",s,r.id),l=n.defer();f.traceflow("dcx-3","CREATING:: "+s+" and "+r.id);var u=a.createAbortHelper(i,l);return u.requestContext=a.dcx.compositeXfer.createComposite(r,c,!1,a.dcxSession,function(e,t){window.marvel.logger.info("[Client:Storage] created composite in the cloud.",{projectId:r.id,syncGroup:s}),u.reset(),e?(window.marvel.logger.error("[Client:Storage] failed to create project.",{projectId:r.id,error:e}),l.reject(e)):o.load().then(function(e){try{this.triggerProjectCreatedAnalytics()}catch(i){window.marvel.logger.error("[Client:Storage] triggerProjectCreatedAnalytics failed during create project.",{projectId:r.id,error:i})}e.ACPSparkController.addCompositeDocLocal(r.assetId,this),l.resolve(t)}.bind(this)).catch((function(e){window.marvel.logger.error("[Client:Storage] failed to add local CompositeDocModel",{projectId:r.id,error:e}),l.resolve(t)}))}.bind(this)),this._isBeingCreatedPromise=l.promise.then(function(){return window.marvel.logger.info("[Client:Storage] created promise resolved. Pushing composite...",{projectId:r.id,syncGroup:s}),a.pushComposite(this.getDCXComposite(),this.get("syncGroupName"),!1,i).then(function(){var i=t(),n=this._saveQueue;return this._saveQueue=[],this._isBeingCreatedPromise=null,window.marvel.logger.info("[Client:Storage] pushing composite was successfull.",{projectId:r.id,syncGroup:s}),e.each(n,(function(e){e.deferred.resolve(e.fn())})),i}.bind(this))}.bind(this)),this._isBeingCreatedPromise}return this.isNew()&&this._isBeingCreatedPromise?this._isBeingCreatedPromise.then(t):t()},pushModifiedComponents:function(e){var t=this.getDCXComposite();return n.all(this.get("components").reduce(function(i,n){var r=n.get("path");return n.isModified()&&i.push(a.pushComponent({path:r,name:n.get("name"),relationship:n.get("relationship"),type:n.get("type"),file:n.getFile(),parent:n.get("parent")},t,this.get("syncGroupName"),t.current.getComponentWithAbsolutePath("/"+r),e).then((function(){n.setUnmodified()})).catch(function(e){throw f.error("Failed to push modified components "+e,e),e.componentInfo={path:r,name:n.get("name"),type:n.get("type"),composite:{assetId:t.assetId,href:t.href}},e}.bind(this))),i}.bind(this),[]))},clearRootDataWithPrefix:function(t){var i=this.getDCXComposite().current._data;e.each(i,(function(e,n){0===n.indexOf(t)&&delete i[n]}))},clearUnneededDuplicationData:function(){this.getMyApp().clearDataForDocCreatedByDupe(this)},nextSave:function(){return this._nextSaveDefer||(this._nextSaveDefer=n.defer()),this._nextSaveDefer.promise},saveChanges:function(e,t,i,r){var o={override:t,commitDefer:this._nextSaveDefer||n.defer(),fnSet:e,recoverData:i};return this._nextSaveDefer=null,f.debug("[compositeDoc saving]"),this._commitQueue.push(o),this._saveChangesDebounce(r),o.commitDefer.promise},_patchCurrent:function(e,t){var i=this.getDCXComposite().current._data;if(i[e]=t,arguments.length>2)for(var n=2;n<arguments.length;n+=2)i[arguments[n]]=arguments[n+1]},setDocRootVals:function(e,t){var i=arguments;this.saveChanges((function(e){for(var t=i.length,n=0;n<t;n+=2)e.setValue(i[n],i[n+1])}))},getComponentEtag:function(e){var t=this.getDCXComposite().current.getComponentWithAbsolutePath(e);return t?t.etag:null},getAppRegistry:function(){return l},getMyApp:function(){return l.getAppForDoc(this)},getMyPrimaryApp:function(){var t=this.getMyApp(),i=t.getSetting("syncGroup");return e.endsWith(i,"-template")&&(t=l.getAppBySyncGroupName(t.getConfig().templateSyncGroup)),t},isTemplate:function(){var t=this.getMyApp().getSetting("syncGroup");return e.endsWith(t,"-template")},getMainContentEtag:function(){return this.getMyApp().getDocContentETag(this)},setContentModifiedIfNeeded:function(){var e=this.getMyApp().getDocContentETag(this)||"";e!=this.getContentModEtag()&&this._patchCurrent("cp#contentEtag",e,"cp#contentModified",this._getFutureModDate())},getContentModEtag:function(){return this.getDCXRoot().getValue("cp#contentEtag")},getContentModifiedDate:function(e){var t=this.get("modified");return e&&e.preferCpContentModified&&(t=this.getDCXRoot().getValue("cp#contentModified")||t),t?t.indexOf("Z")>-1?this._unZpadDate(t):new Date(t):new Date},_unZpadDate:function(e){var t=Date.parse(e);if(isNaN(t)){var i,n=e.split("T"),r=1*n[1].substring(0,2);return r>23?(e=n[0]+"T23"+n[1].substring(2),(i=new Date(e)).setUTCHours(i.getUTCHours()+(r-23)),i):new Date}return new Date(t)},_zpadDate:function(e,t){t&&(e=new Date(e)).setUTCHours(e.getUTCHours()+e.getTimezoneOffset()/60);var i=e.getHours();function n(e,t){for(var i=""+e;i.length<t;)i="0"+i;return i}return e.getFullYear()+"-"+n(e.getMonth()+1,2)+"-"+n(e.getDate(),2)+"T"+n(i,2)+":"+n(e.getMinutes(),2)+":"+n(e.getSeconds(),2)+"."+n(e.getMilliseconds(),2)+"Z"},_getFutureModDate:function(){return this._zpadDate(new Date((new Date).getTime()+3e4),!0)},setModifiedDate:function(e){this.set("modified",this._zpadDate(e))},isPublished:function(){return this.getMyApp().isDocPublished(this)},delete:function(e){return a.deleteCompositeDoc(this,e)},getStorageURL:function(){return("https://"+window.marvel.settings.ss+"/id/"+this.getDCXComposite().assetId).replace("-creativesdk","")},getStoragePath:function(){var e=this.getStorageURL();return e.substring(e.indexOf("/id/")+1)},getRoutableId:function(){return this.getURN()},getURN:function(){return n.resolve(this.getDCXComposite().assetId)},getSharedCloudCollectionId:function(){return a.getSharedCloudCollectionId(this.getDCXComposite())},discoverDocumentMetadata:function(){var e=n.defer(),t=this.getStoragePath();return h.ajax({type:"GET",url:"https://"+window.marvel.settings.ss+"/"+t+"/:metadata",headers:{"x-api-key":window.marvel.settings.key}}).then(function(t,i,n){e.resolve(t)}.bind(this)).fail((function(t){e.reject(t)})),e.promise},getDocDimensions:function(){var e,t={width:0,height:0};try{e=this.getDCXComposite().current.getChildrenOf()}catch(n){window.marvel.logger.error("Error from DCX attempting to page through manifest",n)}if(e){var i=e.find((function(e){return e.getValue("theo#size-id")}));i&&(t.width=i.getValue("theo#size")[0],t.height=i.getValue("theo#size")[1])}return t},hasCloudDocChanged:function(){var e=n.defer(),t=this.getStoragePath();return h.ajax({type:"HEAD",url:"https://"+window.marvel.settings.ss+"/"+t+"/:manifest",headers:{"x-api-key":window.marvel.settings.key}}).then(function(t,i,n){e.resolve(n.getResponseHeader("etag")!==this.getEtag())}.bind(this)).fail((function(t){e.reject(t)})),e.promise}})}.apply(t,n))||(e.exports=r)},682:function(e,t,i){var n,r;n=[i(16),i(9),i(11),i(224)],void 0===(r=function(e,t,i,n){"use strict";return i.View.extend({initialize:function(){this.enforceTabTrap=!1,t.bindAll(this,t.functionsIn(this))},_workflowId:void 0,setWorkflowId:function(e){this._workflowId=e},ignoreNextKeyup:function(){this._ignoreNextKeyup=!0},onEscapePressed:function(){this.hideOverlay()},handleKeydown:function(e){this.enforceTabTrap&&e.keyCode===n.DOM_VK_TAB&&(e.target==this._firstFocusElement&&e.shiftKey&&(e.preventDefault(),this._lastFocusElement.focus()),e.target!=this._lastFocusElement||e.shiftKey||(e.preventDefault(),this._firstFocusElement.focus()))},handleKeyup:function(e){this._ignoreNextKeyup?this._ignoreNextKeyup=!1:e.keyCode!==n.DOM_VK_ESCAPE||this._ignoreCloseActions||this.onEscapePressed()},scrollCapture:function(t){e(window).scrollTop(this._oldScrollPos),t.preventDefault()},handleShellHideTransitionEnd:function(){this.$el.addClass("hide"),this.$el.removeClass("transitioned-out")},_showEl:function(){this.transitionObjectSelector&&(this.$el.find(this.transitionObjectSelector).addClass("no-transition"),this.$el.addClass("transitioned-out"),t.delay(function(){this.$el.find(this.transitionObjectSelector).removeClass("no-transition"),this.$el.removeClass("transitioned-out")}.bind(this),1)),this.$el.removeClass("hide")},_hideEl:function(){this.transitionObjectSelector?(this.$el.find(this.transitionObjectSelector).one("transitionend",this.handleShellHideTransitionEnd.bind(this)),this.$el.addClass("transitioned-out")):this.$el.addClass("hide")},refreshTabTrapSentinels:function(){if(this.enforceTabTrap){var e=this.$el.find('a[href]:visible, area[href]:visible, input:not([disabled]):visible, select:not([disabled]):visible, textarea:not([disabled]):visible, button:not([disabled]):visible, [tabindex="0"]:visible');0===e.length?window.marvel.logger.warn("refreshTabTrapSentinels: no focusable elements to trap!"):(this._firstFocusElement=e[0],this._lastFocusElement=e[e.length-1])}},focusFirstElement:function(){this._firstFocusElement&&this._firstFocusElement.focus()},showOverlay:function(){window.marvel.events.dialogShown(this._dialogName),marvel._dialogShowing=!0,this.render(),e(document).on("keyup.dialog",this.handleKeyup),this.enforceTabTrap&&e(document).on("keydown.dialog",this.handleKeydown),this._ignoreNextKeyup=!1,this._showEl(),this._oldScrollPos=e(window).scrollTop();var t=this._oldScrollPos;e(window).on("scroll.scrolldisabler",(function(i){e(window).scrollTop(t),i.preventDefault()})),this.refreshTabTrapSentinels()},hideOverlay:function(){return(!this.interceptHide||!this.interceptHide())&&(marvel._dialogShowing=!1,e(document).off("keyup.dialog",this.handleKeyup),this.enforceTabTrap&&e(document).off("keydown.dialog",this.handleKeydown),e(window).off("scroll.scrolldisabler"),this._hideEl(),this.onHide&&this.onHide(),this._workflowId&&marvel.events.trigger(this._workflowId+"-closed",this),window.marvel.events.dialogClosed(),!0)},handleCloseBtn:function(){this._ignoreCloseActions||this.hideOverlay()}})}.apply(t,n))||(e.exports=r)},685:function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyBpZD0iTGF5ZXJfMSIgZGF0YS1uYW1lPSJMYXllciAxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1OCAyNCIgd2lkdGg9IjU4IiBoZWlnaHQ9IjI0Ij48ZGVmcz48c3R5bGU+LmNscy0xe2ZpbGw6I2ZmZjt9PC9zdHlsZT48L2RlZnM+PHRpdGxlPmljb24tcGlsbC1tYXNrPC90aXRsZT48cGF0aCBpZD0icGF0aC0xIiBjbGFzcz0iY2xzLTEiIGQ9Ik0xMiwyNEgwVjEyLjE5QTEyLjA1LDEyLjA1LDAsMCwwLDEyLDI0Wm00NiwwSDQ2QTEyLjA2LDEyLjA2LDAsMCwwLDU4LDEyLjIyVjI0Wk0wLDExLjgxSDBWMEgxMS44M0ExMi4wOSwxMi4wOSwwLDAsMCwwLDExLjgxWm01OCwwQTEyLDEyLDAsMCwwLDQ2LjIxLDBINThWMTEuNzhaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwIDApIi8+PC9zdmc+Cg=="},689:function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjQwODBweCIgaGVpZ2h0PSI2OHB4IiB2aWV3Qm94PSIwIDAgNDA4MCA2OCI+CjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+Cgkuc3Qwe2ZpbGwtb3BhY2l0eTowO3N0cm9rZTojMDAwO3N0cm9rZS13aWR0aDo0O3N0cm9rZS1vcGFjaXR5OjAuMTt9Cgkuc3Qxe2ZpbGwtb3BhY2l0eTowO3N0cm9rZTojNUM1Q0UwO3N0cm9rZS13aWR0aDo0O30KPC9zdHlsZT4KPHBhdGggY2xhc3M9InN0MCIgZD0iTTM0LDRjMTYuNiwwLDMwLDEzLjQsMzAsMzBTNTAuNiw2NCwzNCw2NFM0LDUwLjYsNCwzNFMxNy40LDQsMzQsNHoiLz4KPHBhdGggY2xhc3M9InN0MSIgZD0iTTM0LDRMMzQsNGMxNi42LDAsMzAsMTMuNCwzMCwzMCIvPgo8cGF0aCBjbGFzcz0ic3QwIiBkPSJNMTAyLDRjMTYuNiwwLDMwLDEzLjQsMzAsMzBzLTEzLjQsMzAtMzAsMzBTNzIsNTAuNiw3MiwzNFM4NS40LDQsMTAyLDR6Ii8+CjxwYXRoIGNsYXNzPSJzdDEiIGQ9Ik0xMDIuOCw0QzExOSw0LjQsMTMyLDE3LjcsMTMyLDM0YzAsMy40LTAuNiw2LjctMS42LDkuOCIvPgo8cGF0aCBjbGFzcz0ic3QwIiBkPSJNMTcwLDRjMTYuNiwwLDMwLDEzLjQsMzAsMzBzLTEzLjQsMzAtMzAsMzBzLTMwLTEzLjQtMzAtMzBTMTUzLjQsNCwxNzAsNHoiLz4KPHBhdGggY2xhc3M9InN0MSIgZD0iTTE3MS42LDRDMTg3LjQsNC45LDIwMCwxOCwyMDAsMzRjMCw2LjgtMi4zLDEzLjEtNi4xLDE4LjIiLz4KPHBhdGggY2xhc3M9InN0MCIgZD0iTTIzOCw0YzE2LjYsMCwzMCwxMy40LDMwLDMwcy0xMy40LDMwLTMwLDMwcy0zMC0xMy40LTMwLTMwUzIyMS40LDQsMjM4LDR6Ii8+CjxwYXRoIGNsYXNzPSJzdDEiIGQ9Ik0yNDAuNCw0LjFDMjU1LjgsNS4zLDI2OCwxOC4yLDI2OCwzNGMwLDEwLjEtNSwxOS0xMi42LDI0LjQiLz4KPHBhdGggY2xhc3M9InN0MCIgZD0iTTMwNiw0YzE2LjYsMCwzMCwxMy40LDMwLDMwcy0xMy40LDMwLTMwLDMwcy0zMC0xMy40LTMwLTMwUzI4OS40LDQsMzA2LDR6Ii8+CjxwYXRoIGNsYXNzPSJzdDEiIGQ9Ik0zMDkuMSw0LjJDMzI0LjIsNS43LDMzNiwxOC41LDMzNiwzNGMwLDEzLjItOC41LDI0LjQtMjAuMywyOC40Ii8+CjxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik0zNzQsNGMxNi42LDAsMzAsMTMuNCwzMCwzMHMtMTMuNCwzMC0zMCwzMHMtMzAtMTMuNC0zMC0zMFMzNTcuNCw0LDM3NCw0eiIvPgo8cGF0aCBjbGFzcz0ic3QxIiBkPSJNMzc3LjksNC4zQzM5Mi42LDYuMiw0MDQsMTguOCw0MDQsMzRjMCwxNi0xMi42LDI5LjEtMjguNCwzMCIvPgo8cGF0aCBjbGFzcz0ic3QwIiBkPSJNNDQyLDRjMTYuNiwwLDMwLDEzLjQsMzAsMzBzLTEzLjQsMzAtMzAsMzBzLTMwLTEzLjQtMzAtMzBTNDI1LjQsNCw0NDIsNHoiLz4KPHBhdGggY2xhc3M9InN0MSIgZD0iTTQ0Ni43LDQuNEM0NjEsNi42LDQ3MiwxOSw0NzIsMzRjMCwxNi42LTEzLjQsMzAtMzAsMzBjLTIuMSwwLTQuMi0wLjItNi4yLTAuNiIvPgo8cGF0aCBjbGFzcz0ic3QwIiBkPSJNNTEwLDRjMTYuNiwwLDMwLDEzLjQsMzAsMzBzLTEzLjQsMzAtMzAsMzBjLTE2LjYsMC0zMC0xMy40LTMwLTMwUzQ5My40LDQsNTEwLDR6Ii8+CjxwYXRoIGNsYXNzPSJzdDEiIGQ9Ik01MTUuNSw0LjVDNTI5LjQsNy4xLDU0MCwxOS4zLDU0MCwzNGMwLDE2LjYtMTMuNCwzMC0zMCwzMGMtNC43LDAtOS4yLTEuMS0xMy4yLTMuMSIvPgo8cGF0aCBjbGFzcz0ic3QwIiBkPSJNNTc4LDRjMTYuNiwwLDMwLDEzLjQsMzAsMzBzLTEzLjQsMzAtMzAsMzBzLTMwLTEzLjQtMzAtMzBTNTYxLjQsNCw1NzgsNHoiLz4KPHBhdGggY2xhc3M9InN0MSIgZD0iTTU4NC4yLDQuN0M1OTcuOCw3LjUsNjA4LDE5LjYsNjA4LDM0YzAsMTYuNi0xMy40LDMwLTMwLDMwYy03LjMsMC0xNC0yLjYtMTkuMS02LjkiLz4KPHBhdGggY2xhc3M9InN0MCIgZD0iTTY0Niw0YzE2LjYsMCwzMCwxMy40LDMwLDMwcy0xMy40LDMwLTMwLDMwcy0zMC0xMy40LTMwLTMwUzYyOS40LDQsNjQ2LDR6Ii8+CjxwYXRoIGNsYXNzPSJzdDEiIGQ9Ik02NTMsNC44QzY2Ni4yLDgsNjc2LDE5LjksNjc2LDM0YzAsMTYuNi0xMy40LDMwLTMwLDMwYy05LjcsMC0xOC4zLTQuNi0yMy44LTExLjgiLz4KPHBhdGggY2xhc3M9InN0MCIgZD0iTTcxNCw0YzE2LjYsMCwzMCwxMy40LDMwLDMwcy0xMy40LDMwLTMwLDMwcy0zMC0xMy40LTMwLTMwUzY5Ny40LDQsNzE0LDR6Ii8+CjxwYXRoIGNsYXNzPSJzdDEiIGQ9Ik03MjEuOCw1QzczNC42LDguNCw3NDQsMjAuMSw3NDQsMzRjMCwxNi42LTEzLjQsMzAtMzAsMzBjLTEyLDAtMjIuMy03LTI3LjEtMTcuMiIvPgo8cGF0aCBjbGFzcz0ic3QwIiBkPSJNNzgyLDRjMTYuNiwwLDMwLDEzLjQsMzAsMzBzLTEzLjQsMzAtMzAsMzBzLTMwLTEzLjQtMzAtMzBTNzY1LjQsNCw3ODIsNHoiLz4KPHBhdGggY2xhc3M9InN0MSIgZD0iTTc5MC41LDUuMkM4MDIuOSw4LjksODEyLDIwLjQsODEyLDM0YzAsMTYuNi0xMy40LDMwLTMwLDMwYy0xNC4xLDAtMjYtOS44LTI5LjItMjIuOSIvPgo8cGF0aCBjbGFzcz0ic3QwIiBkPSJNODUwLDRjMTYuNiwwLDMwLDEzLjQsMzAsMzBzLTEzLjQsMzAtMzAsMzBzLTMwLTEzLjQtMzAtMzBTODMzLjQsNCw4NTAsNHoiLz4KPHBhdGggY2xhc3M9InN0MSIgZD0iTTg1OS4zLDUuNUM4NzEuMyw5LjQsODgwLDIwLjcsODgwLDM0YzAsMTYuNi0xMy40LDMwLTMwLDMwYy0xNi4xLDAtMjkuMy0xMi43LTMwLTI4LjYiLz4KPHBhdGggY2xhc3M9InN0MCIgZD0iTTkxOCw0YzE2LjYsMCwzMCwxMy40LDMwLDMwcy0xMy40LDMwLTMwLDMwcy0zMC0xMy40LTMwLTMwUzkwMS40LDQsOTE4LDR6Ii8+CjxwYXRoIGNsYXNzPSJzdDEiIGQ9Ik05MjgsNS43QzkzOS43LDkuOCw5NDgsMjEsOTQ4LDM0YzAsMTYuNi0xMy40LDMwLTMwLDMwcy0zMC0xMy40LTMwLTMwYzAtMS40LDAuMS0yLjgsMC4zLTQuMSIvPgo8cGF0aCBjbGFzcz0ic3QwIiBkPSJNOTg2LDRjMTYuNiwwLDMwLDEzLjQsMzAsMzBzLTEzLjQsMzAtMzAsMzBzLTMwLTEzLjQtMzAtMzBTOTY5LjQsNCw5ODYsNHoiLz4KPHBhdGggY2xhc3M9InN0MSIgZD0iTTk5Ni44LDZjMTEuMiw0LjMsMTkuMiwxNS4yLDE5LjIsMjhjMCwxNi42LTEzLjQsMzAtMzAsMzBzLTMwLTEzLjQtMzAtMzBjMC0zLjIsMC41LTYuMywxLjQtOS4xIi8+CjxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik0xMDU0LDRjMTYuNiwwLDMwLDEzLjQsMzAsMzBzLTEzLjQsMzAtMzAsMzBzLTMwLTEzLjQtMzAtMzBTMTAzNy40LDQsMTA1NCw0eiIvPgo8cGF0aCBjbGFzcz0ic3QxIiBkPSJNMTA2NS41LDYuM2MxMC44LDQuNSwxOC41LDE1LjIsMTguNSwyNy43YzAsMTYuNi0xMy40LDMwLTMwLDMwcy0zMC0xMy40LTMwLTMwYzAtNC45LDEuMi05LjYsMy4zLTEzLjciLz4KPHBhdGggY2xhc3M9InN0MCIgZD0iTTExMjIsNGMxNi42LDAsMzAsMTMuNCwzMCwzMHMtMTMuNCwzMC0zMCwzMHMtMzAtMTMuNC0zMC0zMFMxMTA1LjQsNCwxMTIyLDR6Ii8+CjxwYXRoIGNsYXNzPSJzdDEiIGQ9Ik0xMTM0LjIsNi42YzEwLjUsNC43LDE3LjgsMTUuMiwxNy44LDI3LjRjMCwxNi42LTEzLjQsMzAtMzAsMzBzLTMwLTEzLjQtMzAtMzBjMC02LjYsMi4xLTEyLjcsNS43LTE3LjYiLz4KPHBhdGggY2xhc3M9InN0MCIgZD0iTTExOTAsNGMxNi42LDAsMzAsMTMuNCwzMCwzMHMtMTMuNCwzMC0zMCwzMHMtMzAtMTMuNC0zMC0zMFMxMTczLjQsNCwxMTkwLDR6Ii8+CjxwYXRoIGNsYXNzPSJzdDEiIGQ9Ik0xMjAzLDYuOWMxMCw0LjksMTcsMTUuMiwxNywyNy4xYzAsMTYuNi0xMy40LDMwLTMwLDMwcy0zMC0xMy40LTMwLTMwYzAtOC4yLDMuMy0xNS42LDguNi0yMSIvPgo8cGF0aCBjbGFzcz0ic3QwIiBkPSJNMTI1OCw0YzE2LjYsMCwzMCwxMy40LDMwLDMwcy0xMy40LDMwLTMwLDMwcy0zMC0xMy40LTMwLTMwUzEyNDEuNCw0LDEyNTgsNHoiLz4KPHBhdGggY2xhc3M9InN0MSIgZD0iTTEyODEuNCwxNS4zYzQuMSw1LjEsNi42LDExLjYsNi42LDE4LjdjMCwxNi42LTEzLjQsMzAtMzAsMzBzLTMwLTEzLjQtMzAtMzBjMC05LjYsNC42LTE4LjIsMTEuNi0yMy43Ii8+CjxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik0xMzI2LDRjMTYuNiwwLDMwLDEzLjQsMzAsMzBzLTEzLjQsMzAtMzAsMzBzLTMwLTEzLjQtMzAtMzBTMTMwOS40LDQsMTMyNiw0eiIvPgo8cGF0aCBjbGFzcz0ic3QxIiBkPSJNMTM1NSwyNi40YzAuNiwyLjQsMSw1LDEsNy42YzAsMTYuNi0xMy40LDMwLTMwLDMwcy0zMC0xMy40LTMwLTMwYzAtMTEsNi0yMC43LDE0LjktMjUuOSIvPgo8cGF0aCBjbGFzcz0ic3QwIiBkPSJNMTM5NCw0YzE2LjYsMCwzMCwxMy40LDMwLDMwcy0xMy40LDMwLTMwLDMwcy0zMC0xMy40LTMwLTMwUzEzNzcuNCw0LDEzOTQsNHoiLz4KPHBhdGggY2xhc3M9InN0MSIgZD0iTTE0MjMuNywzOC4xYy0yLDE0LjYtMTQuNSwyNS45LTI5LjcsMjUuOWMtMTYuNiwwLTMwLTEzLjQtMzAtMzBjMC0xMi4zLDcuNS0yMywxOC4xLTI3LjYiLz4KPHBhdGggY2xhc3M9InN0MCIgZD0iTTE0NjIsNGMxNi42LDAsMzAsMTMuNCwzMCwzMHMtMTMuNCwzMC0zMCwzMHMtMzAtMTMuNC0zMC0zMFMxNDQ1LjQsNCwxNDYyLDR6Ii8+CjxwYXRoIGNsYXNzPSJzdDEiIGQ9Ik0xNDg4LjMsNDguNWMtNS4xLDkuMi0xNSwxNS41LTI2LjMsMTUuNWMtMTYuNiwwLTMwLTEzLjQtMzAtMzBjMC0xMy42LDktMjUsMjEuNC0yOC43Ii8+CjxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik0xNTMwLDRjMTYuNiwwLDMwLDEzLjQsMzAsMzBzLTEzLjQsMzAtMzAsMzBzLTMwLTEzLjQtMzAtMzBTMTUxMy40LDQsMTUzMCw0eiIvPgo8cGF0aCBjbGFzcz0ic3QxIiBkPSJNMTU0OS45LDU2LjRjLTUuMyw0LjctMTIuMyw3LjYtMTkuOSw3LjZjLTE2LjYsMC0zMC0xMy40LTMwLTMwYzAtMTQuNywxMC42LTI3LDI0LjYtMjkuNSIvPgo8cGF0aCBjbGFzcz0ic3QwIiBkPSJNMTU5OCw0YzE2LjYsMCwzMCwxMy40LDMwLDMwcy0xMy40LDMwLTMwLDMwcy0zMC0xMy40LTMwLTMwUzE1ODEuNCw0LDE1OTgsNHoiLz4KPHBhdGggY2xhc3M9InN0MSIgZD0iTTE2MTAsNjEuNWMtMy43LDEuNi03LjcsMi41LTEyLDIuNWMtMTYuNiwwLTMwLTEzLjQtMzAtMzBjMC0xNS44LDEyLjItMjguNywyNy42LTI5LjkiLz4KPHBhdGggY2xhc3M9InN0MCIgZD0iTTE2NjYsNGMxNi42LDAsMzAsMTMuNCwzMCwzMHMtMTMuNCwzMC0zMCwzMHMtMzAtMTMuNC0zMC0zMFMxNjQ5LjQsNCwxNjY2LDR6Ii8+CjxwYXRoIGNsYXNzPSJzdDEiIGQ9Ik0xNjY5LjUsNjMuOGMtMS4yLDAuMS0yLjMsMC4yLTMuNSwwLjJjLTE2LjYsMC0zMC0xMy40LTMwLTMwczEzLjQtMzAsMzAtMzBjMC4yLDAsMC40LDAsMC41LDAiLz4KPHBhdGggY2xhc3M9InN0MCIgZD0iTTE3MzQsNGMxNi42LDAsMzAsMTMuNCwzMCwzMHMtMTMuNCwzMC0zMCwzMHMtMzAtMTMuNC0zMC0zMFMxNzE3LjQsNCwxNzM0LDR6Ii8+CjxwYXRoIGNsYXNzPSJzdDEiIGQ9Ik0xNzI5LjMsNjMuNkMxNzE1LDYxLjQsMTcwNCw0OSwxNzA0LDM0YzAtMTYuNiwxMy40LTMwLDMwLTMwYzEuMSwwLDIuMiwwLjEsMy4zLDAuMiIvPgo8cGF0aCBjbGFzcz0ic3QwIiBkPSJNMTgwMiw0YzE2LjYsMCwzMCwxMy40LDMwLDMwcy0xMy40LDMwLTMwLDMwcy0zMC0xMy40LTMwLTMwUzE3ODUuNCw0LDE4MDIsNHoiLz4KPHBhdGggY2xhc3M9InN0MSIgZD0iTTE3OTAuMSw2MS41Yy0xMC43LTQuNi0xOC4xLTE1LjItMTguMS0yNy41YzAtMTYuNiwxMy40LTMwLDMwLTMwYzIsMCwzLjksMC4yLDUuOCwwLjYiLz4KPHBhdGggY2xhc3M9InN0MCIgZD0iTTE4NzAsNGMxNi42LDAsMzAsMTMuNCwzMCwzMHMtMTMuNCwzMC0zMCwzMHMtMzAtMTMuNC0zMC0zMFMxODUzLjQsNCwxODcwLDR6Ii8+CjxwYXRoIGNsYXNzPSJzdDEiIGQ9Ik0xODUyLDU4Yy03LjMtNS41LTEyLTE0LjItMTItMjRjMC0xNi42LDEzLjQtMzAsMzAtMzBjMi44LDAsNS42LDAuNCw4LjIsMS4xIi8+CjxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik0xOTM4LDRjMTYuNiwwLDMwLDEzLjQsMzAsMzBzLTEzLjQsMzAtMzAsMzBzLTMwLTEzLjQtMzAtMzBTMTkyMS40LDQsMTkzOCw0eiIvPgo8cGF0aCBjbGFzcz0ic3QxIiBkPSJNMTkxNS4zLDUzLjZjLTQuNS01LjMtNy4zLTEyLjEtNy4zLTE5LjZjMC0xNi42LDEzLjQtMzAsMzAtMzBjMy42LDAsNy4xLDAuNiwxMC4zLDEuOCIvPgo8cGF0aCBjbGFzcz0ic3QwIiBkPSJNMjAwNiw0YzE2LjYsMCwzMCwxMy40LDMwLDMwcy0xMy40LDMwLTMwLDMwcy0zMC0xMy40LTMwLTMwUzE5ODkuNCw0LDIwMDYsNHoiLz4KPHBhdGggY2xhc3M9InN0MSIgZD0iTTE5NzkuOSw0OC43Yy0yLjUtNC4zLTMuOS05LjMtMy45LTE0LjdjMC0xNi42LDEzLjQtMzAsMzAtMzBjNC40LDAsOC42LDAuOSwxMi4zLDIuNiIvPgo8cGF0aCBjbGFzcz0ic3QwIiBkPSJNMjA3NCw0YzE2LjYsMCwzMCwxMy40LDMwLDMwcy0xMy40LDMwLTMwLDMwcy0zMC0xMy40LTMwLTMwUzIwNTcuNCw0LDIwNzQsNHoiLz4KPHBhdGggY2xhc3M9InN0MSIgZD0iTTIwNDUuNiw0My44Yy0xLTMuMS0xLjYtNi40LTEuNi05LjhjMC0xNi42LDEzLjQtMzAsMzAtMzBjNS4xLDAsOS45LDEuMywxNC4xLDMuNSIvPgo8cGF0aCBjbGFzcz0ic3QwIiBkPSJNMjE0Miw0YzE2LjYsMCwzMCwxMy40LDMwLDMwcy0xMy40LDMwLTMwLDMwcy0zMC0xMy40LTMwLTMwUzIxMjUuNCw0LDIxNDIsNHoiLz4KPHBhdGggY2xhc3M9InN0MSIgZD0iTTIxMTIuNCwzOC45Yy0wLjMtMS42LTAuNC0zLjItMC40LTQuOWMwLTE2LjYsMTMuNC0zMCwzMC0zMGM1LjgsMCwxMS4yLDEuNiwxNS44LDQuNSIvPgo8cGF0aCBjbGFzcz0ic3QwIiBkPSJNMjIxMCw0YzE2LjYsMCwzMCwxMy40LDMwLDMwcy0xMy40LDMwLTMwLDMwcy0zMC0xMy40LTMwLTMwUzIxOTMuNCw0LDIyMTAsNHoiLz4KPHBhdGggY2xhc3M9InN0MSIgZD0iTTIxODAsMzQuM2MwLTAuMSwwLTAuMiwwLTAuM2MwLTE2LjYsMTMuNC0zMCwzMC0zMGM2LjQsMCwxMi40LDIsMTcuMyw1LjUiLz4KPHBhdGggY2xhc3M9InN0MCIgZD0iTTIyNzgsNGMxNi42LDAsMzAsMTMuNCwzMCwzMHMtMTMuNCwzMC0zMCwzMHMtMzAtMTMuNC0zMC0zMFMyMjYxLjQsNCwyMjc4LDR6Ii8+CjxwYXRoIGNsYXNzPSJzdDEiIGQ9Ik0yMjQ4LjMsMzAuMUMyMjUwLjIsMTUuNCwyMjYyLjgsNCwyMjc4LDRjNywwLDEzLjUsMi40LDE4LjYsNi41Ii8+CjxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik0yMzQ2LDRjMTYuNiwwLDMwLDEzLjQsMzAsMzBzLTEzLjQsMzAtMzAsMzBzLTMwLTEzLjQtMzAtMzBTMjMyOS40LDQsMjM0Niw0eiIvPgo8cGF0aCBjbGFzcz0ic3QxIiBkPSJNMjMxNywyNi4zYzMuNC0xMi44LDE1LjEtMjIuMywyOS0yMi4zYzcuNiwwLDE0LjYsMi44LDE5LjksNy41Ii8+CjxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik0yNDE0LDRjMTYuNiwwLDMwLDEzLjQsMzAsMzBzLTEzLjQsMzAtMzAsMzBzLTMwLTEzLjQtMzAtMzBTMjM5Ny40LDQsMjQxNCw0eiIvPgo8cGF0aCBjbGFzcz0ic3QxIiBkPSJNMjM4Ni4xLDIyLjlDMjM5MC41LDExLjgsMjQwMS40LDQsMjQxNCw0YzguMiwwLDE1LjYsMy4zLDIxLDguNiIvPgo8cGF0aCBjbGFzcz0ic3QwIiBkPSJNMjQ4Miw0YzE2LjYsMCwzMCwxMy40LDMwLDMwcy0xMy40LDMwLTMwLDMwcy0zMC0xMy40LTMwLTMwUzI0NjUuNCw0LDI0ODIsNHoiLz4KPHBhdGggY2xhc3M9InN0MSIgZD0iTTI0NTUuNSwyMGM1LTkuNSwxNS0xNiwyNi41LTE2YzguNywwLDE2LjUsMy43LDIyLDkuNiIvPgo8cGF0aCBjbGFzcz0ic3QwIiBkPSJNMjU1MCw0YzE2LjYsMCwzMCwxMy40LDMwLDMwcy0xMy40LDMwLTMwLDMwcy0zMC0xMy40LTMwLTMwUzI1MzMuNCw0LDI1NTAsNHoiLz4KPHBhdGggY2xhc3M9InN0MSIgZD0iTTI1MjUsMTcuNWM1LjMtOC4xLDE0LjUtMTMuNSwyNS0xMy41YzkuMiwwLDE3LjQsNC4xLDIyLjksMTAuNiIvPgo8cGF0aCBjbGFzcz0ic3QwIiBkPSJNMjYxOCw0YzE2LjYsMCwzMCwxMy40LDMwLDMwcy0xMy40LDMwLTMwLDMwcy0zMC0xMy40LTMwLTMwUzI2MDEuNCw0LDI2MTgsNHoiLz4KPHBhdGggY2xhc3M9InN0MSIgZD0iTTI1OTQuNSwxNS4zQzI2MDAsOC40LDI2MDguNSw0LDI2MTgsNGM5LjYsMCwxOC4yLDQuNSwyMy43LDExLjYiLz4KPHBhdGggY2xhc3M9InN0MCIgZD0iTTI2ODYsNGMxNi42LDAsMzAsMTMuNCwzMCwzMHMtMTMuNCwzMC0zMCwzMHMtMzAtMTMuNC0zMC0zMFMyNjY5LjQsNCwyNjg2LDR6Ii8+CjxwYXRoIGNsYXNzPSJzdDEiIGQ9Ik0yNjY0LjEsMTMuNWM1LjUtNS44LDEzLjMtOS41LDIxLjktOS41YzEwLDAsMTksNSwyNC40LDEyLjUiLz4KPHBhdGggY2xhc3M9InN0MCIgZD0iTTI3NTQsNGMxNi42LDAsMzAsMTMuNCwzMCwzMHMtMTMuNCwzMC0zMCwzMHMtMzAtMTMuNC0zMC0zMFMyNzM3LjQsNCwyNzU0LDR6Ii8+CjxwYXRoIGNsYXNzPSJzdDEiIGQ9Ik0yNzMzLjcsMTEuOUMyNzM5LDcsMjc0Ni4yLDQsMjc1NCw0YzEwLjUsMCwxOS43LDUuNCwyNS4xLDEzLjUiLz4KPHBhdGggY2xhc3M9InN0MCIgZD0iTTI4MjIsNGMxNi42LDAsMzAsMTMuNCwzMCwzMHMtMTMuNCwzMC0zMCwzMHMtMzAtMTMuNC0zMC0zMFMyODA1LjQsNCwyODIyLDR6Ii8+CjxwYXRoIGNsYXNzPSJzdDEiIGQ9Ik0yODAzLjIsMTAuNmM1LjEtNC4xLDExLjctNi42LDE4LjgtNi42YzEwLjksMCwyMC40LDUuOCwyNS42LDE0LjQiLz4KPHBhdGggY2xhc3M9InN0MCIgZD0iTTI4OTAsNGMxNi42LDAsMzAsMTMuNCwzMCwzMHMtMTMuNCwzMC0zMCwzMHMtMzAtMTMuNC0zMC0zMFMyODczLjQsNCwyODkwLDR6Ii8+CjxwYXRoIGNsYXNzPSJzdDEiIGQ9Ik0yODcyLjYsOS41YzQuOS0zLjQsMTAuOS01LjUsMTcuNC01LjVjMTEuMiwwLDIxLDYuMiwyNi4yLDE1LjMiLz4KPHBhdGggY2xhc3M9InN0MCIgZD0iTTI5NTgsNGMxNi42LDAsMzAsMTMuNCwzMCwzMHMtMTMuNCwzMC0zMCwzMHMtMzAtMTMuNC0zMC0zMFMyOTQxLjQsNCwyOTU4LDR6Ii8+CjxwYXRoIGNsYXNzPSJzdDEiIGQ9Ik0yOTQyLDguNmM0LjctMi45LDEwLjEtNC42LDE2LTQuNmMxMS42LDAsMjEuNyw2LjYsMjYuNywxNi4yIi8+CjxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik0zMDI2LDRjMTYuNiwwLDMwLDEzLjQsMzAsMzBzLTEzLjQsMzAtMzAsMzBzLTMwLTEzLjQtMzAtMzBTMzAwOS40LDQsMzAyNiw0eiIvPgo8cGF0aCBjbGFzcz0ic3QxIiBkPSJNMzAxMS40LDcuOGM0LjMtMi40LDkuMy0zLjgsMTQuNi0zLjhjMTIsMCwyMi4zLDcsMjcuMSwxNy4xIi8+CjxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik0zMDk0LDRjMTYuNiwwLDMwLDEzLjQsMzAsMzBzLTEzLjQsMzAtMzAsMzBzLTMwLTEzLjQtMzAtMzBTMzA3Ny40LDQsMzA5NCw0eiIvPgo8cGF0aCBjbGFzcz0ic3QxIiBkPSJNMzA4MC42LDcuMWM0LTIsOC42LTMuMSwxMy40LTMuMWMxMi4zLDAsMjIuOSw3LjQsMjcuNSwxOCIvPgo8cGF0aCBjbGFzcz0ic3QwIiBkPSJNMzE2Miw0YzE2LjYsMCwzMCwxMy40LDMwLDMwcy0xMy40LDMwLTMwLDMwcy0zMC0xMy40LTMwLTMwUzMxNDUuNCw0LDMxNjIsNHoiLz4KPHBhdGggY2xhc3M9InN0MSIgZD0iTTMxNDkuOCw2LjZjMy43LTEuNyw3LjgtMi42LDEyLjItMi42YzEyLjYsMCwyMy40LDcuOCwyNy45LDE4LjkiLz4KPHBhdGggY2xhc3M9InN0MCIgZD0iTTMyMzAsNGMxNi42LDAsMzAsMTMuNCwzMCwzMHMtMTMuNCwzMC0zMCwzMHMtMzAtMTMuNC0zMC0zMFMzMjEzLjQsNCwzMjMwLDR6Ii8+CjxwYXRoIGNsYXNzPSJzdDEiIGQ9Ik0zMjE4LjksNi4xYzMuNC0xLjMsNy4yLTIuMSwxMS4xLTIuMWMxMi45LDAsMjQsOC4yLDI4LjIsMTkuNyIvPgo8cGF0aCBjbGFzcz0ic3QwIiBkPSJNMzI5OCw0YzE2LjYsMCwzMCwxMy40LDMwLDMwcy0xMy40LDMwLTMwLDMwcy0zMC0xMy40LTMwLTMwUzMyODEuNCw0LDMyOTgsNHoiLz4KPHBhdGggY2xhc3M9InN0MSIgZD0iTTMyODcuOSw1LjdjMy4yLTEuMSw2LjYtMS43LDEwLjEtMS43YzEzLjIsMCwyNC41LDguNiwyOC41LDIwLjUiLz4KPHBhdGggY2xhc3M9InN0MCIgZD0iTTMzNjYsNGMxNi42LDAsMzAsMTMuNCwzMCwzMHMtMTMuNCwzMC0zMCwzMHMtMzAtMTMuNC0zMC0zMFMzMzQ5LjQsNCwzMzY2LDR6Ii8+CjxwYXRoIGNsYXNzPSJzdDEiIGQ9Ik0zMzU2LjksNS40YzIuOS0wLjksNS45LTEuNCw5LjEtMS40YzEzLjUsMCwyNSw5LDI4LjcsMjEuMyIvPgo8cGF0aCBjbGFzcz0ic3QwIiBkPSJNMzQzNCw0YzE2LjYsMCwzMCwxMy40LDMwLDMwcy0xMy40LDMwLTMwLDMwcy0zMC0xMy40LTMwLTMwUzM0MTcuNCw0LDM0MzQsNHoiLz4KPHBhdGggY2xhc3M9InN0MSIgZD0iTTM0MjUuOCw1LjFjMi42LTAuNyw1LjQtMS4xLDguMi0xLjFjMTMuOCwwLDI1LjUsOS40LDI5LDIyLjEiLz4KPHBhdGggY2xhc3M9InN0MCIgZD0iTTM1MDIsNGMxNi42LDAsMzAsMTMuNCwzMCwzMHMtMTMuNCwzMC0zMCwzMHMtMzAtMTMuNC0zMC0zMFMzNDg1LjQsNCwzNTAyLDR6Ii8+CjxwYXRoIGNsYXNzPSJzdDEiIGQ9Ik0zNDk0LjcsNC45YzIuNC0wLjYsNC44LTAuOSw3LjMtMC45YzE0LjEsMCwyNiw5LjgsMjkuMiwyMi45Ii8+CjxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik0zNTcwLDRjMTYuNiwwLDMwLDEzLjQsMzAsMzBzLTEzLjQsMzAtMzAsMzBzLTMwLTEzLjQtMzAtMzBTMzU1My40LDQsMzU3MCw0eiIvPgo8cGF0aCBjbGFzcz0ic3QxIiBkPSJNMzU2My42LDQuN2MyLjEtMC41LDQuMi0wLjcsNi40LTAuN2MxNC40LDAsMjYuNCwxMC4yLDI5LjMsMjMuNyIvPgo8cGF0aCBjbGFzcz0ic3QwIiBkPSJNMzYzOCw0YzE2LjYsMCwzMCwxMy40LDMwLDMwcy0xMy40LDMwLTMwLDMwcy0zMC0xMy40LTMwLTMwUzM2MjEuNCw0LDM2MzgsNHoiLz4KPHBhdGggY2xhc3M9InN0MSIgZD0iTTM2MzIuNCw0LjVjMS44LTAuMywzLjctMC41LDUuNi0wLjVjMTQuNywwLDI2LjksMTAuNiwyOS41LDI0LjUiLz4KPHBhdGggY2xhc3M9InN0MCIgZD0iTTM3MDYsNGMxNi42LDAsMzAsMTMuNCwzMCwzMHMtMTMuNCwzMC0zMCwzMHMtMzAtMTMuNC0zMC0zMFMzNjg5LjQsNCwzNzA2LDR6Ii8+CjxwYXRoIGNsYXNzPSJzdDEiIGQ9Ik0zNzAxLjMsNC40YzEuNS0wLjMsMy4xLTAuNCw0LjctMC40YzE1LDAsMjcuNCwxMSwyOS42LDI1LjMiLz4KPHBhdGggY2xhc3M9InN0MCIgZD0iTTM3NzQsNGMxNi42LDAsMzAsMTMuNCwzMCwzMHMtMTMuNCwzMC0zMCwzMHMtMzAtMTMuNC0zMC0zMFMzNzU3LjQsNCwzNzc0LDR6Ii8+CjxwYXRoIGNsYXNzPSJzdDEiIGQ9Ik0zNzcwLjEsNC4zYzEuMi0wLjIsMi42LTAuMywzLjktMC4zYzE1LjIsMCwyNy44LDExLjQsMjkuNywyNi4xIi8+CjxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik0zODQyLDRjMTYuNiwwLDMwLDEzLjQsMzAsMzBzLTEzLjQsMzAtMzAsMzBzLTMwLTEzLjQtMzAtMzBTMzgyNS40LDQsMzg0Miw0eiIvPgo8cGF0aCBjbGFzcz0ic3QxIiBkPSJNMzgzOC45LDQuMmMxLTAuMSwyLTAuMiwzLjEtMC4yYzE1LjUsMCwyOC4zLDExLjgsMjkuOCwyNi45Ii8+CjxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik0zOTEwLDRjMTYuNiwwLDMwLDEzLjQsMzAsMzBzLTEzLjQsMzAtMzAsMzBzLTMwLTEzLjQtMzAtMzBTMzg5My40LDQsMzkxMCw0eiIvPgo8cGF0aCBjbGFzcz0ic3QxIiBkPSJNMzkwNy42LDQuMWMwLjgtMC4xLDEuNi0wLjEsMi40LTAuMWMxNS44LDAsMjguNywxMi4yLDI5LjksMjcuNiIvPgo8cGF0aCBjbGFzcz0ic3QwIiBkPSJNMzk3OCw0YzE2LjYsMCwzMCwxMy40LDMwLDMwcy0xMy40LDMwLTMwLDMwcy0zMC0xMy40LTMwLTMwUzM5NjEuNCw0LDM5NzgsNHoiLz4KPHBhdGggY2xhc3M9InN0MSIgZD0iTTM5NzYuNCw0YzAuNSwwLDEuMSwwLDEuNiwwYzE2LDAsMjkuMSwxMi42LDMwLDI4LjQiLz4KPHBhdGggY2xhc3M9InN0MCIgZD0iTTQwNDYsNGMxNi42LDAsMzAsMTMuNCwzMCwzMHMtMTMuNCwzMC0zMCwzMHMtMzAtMTMuNC0zMC0zMFM0MDI5LjQsNCw0MDQ2LDR6Ii8+CjxwYXRoIGNsYXNzPSJzdDEiIGQ9Ik00MDQ1LjIsNGMwLjMsMCwwLjUsMCwwLjgsMGMxNi4zLDAsMjkuNiwxMywzMCwyOS4yIi8+Cjwvc3ZnPgo="},692:function(e,t,i){var n,r;n=[i(9),i(2),i(11),i(13),i(37),i(33),i(716),i(111),i(204),i(65)],void 0===(r=function(e,t,i,n,r,o,a,s,c,l){"use strict";var u,d,h=c.default,g=l.default;return u=i.Model.extend({initialize:function(){this._sessionsById={}},_getBatonController:function(){return new a},_getBrandKit:function(){return s},_checkEntitlement:function(e,i){var n=o.hasFeature("entitle-brand-kit"),r=e.getMyApp();return t.all([r.isBranded(e),r.hasPremiumIngredients(e)]).spread(function(o,a){return i.known.docIsBranded=o,i.known.docHasPremiumIngredients=a,"video"==r.typeName&&o&&!r.getAuthoringContextId(e)||!o&&!a||n||(i.known.unentitled=!0),t.resolve(!i.known.unentitled)}.bind(this))},_createEditingSession:function(e,i){return{batonEnabled:e,collabEnabled:i,deferInterstitial:t.defer(),batonController:this._getBatonController(),known:{},activity:{}}},mockDocEditingSession:function(i,n){var r=this._createEditingSession(n.batonEnabled,n.collabEnabled);r.known.userEntitled=n.entitled,n.missingBrand?r.known.missingBrand=!0:n.missingFonts&&(r.known.missingFonts=!0,s.getController().then((function(t){var n=i.getMyApp().getAuthoringContextId(i);return t.getContextById(n).then((function(t){r.known.missingFontList=t?e.filter(t.getAllFonts(!0),(function(e){return e.isCustomFont()})):[]}))})).done()),n.batonFailedClean?(r.known.hasBaton=!1,r.known.lockHeldByUserInfo={displayName:"Mock User"}):n.batonFailedDirty?(r.known.hasBaton=!1,r.known.batonServiceFailed=!0,r.known.batonServiceError=new Error("some error from baton service")):n.hasBaton&&(r.known.hasBaton=!0),n.serviceFailed&&(r.known.serviceBorked=!0),this._sessionsById[i.id]=r,r.entitlementPromise=t.resolve(n.entitled),r.entitlementPromise.then(function(){this._updateUX(r)}.bind(this))},_doVerifyBrand:function(e,i){return this._getBrandKit().verifyBrandAccess(e,i.known.docIsBranded).then(function(n){var r=[h.REQUEST_ACCESS.PREVIOUS_REQUEST_DENIED,h.REQUEST_ACCESS.REQUEST_ALREADY_EXISTS,h.REQUEST_ACCESS.REQUEST_BLOCKED_BY_POLICY_RESTRICTION,h.REQUEST_ACCESS.REQUEST_ACCESS_SUCCESS,h.REQUEST_ACCESS.UNDEFINED_STATUS];if(!n||!n.accessOk||!n.brand&&i.known.docIsBranded){i.known.missingBrand=!0;var o=e.getMyApp().getAuthoringContextUrn(e);return i.known.brandURN=o,n.requestAccessFlowStatus&&r.includes(n.requestAccessFlowStatus)||g.isCCEverywhereEmbedded()&&n.requestAccessFlowStatus===h.REQUEST_ACCESS.CONTINUE_WITHOUT_BRAND||window.marvel.events.trigger("associated-brand-missing",{doc:e}),this._updateUX(i),t.resolve(!1)}return n.switchedToDefaultBrand&&(n.requestAccessFlowStatus&&n.requestAccessFlowStatus===h.REQUEST_ACCESS.CONTINUE_WITHOUT_BRAND||(i.known.switchedToDefaultBrandCb=function(){window.marvel.events.trigger("associated-brand-missing",{doc:e})}),this._updateUX(i)),this._getBrandKit().verifyFontAccess(e,n.brand).then(function(e){return e.length>0?(i.known.missingFonts=!0,i.known.missingFontList=e,this._updateUX(i),t.resolve(!1)):(i.known.brandAndFontsOk=!0,this._updateUX(i),t.resolve(!0))}.bind(this))}.bind(this)).catch(function(e){return i.known.serviceBorked=!0,i.known.serviceBorkedMsg="Failed while validating project",i.known.serviceBorkedError=e,this._updateUX(i),t.reject(e)}.bind(this))},_doAcquireBaton:function(e,i){var n=e.getMyApp().getSetting("syncGroup"),r=e.id,o=e.getProjectName(),a=e.getURN();return i.fnOnLeftEditor=function(t){this._sessionsById[r]&&this.releaseBatonAndCloseSession(e)}.bind(this),window.marvel.events.on("left-editing-session",i.fnOnLeftEditor),i.fnOnUnload=function(e){if(i.batonEnabled&&i.batonRequestPromise)return i.batonController.releaseLockOnWindowUnload()},window.addEventListener("unload",i.fnOnUnload),a.then(function(a){return i.batonController.acquireBatonLock(n,r,o,a).then(function(t){return t&&t.virtualBaton&&(i.known.virtualBaton=!0,i.fnUpgradeSession=function(t){var n=this._sessionsById[r];n&&n.known.virtualBaton&&(n.known.userKnows=!1,n.known.virtualBaton=!1,n.batonController.releaseBatonLockAndConnection().then(function(){n.batonRequestPromise=this._doAcquireBaton(e,i),this._updateUX(n),window.marvel.logger.info("Upgrading from virtual baton",{rootObjectId:r})}.bind(this)))}.bind(this),window.marvel.events.on("upgrade-editing-session",i.fnUpgradeSession)),i.known.hasBaton=!0,this._updateUX(i),t}.bind(this),function(e){return i.known.hasBaton=!1,e.lockHeldByUser?i.known.lockHeldByUserId=e.lockHeldByUser:(i.known.batonServiceFailed=!0,i.known.batonServiceError=e),this._updateUX(i),t.reject(e)}.bind(this))}.bind(this))},_awaitEditingSessionDone:function(i){return i.entitlementPromise.then(function(){var n=[i.verifyBrandPromise];return i.batonRequestPromise&&n.push(i.batonRequestPromise),t.allSettled(n).then(function(n){return e.each(n,function(e){"fulfilled"!==e.state&&(e.reason.toString().indexOf("BATON_LOCK_FAILED")>=0?i.known.lockHeldByUserInfo||(i.known.batonServiceFailed=!0,i.known.batonServiceError=e.reason,this._updateUX(i)):window.marvel.logger.debug("EditingSessionDone assuming error is already handled",e.reason))}.bind(this)),window.marvel.events.trigger("editing-session-preflight-complete",i),t.resolve(i)}.bind(this))}.bind(this))},getDocEditingSession:function(e){var i=e.id,n=e.getMyApp().supportsCollaboration(),r=e.getMyApp().requiresDocumentLocking(e),a=this._sessionsById[i];if(!a){if(o.hasFeature("enable-mock-editing-session"))try{var s=window.sessionStorage.getItem("marvel_mock_editing_session");if(s)return s=JSON.parse(s),window.marvel.logger.warn("[using editing session] ->",s),d.mockDocEditingSession(e,s),this._sessionsById[i]}catch(c){window.marvel.logger.warn("caught error in mock editing session",c)}a=this._createEditingSession(r,n),this._sessionsById[i]=a,a.entitlementPromise=this._checkEntitlement(e,a).then(function(i){return a.known.userEntitled=i,a.known.userEntitled?(a.verifyBrandPromise=this._doVerifyBrand(e,a),n&&r?a.batonRequestPromise=this._doAcquireBaton(e,a):(a.known.hasBaton=!0,a.known.virtualBaton=!0,a.batonRequestPromise=t.resolve(),this._updateUX(a))):this._updateUX(a),i}.bind(this),function(e){window.marvel.logger.error("editing-session: failed while checking entitlement",e),a.known.serviceBorked=!0,a.known.serviceBorkedMsg="Failed to check entitlements",a.known.serviceBorkedError=e,this._updateUX(a)}.bind(this)).catch(function(e){window.marvel.logger.error("editing-session: error caught while checking entitlement",e),a.known.serviceBorked=!0,a.known.serviceBorkedMsg="Failed while validating project",a.known.serviceBorkedError=e,this._updateUX(a)}.bind(this)),a.donePromise=this._awaitEditingSessionDone(a)}return a},_leaveInterstitial:function(e,t){e.deferInterstitial.resolve(),t&&(window.history.length>2?window.history.back():window.marvel.navigate("/",{trigger:!0}))},_updateUX:function(e){if(e&&e._ux){var t=e.activity,i=e.known,n=e._ux;if(window.marvel.logger.traceflow("editingsession","[EditingSession:updateUX]",{known:e.known}),t.inactivityTimeout)n.inactiveTimeout&&n.inactiveTimeout(e);else if(!i.userKnows)if(i.serviceBorked)i.userKnows=!0,n.serviceBorked(i.serviceBorkedError);else if(!1===i.userEntitled)i.interstitialReadyToHide&&(i.userKnows=!0,n.unentitled(),e.deferInterstitial.resolve());else if(!1!==i.hasBaton||i.ignoreBatonServiceError){if(!0===i.hasBaton||i.ignoreBatonServiceError)if(i.missingBrand){i.userKnows=!0;var r=e.known.brandURN;n.missingBrand(r).then(function(){this._leaveInterstitial(e,!1)}.bind(this)).done()}else i.missingFonts&&i.interstitialReadyToHide?(i.userKnows=!0,e.deferInterstitial.resolve(),n.missingFonts(i.missingFontList).then((function(t){t||(window.history.length>2?window.history.back():window.marvel.navigate("/",{trigger:!0})),n.editing&&n.editing(e)}))):i.brandAndFontsOk&&i.interstitialReadyToHide?(i.userKnows=!0,e.deferInterstitialResolved||(e.deferInterstitial.resolve(),e.deferInterstitialResolved=!0),n.editing&&n.editing(e)):i.switchedToDefaultBrandCb&&i.switchedToDefaultBrandCb()}else i.batonServiceFailed?i.interstitialReadyToHide&&(i.userKnows=!0,n.batonServiceFailed(i.batonServiceError).then(function(t){t?(i.ignoreBatonServiceError=!0,i.userKnows=!1,this._updateUX(e)):this._leaveInterstitial(e,!0)}.bind(this))):(i.userKnows=!0,e.batonController.lockHeldByUserInfoFromClientId(i.lockHeldByUserId).then(function(t){i.lockHeldByUserInfo=t,n.batonNotAcquired(t).then(function(){this._leaveInterstitial(e,!0)}.bind(this)).done()}.bind(this)).done())}},setUXHandler:function(e,t){var i=this.getDocEditingSession(e);i?(i._ux=t,this._updateUX(i)):window.marvel.logger.warn("failed to acquire EditingSession for doc",e)},inactivityTimeout:function(e){var t=this._sessionsById[e.id];t&&(navigator.onLine?(t.activity.inactivityTimeout=!0,t.activity.lockReleaseDelayTimer=window.setTimeout(function(){t.activity.lockReleaseDelayTimer=0,this.stopInactivityMonitoring(e,t),t.batonController.justReleaseBatonLock()}.bind(this),t.activity.LOCK_RELEASE_TIMEOUT),this._updateUX(t)):this.stopInactivityMonitoring(e,t))},_establishTimeouts:function(e){e.activity.INACTIVE_TIMEOUT=6e5,e.activity.LOCK_RELEASE_TIMEOUT=18e4,o.hasFeature("inactivity-timeout-15-seconds")&&(e.activity.INACTIVE_TIMEOUT=15e3,e.activity.LOCK_RELEASE_TIMEOUT=15e3)},beginSession:function(e,t){if(t.known.virtualBaton)window.marvel.events.trigger("collaboration-state",{enabled:!1});else{var i=t.activity;i.inactiveTimer?window.marvel.logger.warn("User inactiveTimer already exists!?"):(this._establishTimeouts(t),i.inLongUserActivity=0,i._fnTimeout=function(){window.marvel.logger.traceflow("baton-timeout","User inactive, timeout."),i.inactiveTimer=null,d.inactivityTimeout(e)},i.fnUserIsActive=function(e){i.inactiveTimer&&(window.clearTimeout(i.inactiveTimer),i.inactiveTimer=null),0===i.inLongUserActivity?(window.marvel.logger.traceflow("baton-timeout","userIsActive - starting or restarting timer"),i.inactiveTimer=window.setTimeout(i._fnTimeout,i.INACTIVE_TIMEOUT)):window.marvel.logger.traceflow("baton-timeout","userIsActive - ignored within long user activity begin/end pair")},i.fnBeginLongUserActivity=function(){i.inactiveTimer&&(window.clearTimeout(i.inactiveTimer),i.inactiveTimer=null),i.inLongUserActivity+=1,1===i.inLongUserActivity&&window.marvel.logger.traceflow("long-user-activity","Long user activity - STARTED"),window.marvel.logger.traceflow("baton-timeout","beginLongUserActivity - inLongUserActivity = "+i.inLongUserActivity)},i.fnEndLongUserActivity=function(t){i.inLongUserActivity-=1,window.marvel.logger.traceflow("baton-timeout",'endLongUserActivity - reason "'+t+'" inLongUserActivity reduced to '+i.inLongUserActivity),i.inLongUserActivity<0?window.marvel.logger.error('endLongUserActivity - reason "'+t+'" inLongUserActivity reduced to '+i.inLongUserActivity):0===i.inLongUserActivity&&window.marvel.logger.traceflow("long-user-activity","Long user activity - COMPLETE"),"release-lock"===t?(r.trackEvent("coediting:releasedLockAfterLongUserAction",{sparkFormat:e.getMyApp().typeName},"coediting"),d.releaseBatonAndCloseSession(e)):i.fnUserIsActive()},this.startInactivityMonitoring(e,t),window.marvel.events.trigger("collaboration-state",{enabled:!0,timeoutDuration:i.INACTIVE_TIMEOUT}))}},startInactivityMonitoring:function(e,t){var i=t.activity;i.inactiveTimer=window.setTimeout(i._fnTimeout,i.INACTIVE_TIMEOUT),e.getMyApp().onEditorActive(i.fnUserIsActive,i.fnBeginLongUserActivity,i.fnEndLongUserActivity)},stopInactivityMonitoring:function(e,t){var i=t.activity;i.fnUserIsActive&&e.getMyApp().offEditorActive(i.fnUserIsActive),i.inactiveTimer&&(window.clearTimeout(i.inactiveTimer),i.inactiveTimer=null)},endSession:function(e,t){this.stopInactivityMonitoring(e,t)},reviveSession:function(e,i){if(i.activity.lockReleaseDelayTimer)return r.trackEvent("coediting:stillWorkingPressedQuickly",{sparkFormat:e.getMyApp().typeName},"coediting"),window.clearTimeout(i.activity.lockReleaseDelayTimer),i.activity.lockReleaseDelayTimer=0,t.resolve(!0);r.trackEvent("coediting:stillWorkingPressedEventually",{sparkFormat:e.getMyApp().typeName},"coediting");var n=t.defer(),o=e.getMyApp().getSetting("syncGroup"),a=e.id,s=e.getProjectName();return e.getURN().then((function(t){i.batonController.acquireBatonLock(o,a,s,t).then(function(){e.hasCloudDocChanged().then(function(t){t?n.resolve(!1):(this.startInactivityMonitoring(e,i),n.resolve(!0))}.bind(this)).catch((function(e){window.marvel.logger.error("hasCloudDocChanged returned error",e),n.resolve(!1)}))}.bind(this)).catch((function(e){window.marvel.logger.error("acquireBatonLock returned error",e),n.resolve(!1)}))})),n.promise},editingPreflightComplete:function(e){if(!e)return t.resolve();var i=this._sessionsById[e.id];return i?i.donePromise:t.reject(new Error("editingPreflightComplete called without an active editing session"))},interstitialReadyToHide:function(e){if(!e)return t.resolve();var i=this._sessionsById[e.id];return i?(i.known.interstitialReadyToHide=!0,this._updateUX(i),i.deferInterstitial.promise):t.reject("No editing session")},releaseBatonAndCloseSession:function(e){if(!e)return t.resolve();var i=this._sessionsById[e.id];return i&&this.removeDocEditingSession(e),i&&i.batonEnabled&&i.batonRequestPromise?i.batonController.releaseBatonLockAndConnection():t.resolve()},removeDocEditingSession:function(e){if(e){var t=this._sessionsById[e.id];t&&(t.fnOnLeftEditor&&(window.marvel.events.off("left-editing-session",t.fnOnLeftEditor),t.fnOnLeftEditor=null),t.fnOnUnload&&(window.removeEventListener("unload",t.fnOnUnload),t.fnOnUnload=null),t.fnUpgradeSession&&(window.marvel.events.off("upgrade-editing-session",t.fnUpgradeSession),t.fnUpgradeSession=null),t._ux&&t._ux.cleanup&&t._ux.cleanup(t),delete this._sessionsById[e.id])}}}),d=new u}.apply(t,n))||(e.exports=r)},693:function(e,t,i){var n,r;n=[i(9),i(11)],void 0===(r=function(e,t){"use strict";return{LibraryImageModel:t.Model.extend({getImage:function(){if(this.collection){var e=this.collection.images;if(e)return e.get(this.get("image_id"))}return null},getImageURL:function(){var e=this.getImage();return e?e.get("image_url"):this.get("image_url")||""},getPreviewURL:function(){return this.getImageURL()},getThumbURL:function(){return this.getImageURL()}}),LibraryImageLinksModel:t.Model.extend({getImageURL:function(){return this.get("image_url")||""},getPreviewURL:function(){return this.get("preview_url")||""},getThumbURL:function(){return this.get("thumb_url")||""},getImageSize:function(){return this.get("image_size")||void 0},getPreviewSize:function(){return this.get("preview_size")||void 0},getThumbSize:function(){return this.get("thumb_size")||void 0}})}}.apply(t,n))||(e.exports=r)},696:function(e,t,i){var n,r;n=[i(16),i(9),i(2),i(11),i(697)],void 0===(r=function(e,t,i,n,r){"use strict";return n.View.extend({events:{},initialize:function(){t.bindAll(this,t.functionsIn(this))},setupProgress:function(e){this.$el=e.el$||this.$el,this.text$=e.text$,this.itemsAdded=e.itemsAdded||0,this.itemsResolved=e.itemsResolved||0,this.pct=e.pct||0,this._eventNames=e.eventNames,this.initialText=e.initialText},render:function(){this.$el.html(r.toString()),this._eventNames&&this._eventNames.updateText&&(marvel.events.on(this._eventNames.updateText,this._handleProgressUpdateText),this.text$&&""===this.text$.text()&&this.text$.html("&nbsp;")),this.progress$=this.$el.find(".progress-bar-fill"),this.initialText&&this.setText(this.initialText),this._eventNames&&this._eventNames.setPct?(this._setProgressPercent(this.pct),marvel.events.on(this._eventNames.setPct,this._handleProgressSetPct)):(this._setProgressPercent(this.itemsResolved/this.itemsAdded),this._eventNames&&this._eventNames.add&&marvel.events.on(this._eventNames.add,this._handleProgressItemAdded),this._eventNames&&this._eventNames.resolved&&marvel.events.on(this._eventNames.resolved,this._handleProgressItemResolved))},_setProgressPercent:function(e){e>1?e=1:e<0&&(e=0),this.pct=e,this.progress$.css("transform","scaleX("+this.pct+")")},_updateProgressPercent:function(){var e=this.itemsResolved/this.itemsAdded;this._setProgressPercent(e)},_handleProgressItemAdded:function(e){this.itemsAdded+=e||1,this._updateProgressPercent()},_handleProgressItemResolved:function(e){this.itemsResolved+=e||1,this._updateProgressPercent()},_handleProgressSetPct:function(e){this.pct=e,this._setProgressPercent(e)},setText:function(e){this._handleProgressUpdateText(e)},_handleProgressUpdateText:function(e){this.text$&&((e=e||"").jquery?(this.text$.html(""),this.text$.append(e)):this.text$.text(e))},hide:function(){this._eventNames.add&&marvel.events.off(this._eventNames.add,this._handleProgressItemAdded),this._eventNames.resolved&&marvel.events.off(this._eventNames.resolved,this._handleProgressItemResolved),this._eventNames.setPct&&marvel.events.off(this._eventNames.setPct,this._handleProgressSetPct),this._eventNames.updateText&&marvel.events.off(this._eventNames.updateText,this._handleProgressUpdateText)}})}.apply(t,n))||(e.exports=r)},697:function(e,t){e.exports='<div class="progress-bar-view">\n    <div class="progress-bar-bg">\n        <div class="progress-bar-fill"></div>\n    </div>\n</div>\n'},698:function(e,t){e.exports='<div class="confirm-view-bg mrvl-overlay-overlay-bg">\n</div>\n<div class="confirm-view-shell mrvl-overlay-shell" data-auto="confirm-view-shell">\n    <h2 class="confirm-view-dialog-title dialog-title" data-auto="confirm-view-title">{{confirm-view-default-title}}</h2>\n    <div class="confirm-view-content-shell mrvl-overlay-content-shell">\n        <div class="confirm-main-content">\n            <div class="confirm-view-content mrvl-overlay-content">\n                <div class="confirm-view-thumbnail"></div>\n                <div class="confirm-progress-bar" data-auto="confirm-progress-bar"></div>\n                <div class="wait-spinner" data-auto="wait-spinner"></div>\n                <div class="wait-success"></div>\n                <p class="confirm-view-dialog-text" data-auto="confirm-view-text"></p>\n                <a class="confirm-view-link" target="_blank"><u>{{legal-dialog-content-for-cceverywhere}}</u></a>\n                <div class="confirm-view-prompt-field-area hide">\n                    <input class="confirm-view-prompt-field" data-auto="confirm-view-prompt-field">\n                </div>\n            </div>\n\n            <div class="mrvl-dlg-btn-acts">\n                <label class="confirm-view-checkbox">\n                    <input type="checkbox" class="confirm-view-checkbox-input">\n                    <span class="confirm-view-checkbox-label"></span>\n                </label>\n                <div class="sp-cta-button-secondary" data-auto="cancel-btn">{{confirm-view-default-verb-cancel}}</div>\n                <div class="sp-cta-button-primary confirm-btn-0" data-auto="confirm-btn">{{confirm-view-default-verb-ok}}</div>\n                <div class="sp-cta-button-primary confirm-btn-1 hide" data-auto="confirm-btn-1">{{confirm-view-default-verb-ok}}</div>\n                <div class="sp-cta-button-primary confirm-btn-2 hide" data-auto="confirm-btn-2">{{confirm-view-default-verb-ok}}</div>\n            </div>\n        </div>\n    </div>\n    <button class="confirm-view-close-btn x-close-btn">X</button>\n</div>\n'},699:function(e,t,i){var n=i(700);"string"==typeof n&&(n=[[e.i,n,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};i(298)(n,r);n.locals&&(e.exports=n.locals)},700:function(e,t,i){var n=i(331);(e.exports=i(297)(!1)).push([e.i,".sp-cta-button-primary,.sp-cta-button-secondary{height:32px;border-radius:24px;font-size:15px;font-weight:700;line-height:30px;padding:0 16px;min-width:75px;text-align:center;cursor:pointer;transition:background-color .3s,color .3s}.sp-cta-button-primary.link,.sp-cta-button-secondary.link{text-decoration:none;line-height:32px}.sp-cta-button-primary.disabled,.sp-cta-button-secondary.disabled{background-color:rgba(130,145,155,.09);color:#d8dde0}.sp-cta-button-primary.disabled:active,.sp-cta-button-primary.disabled:hover,.sp-cta-button-secondary.disabled:active,.sp-cta-button-secondary.disabled:hover{cursor:default;background-color:rgba(130,145,155,.09)}.sp-cta-button-primary{color:#fff;background-color:var(--link-color)}.sp-cta-button-primary:hover{background-color:var(--link-hover-color)}.sp-cta-button-primary:active{background-color:var(--link-active-color)}.sp-cta-button-secondary{color:#242424;background-color:transparent;border:2px solid #d4d4d4;line-height:28px;transition:background-color .3s,color .3s,border-color .3s}.sp-cta-button-secondary:active,.sp-cta-button-secondary:hover{border-color:#242424}.sp-cta-button-secondary.over-dark,.sp-cta-button-secondary.over-dark-photo{color:#b6b6b6;border-color:#b6b6b6}.sp-cta-button-secondary.over-dark-photo.over-dark-photo,.sp-cta-button-secondary.over-dark.over-dark-photo{color:#fff;border-color:#fff}.sp-cta-button-secondary.over-dark-photo:hover,.sp-cta-button-secondary.over-dark:hover{color:#444;background-color:#b6b6b6}.sp-cta-button-secondary.over-dark-photo:hover.over-dark-photo,.sp-cta-button-secondary.over-dark:hover.over-dark-photo{background-color:#fff}.sp-cta-button-secondary.over-dark-photo:active,.sp-cta-button-secondary.over-dark:active{background-color:#444;border-color:#444;color:#fff}.sp-cta-button-secondary.over-dark-photo{color:#fff;border:2px solid #fff}.sp-cta-button-secondary.over-dark-photo:hover{color:#444;background-color:#fff}.sp-cta-button-secondary.over-dark-photo:active{background-color:#444;border-color:#444;color:#fff}.mrvl-dlg-btn-acts .sp-cta-button-primary,.mrvl-dlg-btn-acts .sp-cta-button-secondary{margin-left:5px;margin-right:5px}.mrvl-dlg-btn-acts .sp-cta-button-primary:first-child,.mrvl-dlg-btn-acts .sp-cta-button-secondary:first-child{margin-left:0}.mrvl-dlg-btn-acts .sp-cta-button-primary:last-child,.mrvl-dlg-btn-acts .sp-cta-button-secondary:last-child{margin-right:0}.mrvl-overlay-overlay-bg{z-index:106;position:fixed;left:0;right:0;top:0;bottom:0;background-color:rgba(0,0,0,.8)}.mrvl-overlay-shell{z-index:106;position:fixed;background-color:#fff;border-radius:10px;width:580px;height:500px;top:50%;left:50%;-webkit-transform:translateX(-50%) translateY(-50%);transform:translateX(-50%) translateY(-50%)}.mrvl-overlay-shell .marvel-overlay-shell-content{background-color:#fff;border-radius:5px;position:absolute;top:30px;bottom:0;width:100%}.mrvl-overlay-shell .mrvl-overlay-content-shell{padding:30px 30px 25px}.mrvl-overlay-shell .mrvl-overlay-content{margin-bottom:80px}.mrvl-overlay-shell .mrvl-overlay-content p{font-size:1.38em;font-weight:400;line-height:1.5;color:#444;word-wrap:break-word}.mrvl-overlay-shell .dialog-title{font-size:2em;font-weight:700;background-color:#f2f4f5;text-align:left;color:#444;margin:0;padding:20px 25px;border-top-left-radius:10px;border-top-right-radius:10px}.mrvl-overlay-shell h2{font-size:2.4em;color:#484848}.mrvl-overlay-shell h2,.mrvl-overlay-shell h3{font-weight:300;text-align:center;margin:30px 0 16px}.mrvl-overlay-shell h3{font-size:1.8em;color:#666}.mrvl-overlay-shell .x-close-btn{position:absolute;right:20px;top:20px;background-color:transparent;border:none;outline:none;color:#999;cursor:pointer;font-size:1.4em}.mrvl-overlay-shell .cancel-btn,.mrvl-overlay-shell .done-btn{background-color:transparent;color:#ccc;border:1px solid #ccc}.mrvl-overlay-shell .mrvl-dlg-btn-acts{position:absolute;bottom:27px;text-align:right;right:25px;width:100%}.mrvl-overlay-shell .mrvl-dlg-btn-acts .cancel-btn{background-color:#9aa6af}.mrvl-overlay-shell .mrvl-dlg-btn-acts .cancel-btn:hover{background-color:#82919b}.mrvl-overlay-shell .mrvl-dlg-btn-acts .confirm-btn{background-color:#5c5ce0}.mrvl-overlay-shell .mrvl-dlg-btn-acts .confirm-btn:hover{background-color:#4646c6}.mrvl-overlay-shell .mrvl-dlg-btn-acts .confirm-btn a{color:#fff;background-color:#5c5ce0}.mrvl-overlay-shell .mrvl-dlg-btn-acts .confirm-btn:hover a,.mrvl-overlay-shell .mrvl-dlg-btn-acts .confirm-btn a:hover{background-color:#4646c6}.mrvl-overlay-shell .mrvl-dlg-btn-acts .cancel-btn,.mrvl-overlay-shell .mrvl-dlg-btn-acts .confirm-btn,.mrvl-overlay-shell .mrvl-dlg-btn-acts .done-btn{padding:10px 16px;color:#fff;text-decoration:none;border-radius:40px;font-weight:700;font-size:1.23em;margin:0;line-height:1;height:36px;border:0}@-moz-document url-prefix(){.mrvl-overlay-shell .mrvl-dlg-btn-acts .cancel-btn,.mrvl-overlay-shell .mrvl-dlg-btn-acts .confirm-btn,.mrvl-overlay-shell .mrvl-dlg-btn-acts .done-btn{line-height:-moz-block-height!important}}.mrvl-overlay-shell .mrvl-dlg-btn-acts .mrvl-btn{display:inline-block;margin:0 5px;overflow:hidden;position:relative}.mrvl-overlay-shell .mrvl-dlg-btn-acts .mrvl-btn:last-child{margin-right:0}.mrvl-overlay-shell.short{height:250px}.mrvl-overlay-shell .flag-toggle{width:62px;height:28px;cursor:pointer;display:inline-block;position:relative}.mrvl-overlay-shell .flag-toggle.selected .toggle-values{left:0}.mrvl-overlay-shell .flag-toggle.selected .toggle-handle{left:33px}.mrvl-overlay-shell .flag-toggle:not(.selected) .toggle-handle{left:-3px}.mrvl-overlay-shell .flag-toggle .toggle-handle,.mrvl-overlay-shell .flag-toggle .toggle-values{transition-property:left;transition:left .19s linear;transition-duration:.19s;transition-timing-function:linear;transition-delay:0s}.mrvl-overlay-shell .flag-toggle .toggle-values{width:116px;height:24px;position:absolute;z-index:0;left:-58px}.mrvl-overlay-shell .flag-toggle .toggle-values .toggle-values-off,.mrvl-overlay-shell .flag-toggle .toggle-values .toggle-values-on{width:58px;line-height:24px;text-transform:uppercase;display:inline-block;font-size:11px;font-weight:700}.mrvl-overlay-shell .flag-toggle .toggle-values .toggle-values-off.toggle-values-on,.mrvl-overlay-shell .flag-toggle .toggle-values .toggle-values-on.toggle-values-on{background-color:var(--link-color);text-align:left;color:var(--link-color);padding-left:10px}.mrvl-overlay-shell .flag-toggle .toggle-values .toggle-values-off.toggle-values-off,.mrvl-overlay-shell .flag-toggle .toggle-values .toggle-values-on.toggle-values-off{background-color:#b6b6b6;text-align:right;color:#b6b6b6;padding-right:10px}.mrvl-overlay-shell .flag-toggle .toggle-mask{position:absolute;overflow:hidden;width:58px;height:24px;z-index:1;top:2px}.mrvl-overlay-shell .flag-toggle .toggle-mask .toggle-values-image-mask{position:absolute;top:0;left:0;width:58px;height:24px;z-index:1;background-image:url("+n(i(685))+');background-size:cover}.mrvl-overlay-shell .flag-toggle .toggle-handle{height:28px;width:28px;border-radius:14px;background-color:#e8e8e8;position:absolute;z-index:2}.mrvl-overlay-shell .flag-toggle .toggle-handle .dot{background-color:#e8e8e8;width:6px;height:6px;border-radius:3px;position:absolute;left:50%;top:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}.confirm-overlay .confirm-view-bg,.confirm-overlay .index-progress-view-bg,.confirm-overlay .move-view-bg{z-index:10001}.confirm-overlay .confirm-view-bg.transparent-overlay,.confirm-overlay .index-progress-view-bg.transparent-overlay,.confirm-overlay .move-view-bg.transparent-overlay{background-color:transparent}.confirm-overlay .confirm-view-shell,.confirm-overlay .index-progress-view-shell,.confirm-overlay .move-view-shell{width:inherit;height:auto;min-width:440px;min-height:222px;z-index:10002;border-radius:4px;padding:40px}.confirm-overlay .confirm-view-shell.alert .cancel-btn,.confirm-overlay .index-progress-view-shell.alert .cancel-btn,.confirm-overlay .move-view-shell.alert .cancel-btn{display:none}.confirm-overlay .confirm-view-shell.prompt.mrvl-overlay-shell .dialog-title,.confirm-overlay .index-progress-view-shell.prompt.mrvl-overlay-shell .dialog-title,.confirm-overlay .move-view-shell.prompt.mrvl-overlay-shell .dialog-title{border-color:transparent}.confirm-overlay .confirm-view-shell.prompt.mrvl-overlay-shell .dialog-title.beta,.confirm-overlay .index-progress-view-shell.prompt.mrvl-overlay-shell .dialog-title.beta,.confirm-overlay .move-view-shell.prompt.mrvl-overlay-shell .dialog-title.beta{margin-bottom:0;padding-bottom:4px}.confirm-overlay .confirm-view-shell.prompt.mrvl-overlay-shell .dialog-title.beta:after,.confirm-overlay .index-progress-view-shell.prompt.mrvl-overlay-shell .dialog-title.beta:after,.confirm-overlay .move-view-shell.prompt.mrvl-overlay-shell .dialog-title.beta:after{background:#5c5ce0;color:#fff;font-size:12px;font-weight:500;line-height:1;white-space:nowrap;font-family:adobe-clean,sans-serif;content:"beta";margin-left:20px;border-radius:4px;padding:4px 6px;display:inline-block;-webkit-transform:translateY(-4px);transform:translateY(-4px);text-transform:uppercase}.confirm-overlay .confirm-view-shell .wait-spinner,.confirm-overlay .index-progress-view-shell .wait-spinner,.confirm-overlay .move-view-shell .wait-spinner{display:none}.confirm-overlay .confirm-view-shell .wait-success,.confirm-overlay .index-progress-view-shell .wait-success,.confirm-overlay .move-view-shell .wait-success{display:none;width:63px;height:63px;position:absolute;left:50%;-webkit-transform:translateX(-50%);transform:translateX(-50%);background-image:url(/images/brandkit/blue-check.svg);background-repeat:no-repeat;background-size:28px 28px;background-position:center 14px;border:4px solid #1d6ae5;border-radius:100px;margin-top:-9px}.confirm-overlay .confirm-view-shell .confirm-progress-bar,.confirm-overlay .confirm-view-shell.showing-progress .confirm-btn,.confirm-overlay .confirm-view-shell.showing-progress:not(.can-cancel-waiter) .cancel-btn,.confirm-overlay .confirm-view-shell.showing-progress:not(.can-cancel-waiter) .confirm-view-close-btn,.confirm-overlay .confirm-view-shell.showing-progress:not(.can-cancel-waiter) .mrvl-dlg-btn-acts,.confirm-overlay .confirm-view-shell.showing-waiter-success .confirm-btn,.confirm-overlay .confirm-view-shell.showing-waiter-success:not(.can-cancel-waiter) .cancel-btn,.confirm-overlay .confirm-view-shell.showing-waiter-success:not(.can-cancel-waiter) .confirm-view-close-btn,.confirm-overlay .confirm-view-shell.showing-waiter-success:not(.can-cancel-waiter) .mrvl-dlg-btn-acts,.confirm-overlay .confirm-view-shell.showing-waiter .confirm-btn,.confirm-overlay .confirm-view-shell.showing-waiter:not(.can-cancel-waiter) .cancel-btn,.confirm-overlay .confirm-view-shell.showing-waiter:not(.can-cancel-waiter) .confirm-view-close-btn,.confirm-overlay .confirm-view-shell.showing-waiter:not(.can-cancel-waiter) .mrvl-dlg-btn-acts,.confirm-overlay .index-progress-view-shell .confirm-progress-bar,.confirm-overlay .index-progress-view-shell.showing-progress .confirm-btn,.confirm-overlay .index-progress-view-shell.showing-progress:not(.can-cancel-waiter) .cancel-btn,.confirm-overlay .index-progress-view-shell.showing-progress:not(.can-cancel-waiter) .confirm-view-close-btn,.confirm-overlay .index-progress-view-shell.showing-progress:not(.can-cancel-waiter) .mrvl-dlg-btn-acts,.confirm-overlay .index-progress-view-shell.showing-waiter-success .confirm-btn,.confirm-overlay .index-progress-view-shell.showing-waiter-success:not(.can-cancel-waiter) .cancel-btn,.confirm-overlay .index-progress-view-shell.showing-waiter-success:not(.can-cancel-waiter) .confirm-view-close-btn,.confirm-overlay .index-progress-view-shell.showing-waiter-success:not(.can-cancel-waiter) .mrvl-dlg-btn-acts,.confirm-overlay .index-progress-view-shell.showing-waiter .confirm-btn,.confirm-overlay .index-progress-view-shell.showing-waiter:not(.can-cancel-waiter) .cancel-btn,.confirm-overlay .index-progress-view-shell.showing-waiter:not(.can-cancel-waiter) .confirm-view-close-btn,.confirm-overlay .index-progress-view-shell.showing-waiter:not(.can-cancel-waiter) .mrvl-dlg-btn-acts,.confirm-overlay .move-view-shell .confirm-progress-bar,.confirm-overlay .move-view-shell.showing-progress .confirm-btn,.confirm-overlay .move-view-shell.showing-progress:not(.can-cancel-waiter) .cancel-btn,.confirm-overlay .move-view-shell.showing-progress:not(.can-cancel-waiter) .confirm-view-close-btn,.confirm-overlay .move-view-shell.showing-progress:not(.can-cancel-waiter) .mrvl-dlg-btn-acts,.confirm-overlay .move-view-shell.showing-waiter-success .confirm-btn,.confirm-overlay .move-view-shell.showing-waiter-success:not(.can-cancel-waiter) .cancel-btn,.confirm-overlay .move-view-shell.showing-waiter-success:not(.can-cancel-waiter) .confirm-view-close-btn,.confirm-overlay .move-view-shell.showing-waiter-success:not(.can-cancel-waiter) .mrvl-dlg-btn-acts,.confirm-overlay .move-view-shell.showing-waiter .confirm-btn,.confirm-overlay .move-view-shell.showing-waiter:not(.can-cancel-waiter) .cancel-btn,.confirm-overlay .move-view-shell.showing-waiter:not(.can-cancel-waiter) .confirm-view-close-btn,.confirm-overlay .move-view-shell.showing-waiter:not(.can-cancel-waiter) .mrvl-dlg-btn-acts{display:none}.confirm-overlay .confirm-view-shell.showing-progress.showing-waiter .wait-spinner,.confirm-overlay .confirm-view-shell.showing-waiter-success.showing-waiter .wait-spinner,.confirm-overlay .confirm-view-shell.showing-waiter.showing-waiter .wait-spinner,.confirm-overlay .index-progress-view-shell.showing-progress.showing-waiter .wait-spinner,.confirm-overlay .index-progress-view-shell.showing-waiter-success.showing-waiter .wait-spinner,.confirm-overlay .index-progress-view-shell.showing-waiter.showing-waiter .wait-spinner,.confirm-overlay .move-view-shell.showing-progress.showing-waiter .wait-spinner,.confirm-overlay .move-view-shell.showing-waiter-success.showing-waiter .wait-spinner,.confirm-overlay .move-view-shell.showing-waiter.showing-waiter .wait-spinner{-webkit-animation:blue-spinner-anim 1s steps(60) infinite forwards;animation:blue-spinner-anim 1s steps(60) infinite forwards;background:50% url('+n(i(689))+") no-repeat;width:68px;height:68px;position:relative;display:block;margin-bottom:1.5rem;margin-top:-12px}@-webkit-keyframes blue-spinner-anim{0%{background-position:0 0}to{background-position:-4080px 0}}@keyframes blue-spinner-anim{0%{background-position:0 0}to{background-position:-4080px 0}}.confirm-overlay .confirm-view-shell.showing-progress.showing-progress .confirm-progress-bar,.confirm-overlay .confirm-view-shell.showing-waiter-success.showing-progress .confirm-progress-bar,.confirm-overlay .confirm-view-shell.showing-waiter.showing-progress .confirm-progress-bar,.confirm-overlay .index-progress-view-shell.showing-progress.showing-progress .confirm-progress-bar,.confirm-overlay .index-progress-view-shell.showing-waiter-success.showing-progress .confirm-progress-bar,.confirm-overlay .index-progress-view-shell.showing-waiter.showing-progress .confirm-progress-bar,.confirm-overlay .move-view-shell.showing-progress.showing-progress .confirm-progress-bar,.confirm-overlay .move-view-shell.showing-waiter-success.showing-progress .confirm-progress-bar,.confirm-overlay .move-view-shell.showing-waiter.showing-progress .confirm-progress-bar{display:block;position:relative;width:80%;margin:10px auto;height:4px;border-radius:0}.confirm-overlay .confirm-view-shell.showing-progress.mrvl-overlay-shell .dialog-title,.confirm-overlay .confirm-view-shell.showing-waiter-success.mrvl-overlay-shell .dialog-title,.confirm-overlay .confirm-view-shell.showing-waiter.mrvl-overlay-shell .dialog-title,.confirm-overlay .index-progress-view-shell.showing-progress.mrvl-overlay-shell .dialog-title,.confirm-overlay .index-progress-view-shell.showing-waiter-success.mrvl-overlay-shell .dialog-title,.confirm-overlay .index-progress-view-shell.showing-waiter.mrvl-overlay-shell .dialog-title,.confirm-overlay .move-view-shell.showing-progress.mrvl-overlay-shell .dialog-title,.confirm-overlay .move-view-shell.showing-waiter-success.mrvl-overlay-shell .dialog-title,.confirm-overlay .move-view-shell.showing-waiter.mrvl-overlay-shell .dialog-title{text-align:center;border-bottom-color:transparent}.confirm-overlay .confirm-view-shell.showing-progress.waiter-has-text .wait-spinner,.confirm-overlay .confirm-view-shell.showing-waiter-success.waiter-has-text .wait-spinner,.confirm-overlay .confirm-view-shell.showing-waiter.waiter-has-text .wait-spinner,.confirm-overlay .index-progress-view-shell.showing-progress.waiter-has-text .wait-spinner,.confirm-overlay .index-progress-view-shell.showing-waiter-success.waiter-has-text .wait-spinner,.confirm-overlay .index-progress-view-shell.showing-waiter.waiter-has-text .wait-spinner,.confirm-overlay .move-view-shell.showing-progress.waiter-has-text .wait-spinner,.confirm-overlay .move-view-shell.showing-waiter-success.waiter-has-text .wait-spinner,.confirm-overlay .move-view-shell.showing-waiter.waiter-has-text .wait-spinner{margin-bottom:1rem;margin-top:-24px}.confirm-overlay .confirm-view-shell.showing-progress .confirm-view-dialog-text,.confirm-overlay .confirm-view-shell.showing-waiter-success .confirm-view-dialog-text,.confirm-overlay .confirm-view-shell.showing-waiter .confirm-view-dialog-text,.confirm-overlay .index-progress-view-shell.showing-progress .confirm-view-dialog-text,.confirm-overlay .index-progress-view-shell.showing-waiter-success .confirm-view-dialog-text,.confirm-overlay .index-progress-view-shell.showing-waiter .confirm-view-dialog-text,.confirm-overlay .move-view-shell.showing-progress .confirm-view-dialog-text,.confirm-overlay .move-view-shell.showing-waiter-success .confirm-view-dialog-text,.confirm-overlay .move-view-shell.showing-waiter .confirm-view-dialog-text{text-align:center}.confirm-overlay .confirm-view-shell.showing-progress:not(.can-cancel-waiter).showing-waiter .confirm-view-content,.confirm-overlay .confirm-view-shell.showing-waiter-success:not(.can-cancel-waiter).showing-waiter .confirm-view-content,.confirm-overlay .confirm-view-shell.showing-waiter:not(.can-cancel-waiter).showing-waiter .confirm-view-content,.confirm-overlay .index-progress-view-shell.showing-progress:not(.can-cancel-waiter).showing-waiter .confirm-view-content,.confirm-overlay .index-progress-view-shell.showing-waiter-success:not(.can-cancel-waiter).showing-waiter .confirm-view-content,.confirm-overlay .index-progress-view-shell.showing-waiter:not(.can-cancel-waiter).showing-waiter .confirm-view-content,.confirm-overlay .move-view-shell.showing-progress:not(.can-cancel-waiter).showing-waiter .confirm-view-content,.confirm-overlay .move-view-shell.showing-waiter-success:not(.can-cancel-waiter).showing-waiter .confirm-view-content,.confirm-overlay .move-view-shell.showing-waiter:not(.can-cancel-waiter).showing-waiter .confirm-view-content{margin-bottom:inherit}.confirm-overlay .confirm-view-shell.showing-waiter-success .wait-success,.confirm-overlay .index-progress-view-shell.showing-waiter-success .wait-success,.confirm-overlay .move-view-shell.showing-waiter-success .wait-success{display:block}.confirm-overlay .confirm-view-shell .cancel-btn,.confirm-overlay .confirm-view-shell .confirm-btn,.confirm-overlay .confirm-view-shell .mrvl-btn,.confirm-overlay .index-progress-view-shell .cancel-btn,.confirm-overlay .index-progress-view-shell .confirm-btn,.confirm-overlay .index-progress-view-shell .mrvl-btn,.confirm-overlay .move-view-shell .cancel-btn,.confirm-overlay .move-view-shell .confirm-btn,.confirm-overlay .move-view-shell .mrvl-btn{text-align:center}.confirm-overlay .confirm-view-shell .confirm-dialog-link,.confirm-overlay .index-progress-view-shell .confirm-dialog-link,.confirm-overlay .move-view-shell .confirm-dialog-link{font-weight:600;color:#444}.confirm-overlay .confirm-view-shell .confirm-view-prompt-field,.confirm-overlay .index-progress-view-shell .confirm-view-prompt-field,.confirm-overlay .move-view-shell .confirm-view-prompt-field{color:#444;border:1px solid #b6b6b6;border-width:0 0 1px;width:100%;font-size:3em;line-height:-moz-block-height;padding-bottom:2px;font-family:adobe-clean,sans-serif}.confirm-overlay .confirm-view-shell .confirm-view-prompt-field:focus,.confirm-overlay .index-progress-view-shell .confirm-view-prompt-field:focus,.confirm-overlay .move-view-shell .confirm-view-prompt-field:focus{outline:none;border-color:#5c5ce0}.confirm-overlay .confirm-view-shell .confirm-view-prompt-field.error,.confirm-overlay .index-progress-view-shell .confirm-view-prompt-field.error,.confirm-overlay .move-view-shell .confirm-view-prompt-field.error{border-color:#ec5b62}.confirm-overlay .confirm-view-shell .x-close-btn,.confirm-overlay .index-progress-view-shell .x-close-btn,.confirm-overlay .move-view-shell .x-close-btn{position:absolute;right:25px;top:25px;background-image:url("+n(i(407))+');background-color:transparent;background-repeat:no-repeat;background-size:contain;background-position:50%;width:20px;height:20px;border:none;outline:none;cursor:pointer;color:transparent;transition:opacity .3s ease-in;opacity:.7}.confirm-overlay .confirm-view-shell .x-close-btn:hover,.confirm-overlay .index-progress-view-shell .x-close-btn:hover,.confirm-overlay .move-view-shell .x-close-btn:hover{opacity:1}.confirm-overlay .confirm-view-shell span,.confirm-overlay .index-progress-view-shell span,.confirm-overlay .move-view-shell span{font-weight:400;color:#444}.confirm-overlay .confirm-view-shell span em,.confirm-overlay .index-progress-view-shell span em,.confirm-overlay .move-view-shell span em{font-weight:700}.confirm-overlay .confirm-view-shell .confirm-view-checkbox,.confirm-overlay .index-progress-view-shell .confirm-view-checkbox,.confirm-overlay .move-view-shell .confirm-view-checkbox{margin-right:74px;margin-top:7px}.confirm-overlay .confirm-view-shell .confirm-view-link,.confirm-overlay .index-progress-view-shell .confirm-view-link,.confirm-overlay .move-view-shell .confirm-view-link{color:var(--link-color);font-size:1.077em;display:inline-block}.confirm-overlay .confirm-view-shell a,.confirm-overlay .index-progress-view-shell a,.confirm-overlay .move-view-shell a{text-decoration:none;cursor:pointer;color:#444;font-weight:700;opacity:.9}.confirm-overlay .confirm-view-shell a:hover,.confirm-overlay .index-progress-view-shell a:hover,.confirm-overlay .move-view-shell a:hover{opacity:1}.confirm-overlay .confirm-view-shell .sp-cta-button-primary a,.confirm-overlay .confirm-view-shell .sp-cta-button-secondary a,.confirm-overlay .index-progress-view-shell .sp-cta-button-primary a,.confirm-overlay .index-progress-view-shell .sp-cta-button-secondary a,.confirm-overlay .move-view-shell .sp-cta-button-primary a,.confirm-overlay .move-view-shell .sp-cta-button-secondary a{color:inherit;opacity:inherit}.confirm-overlay .confirm-view-shell .sp-cta-button-primary.disabled.sp-cta-button-primary,.confirm-overlay .confirm-view-shell .sp-cta-button-secondary.disabled.sp-cta-button-primary,.confirm-overlay .index-progress-view-shell .sp-cta-button-primary.disabled.sp-cta-button-primary,.confirm-overlay .index-progress-view-shell .sp-cta-button-secondary.disabled.sp-cta-button-primary,.confirm-overlay .move-view-shell .sp-cta-button-primary.disabled.sp-cta-button-primary,.confirm-overlay .move-view-shell .sp-cta-button-secondary.disabled.sp-cta-button-primary{opacity:.5}.confirm-overlay .confirm-view-shell b,.confirm-overlay .confirm-view-shell strong,.confirm-overlay .index-progress-view-shell b,.confirm-overlay .index-progress-view-shell strong,.confirm-overlay .move-view-shell b,.confirm-overlay .move-view-shell strong{font-weight:600}.confirm-overlay .mrvl-overlay-overlay-bg{background-color:rgba(25,34,38,.5)}.confirm-overlay .mrvl-overlay-shell .dialog-title{width:360px;font-size:22px;font-weight:900;font-family:adobe-clean,sans-serif;background-color:inherit;padding:0 0 13px;border-bottom:2px solid #e8ebed;margin-bottom:25px}.confirm-overlay .mrvl-overlay-shell .mrvl-dlg-btn-acts{margin-top:25px;position:inherit;display:-webkit-flex;display:flex;-webkit-justify-content:flex-end;justify-content:flex-end}.confirm-overlay .mrvl-overlay-shell .mrvl-dlg-btn-acts button,.confirm-overlay .mrvl-overlay-shell .mrvl-dlg-btn-acts input[type=button]{outline:none;font-family:adobe-clean,sans-serif}.confirm-overlay .mrvl-overlay-shell .mrvl-overlay-content p{font-size:1.077em;width:360px}.confirm-overlay .mrvl-overlay-shell .mrvl-overlay-content p span{font-family:adobe-clean,sans-serif;font-weight:400;font-size:1em}.confirm-overlay .mrvl-overlay-shell .mrvl-overlay-content p span em{font-weight:700}.confirm-overlay .confirm-view-content-shell.mrvl-overlay-content-shell{padding:0}.confirm-overlay .confirm-view-content-shell.mrvl-overlay-content-shell .confirm-view-content{margin-bottom:inherit}.confirm-overlay .cancel-btn,.confirm-overlay .confirm-btn,.confirm-overlay .mrvl-btn{border-radius:40px;font-size:1.23em;font-family:adobe-clean,sans-serif;font-weight:700;height:32px;padding:6px 16px 7px;transition:background-color .2s ease-in,color .2s ease-in;text-align:center}.confirm-overlay .confirm-btn,.confirm-overlay .confirm-btn a{background-color:#5c5ce0;color:#fff;line-height:1.23em}.confirm-overlay .confirm-btn.confirm-btn a,.confirm-overlay .confirm-btn a.confirm-btn a{opacity:1;transition:background-color .2s ease-in,color .2s ease-in}.confirm-overlay .confirm-btn:hover,.confirm-overlay .confirm-btn a:hover{background-color:#5c5ce0}.confirm-overlay .confirm-btn:hover a,.confirm-overlay .confirm-btn a:hover a{background-color:#5c5ce0;color:#fff}.confirm-overlay .confirm-btn:active,.confirm-overlay .confirm-btn a:active{background-color:#5c5ce0}.confirm-overlay .confirm-btn:active a,.confirm-overlay .confirm-btn a:active a{background-color:#5c5ce0;color:#fff}.confirm-overlay .cancel-btn{background-color:transparent;color:#242424;border:2px solid #d4d4d4}.confirm-overlay .cancel-btn:active,.confirm-overlay .cancel-btn:hover{background-color:#fff;color:#242424}.confirm-overlay.custom-font-manager-confirm .confirm-view-bg,.confirm-overlay.custom-font-manager-confirm .index-progress-view-bg,.confirm-overlay.custom-font-manager-confirm .move-view-bg{z-index:100003}.confirm-overlay.custom-font-manager-confirm .confirm-view-shell,.confirm-overlay.custom-font-manager-confirm .index-progress-view-shell,.confirm-overlay.custom-font-manager-confirm .move-view-shell{z-index:100004}.confirm-overlay .index-progress-view-shell{padding:0;width:550px}.confirm-overlay .index-progress-view-shell .index-progress-view-graphic-div{background-color:#eff1f2;border-top-left-radius:4px;border-top-right-radius:4px;overflow:hidden;position:relative}.confirm-overlay .index-progress-view-shell .index-progress-view-graphic-div .index-progress-view-curve{position:absolute;top:204px;margin-left:-85px;background-color:#e2e6e9;height:550px;width:720px;border-radius:50%}.confirm-overlay .index-progress-view-shell .index-progress-view-graphic-div .index-progress-view-graphic{height:300px;width:300px;position:relative;z-index:1;margin-left:125px}.confirm-overlay .index-progress-view-shell .index-progress-view-description{background-color:#fff;margin:30px 30px 0}.confirm-overlay .index-progress-view-shell .index-progress-view-description .index-progress-view-title{border:none;margin:0}.confirm-overlay .index-progress-view-shell .index-progress-view-description p{font-size:1.2em;font-weight:300;margin-bottom:6px}.confirm-overlay .index-progress-view-shell .index-progress-view-description .index-progress-view-warning{font-weight:700;font-style:italic}.confirm-overlay .index-progress-view-shell .index-progress-view-results{display:-webkit-flex;display:flex;-webkit-flex-direction:row;flex-direction:row;margin:30px}.confirm-overlay .index-progress-view-shell .index-progress-view-results .index-progress-view-results-left{width:100%}.confirm-overlay .index-progress-view-shell .index-progress-view-results .index-progress-view-results-left .index-progress-view-progress .index-progress-view-progress-labels{display:-webkit-flex;display:flex;-webkit-flex-direction:row;flex-direction:row;-webkit-justify-content:space-between;justify-content:space-between;margin-bottom:7px;padding-right:30px}.confirm-overlay .index-progress-view-shell .index-progress-view-results .index-progress-view-results-left .index-progress-view-progress .index-progress-view-progress-labels .index-progress-view-label{font-weight:700;opacity:.5}.confirm-overlay .index-progress-view-shell .index-progress-view-results .index-progress-view-results-left .index-progress-view-progress .index-progress-view-progress-labels .index-progress-view-label .loadinging-dots span{-webkit-animation:dots-blink;animation:dots-blink;-webkit-animation-duration:1.4s;animation-duration:1.4s;-webkit-animation-iteration-count:infinite;animation-iteration-count:infinite;-webkit-animation-fill-mode:both;animation-fill-mode:both}.confirm-overlay .index-progress-view-shell .index-progress-view-results .index-progress-view-results-left .index-progress-view-progress .index-progress-view-progress-labels .index-progress-view-label .loadinging-dots span:nth-child(2){-webkit-animation-delay:.4s;animation-delay:.4s}.confirm-overlay .index-progress-view-shell .index-progress-view-results .index-progress-view-results-left .index-progress-view-progress .index-progress-view-progress-labels .index-progress-view-label .loadinging-dots span:nth-child(3){-webkit-animation-delay:.8s;animation-delay:.8s}.confirm-overlay .index-progress-view-shell .index-progress-view-results .index-progress-view-results-left .index-progress-view-progress .index-progress-view-progress-labels .index-complete-view-label{font-weight:700;opacity:.5}.confirm-overlay .index-progress-view-shell .index-progress-view-results .index-progress-view-results-left .index-progress-view-progress .index-progress-view-progress-bar{height:8px;width:100%;padding-right:30px}.confirm-overlay .index-progress-view-shell .index-progress-view-results .index-progress-view-results-left .index-progress-view-progress .index-progress-view-progress-bar .progress-bar-view{position:static}.confirm-overlay .index-progress-view-shell .index-progress-view-results .index-progress-view-results-left .index-progress-view-progress .index-progress-view-progress-bar .progress-bar-view .progress-bar-bg .progress-bar-fill{transition:-webkit-transform .1s ease-out;transition:transform .1s ease-out;transition:transform .1s ease-out,-webkit-transform .1s ease-out}.confirm-overlay .index-progress-view-shell .index-progress-view-results .index-progress-view-results-right{width:100%;display:-webkit-flex;display:flex;-webkit-justify-content:flex-end;justify-content:flex-end}.confirm-overlay .index-progress-view-shell .index-progress-view-results .index-progress-view-results-right .index-progress-view-create-folder-button{padding-left:15px;padding-right:15px;height:30px;cursor:pointer;font-size:15px;font-weight:800;color:#fff;background-color:#1473e6;border-radius:20px;transition:background-color .2s}.confirm-overlay .index-progress-view-shell .index-progress-view-results .index-progress-view-results-right .index-progress-view-create-folder-button:focus{outline:none}.confirm-overlay .index-progress-view-shell .index-progress-view-results .index-progress-view-results-right .index-progress-view-create-folder-button.disabled{background-color:#f1f1f1;color:#aeaeae}.progress-bar-view{position:absolute;height:100%;width:100%;top:0;left:0}.progress-bar-view .progress-bar-bg{height:100%;border-radius:50px;background-color:#b6b6b6;overflow:hidden}.progress-bar-view .progress-bar-bg .progress-bar-fill{height:100%;width:100%;-webkit-transform:scaleX(0);transform:scaleX(0);-webkit-transform-origin:left center 0;transform-origin:left center 0;background-color:#5c5ce0;transition:-webkit-transform .5s ease-out;transition:transform .5s ease-out;transition:transform .5s ease-out,-webkit-transform .5s ease-out}.progress-bar-view .progress-bar-bg .progress-bar-fill.ongoing{width:95%;transition:width 6s ease-out}.mrvl-dlg-btn-area{position:absolute;bottom:30px;text-align:center;width:100%}.mrvl-dlg-btn-area .mrvl-btn{display:inline-block;margin:0 20px}.wait-spinner{content:"";position:absolute;top:50%;left:48.5%;margin:-1.5rem 0 0 -1.5rem;width:65px;height:65px;background-size:100% 100%;-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-iteration-count:infinite;animation-iteration-count:infinite;-webkit-animation-timing-function:linear;animation-timing-function:linear;-webkit-animation-name:wait-spinner-rotate;animation-name:wait-spinner-rotate}@-webkit-keyframes wait-spinner-rotate{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes wait-spinner-rotate{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@-webkit-keyframes dots-blink{0%{opacity:.2}20%{opacity:1}to{opacity:.2}}@keyframes dots-blink{0%{opacity:.2}20%{opacity:1}to{opacity:.2}}',""])},715:function(e,t,i){var n,r;n=[i(9),i(11),i(2),i(63)],void 0===(r=function(e,t,i,n){"use strict";return t.Model.extend({defaults:{name:"",relationship:"",type:"",path:"",contents:"",composite:null,file:null,parent:null,modified:0},getFile:function(){var e=this.get("file");return e||(this.get("type").match("image")?void 0:new Blob([this.get("contents")],{type:"text/plain"}))},getActualComponent:function(){return this.get("composite").current.getComponentWithAbsolutePath("/"+this.get("path"))},isModified:function(){return this.get("modified")>0},setModified:function(){var e=this.get("modified");this.set("modified",e+1)},setUnmodified:function(){var e=this.get("modified");this.set("modified",e-1)}})}.apply(t,n))||(e.exports=r)},716:function(e,t,i){var n,r,o;n=[i(9),i(2),i(11),i(22),i(63),i(1),i(6),i(13),i(33),i(719),i(127),i(103)],void 0===(r=function(e,t,i,n,r,a,s,c,l,u,d,h){"use strict";o=i.Model.extend({initialize:function(){this.connectionManager=void 0,this.rootObjectId=void 0,this._connectionManagerPromise=void 0,this._initLogger()},_initLogger:function(){this.logger=new s.default({color:"steelblue",name:"baton-controller"}),this.logger.debug=this.logger.debug.bind(this.logger),this.logger.info=this.logger.info.bind(this.logger),this.logger.warn=this.logger.warn.bind(this.logger),this.logger.error=this.logger.error.bind(this.logger),this.logger.traceflow=this.logger.traceflow.bind(this.logger)},_getCollabController:function(){return d},_deltaHandler:function(e){this.logger.traceflow("baton-locking","_deltaHandler, object=",e)},_batonHandler:function(e){this.logger.traceflow("baton-locking","made it to _batonHandler: resource:"+e.resourceId+" sequenceNumber:"+e.sequenceNumber+" clientId:"+e.clientId)},_errorHandler:function(e){this.logger.traceflow("baton-locking","made it to _errorHandler, object=",JSON.stringify(e))},_createConnectionManager:function(e){return new u.default.ConnectionManager(e)},_cookieOverrides:function(e){var t={host:e,pathSuffix:""};return e.match(/stage.*\.adobe.io$/)?(t.host=e.replace(/\.adobe\.io$/,".adobeprojectm.com"),t.pathSuffix=";Domain=adobeprojectm.com"):(t.host=e.replace(/\.adobe\.io$/,".adobe.com"),t.pathSuffix=";Domain=adobe.com"),t},_initializeConnectionManager:function(){if(!this._connectionManagerPromise){var e=Date.now();this._connectionManagerPromise=c.getAccessToken().then(function(e){var t={rootObjectId:this.rootObjectId,dsHost:a.discoveryServiceHost,dsEnvSelector:a.discoveryServiceEnvironment,authToken:e,syncMessageHandler:this._deltaHandler.bind(this),batonMessageHandler:this._batonHandler.bind(this),errorHandler:this._errorHandler.bind(this),cookieOverrides:this._cookieOverrides,logger:this.logger,apiKey:a.key};return this.connectionManager=this._createConnectionManager(t),this.connectionManager.connect()}.bind(this)).then(function(){this.sessionId=n.v4();var t=this.connectionManager.userId,i={deviceId:n.v4(),agent:navigator.userAgent,platform:navigator.platform};this.logger.info("BatonController - connect",{topic:this.rootObjectId,sessionId:this.sessionId,clientInfo:i,elapsed:Date.now()-e});return e=Date.now(),this.connectionManager.send(new u.default.OpenSessionRequest(this.rootObjectId,t,i,"2147483647")).then(function(){this.logger.info("BatonController - opened session",{elapsed:Date.now()-e}),this.logger.traceflow("baton-locking","Delta History session is open.")}.bind(this))}.bind(this)).catch(function(t){throw this.logger.error("BatonController - connect failed",{error:t,elapsed:Date.now()-e}),t}.bind(this))}return this._connectionManagerPromise},isCollaborationEnabled:function(e,t,i){return this._getCollabController().getCollaborationForUrn(i).then(function(e){return!!(e&&e.collaborators&&e.collaborators.length>0)&&(this.collaborators=e.collaborators,!0)}.bind(this))},_clientIdToUserName:function(e){var t=e.split(":")[0],i=(this.collaborators||[]).find((function(e){return e.id===t}));return i&&(i.displayName||i.email)||"Unknown user"},_clientIdToUserInfo:function(e){var t=e.split(":")[0];return(this.collaborators||[]).find((function(e){return e.collaborator===t}))||{displayName:""}},_cachedProfiles:{},_getUserPublicProfileFromClientId:function(e){var i=this._cachedProfiles[e];if(i)return t(i);var n=e.split(":")[0],r=a.behancePublicProfile+n+"?api_key="+a.key;return window.fetch(r,{method:"GET",headers:{"x-api-key":a.key}}).then(function(t){return t.ok?t.json().then(function(t){var n=this._clientIdToUserInfo(e)||{};return i={email:n.email,displayName:n.displayName||""},203===t.http_code?i.images=t.user.images:200===t.http_code&&(i.images=t.user.images),this._cachedProfiles[e]=i,i}.bind(this)).catch(function(t){return this._clientIdToUserInfo(e)}.bind(this)):this._clientIdToUserInfo(e)}.bind(this)).catch(function(t){return this._clientIdToUserInfo(e)}.bind(this))},lockHeldByUserInfoFromErr:function(e){return this._getUserPublicProfileFromClientId(e.lockHeldByUser)},lockHeldByUserInfoFromClientId:function(e){return this._getUserPublicProfileFromClientId(e)},acquireBatonLock:function(e,i,n,r){return this.rootObjectId&&this.rootObjectId!==i?(this.logger.warn("PRIOR LOCK ERROR CONDITION: asking for "+i+" but we still have "+this.rootObjectId),t.reject({code:"FAILED_TO_RELEASE_PRIOR_LOCK",usermsg:"Failed to release project lock."})):i?this.rootObjectId===i&&this._batonLockDefer?this._batonLockDefer.promise:(this.rootObjectId=i,this._batonLockDefer=t.defer(),this._batonLockRequestedTime=0,this.isCollaborationEnabled(e,this.rootObjectId,r).then(function(e){if(e)return this._initializeConnectionManager().then(function(){return this._batonLockRequestedTime=Date.now(),this._requestBatonLock()}.bind(this)).then(function(){this.logger.info("acquireBatonLock success",{elapsed:Date.now()-this._batonLockRequestedTime}),this._batonLockDefer.resolve({virtualBaton:!1})}.bind(this));this._batonLockDefer.resolve({virtualBaton:!0})}.bind(this)).catch(function(e){this._cleanupConnection(),this._batonLockDefer.reject(this._parseBatonError(e,Date.now()-this._batonLockRequestedTime))}.bind(this)),this._batonLockDefer.promise):t.resolve({virtualBaton:!0})},_parseBatonError:function(e,t){var i=new Error("BATON_LOCK_FAILED unable to acquire lock");return e&&e.errObject&&"ACQUIRE_BATON"===e.errObject.operation?423===e.errObject.status?(this.logger.info("AcquireBatonRequest lock denied, another user has it",Object.assign({elapsed:t},e.errObject)),i.lockHeldByUser=e.errObject.clientIds[0]):this.logger.error("baton-locking service failed with unexpected error",e):this.logger.error("unexpected error when attempting to acquire baton lock",e),i},_requestBatonLock:function(){return this.connectionManager.send(new u.default.AcquireBatonRequest([{resourceId:this.rootObjectId,sequenced:!1,allOrNone:!0}],"0",!0)).then(function(e){return this.logger.traceflow("baton-locking","AcquireBatonRequest resolved to "+JSON.stringify(e,null,2)),e}.bind(this))},_cleanupConnection:function(){if(this.connectionManager){try{this.connectionManager.cleanup()}catch(e){this.logger.traceflow("baton-locking","Caught error cleaning up connectionManager")}this.connectionManager=null}this._connectionManagerPromise=null,this.rootObjectId=null},justReleaseBatonLock:function(){return this._connectionManagerPromise?this._connectionManagerPromise.then(function(){return this._batonLockDefer.promise||t.reject(new Error("BatonController::justReleaseBatonLock"))}.bind(this)).then(function(){return this.connectionManager.send(new u.default.ReleaseBatonRequest([this.rootObjectId]))}.bind(this)).then((function(e){console.info("ReleaseBatonRequest resolved to "+JSON.stringify(e,null,2))})).finally(function(){this._batonLockDefer=null}.bind(this)):t.resolve()},releaseBatonLock:function(){return this.releaseBatonLockAndConnection()},releaseLockOnWindowUnload:function(){this.connectionManager&&this.rootObjectId&&(this.connectionManager.send(new u.default.ReleaseBatonRequest([this.rootObjectId])),this.connectionManager.send(new u.default.CloseSessionRequest))},releaseBatonLockAndConnection:function(){return this._connectionManagerPromise?this.justReleaseBatonLock().finally(function(){return this.connectionManager.send(new u.default.CloseSessionRequest)}.bind(this)).then(function(){return this._cleanupConnection(),t.resolve()}.bind(this)).catch(function(e){return e&&e.hasOwnProperty("lockHeldByUser")||this.logger.warn("BatonController: caught error releasing baton",e),this._cleanupConnection(),t.resolve()}.bind(this)):(this._cleanupConnection(),t.resolve())}})}.apply(t,n))||(e.exports=r),e.exports=o},717:function(e,t){},718:function(e,t){},757:function(e,t,i){var n,r;n=[i(16),i(9),i(11),i(2),i(164),i(63)],void 0===(r=function(e,t,n,r,o,a){"use strict";return new(o.extend({typeName:"authoring-context",getProjectName:function(e,t){return e.get("name")||this.getSetting("newDocName")},getConfig:function(){return{syncGroup:"adobe-spark-authoring-contexts",scope:"authoring-context",newDocName:"My Authoring Context",doctype:"application/vnd.adobe.authoringcontext.document+dcx",displayName:"Authoring Context"}},isaProjectFormat:function(){return!1},lazyLoad:function(e){i.e("authoring-context").then(function(t){var n=i(877);this.setStorageImpl(n),e.resolve()}.bind(this).bind(null,i)).catch(i.oe)},usesContentModifiedEtags:function(){return!1},resolveConflict:function(e,t,n,r){return i.e("brand-kit-conflict-resolver").then(function(o){var s=i(881);s.muiStorage=a,s.resolveConflict(e,t,n,r)}.bind(null,i)).catch(i.oe),!0}}))}.apply(t,n))||(e.exports=r)},862:function(e,t,i){var n,r;n=[i(16),i(9),i(2),i(11),i(63),i(37),i(13),i(3595),i(757),i(877),i(198),i(127),i(99),i(680)],void 0===(r=function(e,t,i,n,r,o,a,s,c,l,u,d,h,g){"use strict";var f=h.default||h;return new(n.Model.extend({initialize:function(){this._factories=[],this._pendingPromises=[],this._hasNoDefaultContext=null,this._contextListPromises={},this.authoringContextFactoryCreate=this.authoringContextFactoryCreate.bind(this)},setGlobalActiveContext:function(e){try{window.localStorage&&(e?window.localStorage.setItem("ac-active-id-"+a.getProfile().userId,e):window.localStorage.removeItem("ac-active-id-"+a.getProfile().userId))}catch(t){this._backupActiveContextId=e}},getGlobalActiveContext:function(){return this.getDefaultContext()},addAuthoringContextFactory:function(e){this._factories.push(e)},authoringContextFactoryCreate:function(e,i){var n;return t.each(this._factories,function(t){t.supportsComposite(e)&&(n=t.create())}.bind(this)),n||(n=new s),n.setComposite(e),n._isDefault=i,n},setCollaborationForAuthoringContext:function(e){return d.getCollaborationForPath(e.composite.getStoragePath()).catch((function(t){if(404===t.status)return window.marvel.logger.warn("[AuthoringContextController] Invitations came back with a 404 status for collaboration state - ignoring in authcontext syncing - but logging in case this is a bogus 404."),e.collaborators=[],e;throw t})).then((function(t){return e.collaborators=t.collaborators,e}))},getContextList:function(e){var n=performance.now();return this._contextListPromises[e]?this._contextListPromises[e]:(e=e||"all",this._contextListPromises[e]=u.load().then(function(r){return c.load().then(function(){return r.ACPSparkController.listAuthoringContexts(this.authoringContextFactoryCreate).then(function(r){var a=[],s=t.filter(r,(function(e){return e&&e.activated()}));t.each(r,function(t){var i=t&&t.composite;"owned"===e?i&&"INCOMING"!==t.composite.getCollaboration()&&a.push(t):"shared"===e?i&&"INCOMING"===t.composite.getCollaboration()&&a.push(t):a.push(t)}.bind(this));var c=s&&s.length,l=performance.now();return o.trackEvent("brandsLoaded",{numActivatedBrands:c},"organizer"),window.marvel.logger.info(`[PerformanceTracker] ${Math.round(l-n)}ms for ${c} brands by [${e}]`,{elapsedTime:Math.round(l-n),numActivatedBrands:c}),this._contextListPromises[e]=null,i(a)}.bind(this))}.bind(this))}.bind(this)),this._contextListPromises[e])},sortContextList:function(e){return e.sort((function(e,t){return e.isDefault()?-1:t.isDefault()?1:e.getName().localeCompare(t.getName())})),e},operationPending:function(e){this._pendingPromises.push(e)},getPendingPromises:function(){return this._pendingPromises},getActivatedContextsByType:function(e,i){return this.getContextList(i).then(function(e){var i=[];return t.each(e,function(e){e.activated()&&i.push(e)}.bind(this)),i}.bind(this))},getContextsByType:function(e,i,n){var r=performance.now();return this.getContextList(i).then(function(o){var a=[];return t.each(o,function(t){t.getType()===e&&a.push(t)}.bind(this)),n&&this.sortContextList(a),window.marvel.logger.info("[PerformanceTracker] getContextsByType total time "+Math.round(performance.now()-r)+"ms",{elapsedTime:Math.round(performance.now()-r),type:e,ownershipType:i}),a}.bind(this))},getLegacyDefaultContext:function(e){return this.getContextsByType(e,"owned").then((function(e){var i=t.find(e,(function(e){return e.hasLegacyDefaultFlag()&&e.activated()}));return i?i.upgrade():null}))},getDefaultContextFromAPI:function(){return f.fetch({LOG_CATEGORY:"[AuthoringContextController]",uri:"/branding/default"}).then(function(e){var t=e.defaultBrandId;return void 0!==t?this.getContextByIdFromStorage(t):(this._hasNoDefaultContext=!0,null)}.bind(this))},getDefaultContext:function(e,t){var n=performance.now(),r=this._defaultContext;return!r&&!this._hasNoDefaultContext||t?a.isSignedInUser().then(function(e){return e?this.getDefaultContextFromAPI().then(function(e){return e?(this._hasNoDefaultContext=!1,this._defaultContext=e,window.marvel.logger.info("[PerformanceTracker] getDefaultContext fromAPI completed "+Math.round(performance.now()-n)+"ms",{elapsedTime:Math.round(performance.now()-n)}),e):(this._hasNoDefaultContext=!0,null)}.bind(this)):(this._hasNoDefaultContext=!0,null)}.bind(this)):i.resolve(r)},setDefaultContext:function(e){var i=e.getType();return f.fetch({LOG_CATEGORY:"[AuthoringContextController]",method:"PUT",uri:"/branding/default",headers:{"Content-Type":"application/json"},body:JSON.stringify({defaultBrandId:e.getId()})}).then(function(){return window.marvel.features.userData.defaultBrandId=e.getId(),this.getContextsByType(i,"all").then(function(i){return t.each(i,function(e){e._isDefault=!1}.bind(this)),e._isDefault=!0,this._defaultContext=e,this._hasNoDefaultContext=!1,e}.bind(this))}.bind(this))},createContext:function(e,t){return window.marvel.logger.debug("[AuthoringContextController] createContext started"),l.createDocument({}).then(function(i){var n,r=i.getDCXRoot();return i.setName(e),r.setValue("ac#type",t),r.setValue("ac#version",s.prototype.getACVersion()),(n=this.authoringContextFactoryCreate(i)).save().then((function(){return window.marvel.logger.debug("[AuthoringContextController] createContext saved"),u.load().then((function(e){return e.SparkStorageLoader.invalidateAuthoringContextCache().then((function(){return window.marvel.logger.debug("[AuthoringContextController] trigger 'authoring-context-added' event"),window.marvel.events.trigger("authoring-context-added",n),window.marvel.events.trigger("insert-authoring-context",n),n}))}))}))}.bind(this))},deleteContext:function(e){return e.delete().then(function(){return window.marvel.events.trigger("authoring-context-deleted",e),window.marvel.events.trigger("remove-authoring-context",e.getURN()),i.resolve()}.bind(this))},getContextById:function(e){return e?this.getContextList().then(function(n){var r;return t.each(n,function(t){t.getId()!==e&&t.getURN()!==e||(r=t)}.bind(this)),r?r.upgrade():i.resolve(null)}.bind(this)):i.resolve(null)},getContextByIdFromStorage:function(e){if(!e)return i.resolve(null);var t=i.defer();return a.ajax({type:"GET",url:"https://"+window.marvel.settings.ss+"/assets/adobe-spark-authoring-contexts/"+e,headers:{"x-api-key":window.marvel.settings.key}}).then(function(e){this.createAuthoringContext(e).then((function(e){t.resolve(e)})).catch((function(e){"NO_COMPOSITE"===e.code&&t.resolve(null),t.reject(e)}))}.bind(this)).fail((function(i){404===i.status?(window.marvel.logger.warn("[AuthoringContextController] was unable to find default authoring context in storage.",{authoringContextId:e,error:i}),t.resolve(null)):t.reject(i)})),t.promise},createAuthoringContext:function(e){return u.load().then(function(t){return t.SparkStorageLoader.createComposite(e.urn,e.modified).then(function(t){return e.composite=t,e.compositeDoc=new g({name:t.current.name,id:t.assetId,modified:e.modified,syncGroupName:"adobe-spark-authoring-contexts",compositeObj:t}),e.compositeDoc.setIsMounted(!0),e.compositeDoc.setCollaboration(e.collaboration),this.authoringContextFactoryCreate(e.compositeDoc)}.bind(this))}.bind(this))},getActiveContext:function(e){if(e){var n=e.getMyApp();if(n){var r=n.getAuthoringContextId(e);return r?this.getContextList().then(function(n){var o=null;return t.each(n,function(e){e.getId()!==r&&e.getURN()!==r||(o=e)}.bind(this)),o||(window.marvel.logger.warn("failed to find active AuthoringContext for "+e.get("id")+" with AC.id == "+r),i.resolve(null))}.bind(this)):i.resolve(null)}return window.marvel.logger.warn("[AuthoringContextController] null app in getActiveContext doc# "+e.get("id")),i.resolve(null)}return window.marvel.logger.warn("[AuthoringContextController] null doc in getActiveContext"),i.resolve(null)},setActiveContext:function(e,t){return e?t.getMyApp().setAuthoringContextIdAndUrn(t,e):i.resolve(null)},setLastPublishedContext:function(e,t){var i=null;return e&&(i=e.getId()),t.getMyApp().setLastPublishedAuthoringContextId(t,i)},deleteAllUnactivatedContexts:function(){return this.getContextList("owned").then(function(e){return i.all(t.reduce(e,(function(e,t){return t.activated()||e.push(t.delete()),e}),[]))}.bind(this))}}))}.apply(t,n))||(e.exports=r)},866:function(e,t,i){var n,r;n=[i(16),i(9),i(2),i(11),i(6),i(410),i(97),i(33),i(1),i(3595),i(862),i(111),i(3901),i(1966),i(406),i(1593),i(299),i(1655),i(17),i(3904),i(13)],void 0===(r=function(e,t,i,n,r,o,a,s,c,l,u,d,h,g,f,m,p,v,b,y,w){"use strict";var C,M=new r.default({color:"#0000ff",name:"brand-kit"}),L=c.brandedChromeCommunity,k=h(L),x=["chrome-preloader-logo","chrome-header-logo","chrome-footer-logo"],N=["primary-logo","generated-logo","chrome-header-logo","chrome-footer-logo","chrome-preloader-logo","post-stamp","outro-logo"],T=["headerCTAEnabled","footerCTAEnabled","headerCTA","footerCTA","headerCTAURL","footerCTAURL","headerCTAButtonStyle","footerCTAButtonStyle","facebookURL","twitterURL","instagramURL"],I={page:3,video:3,post:0},D={page:3,video:3,post:23},S={page:3,video:3,post:23};return C=l.extend({initialize:function(){l.prototype.initialize.apply(this,arguments)},getDefaultName:function(){var e=w.getProfile().first_name||"";return e?e+"'s Brand":"My Brand"},getSetupPercentDone:function(){return i.all([this.getLogoWithUniqueRole("primary-logo"),this.getColorWithUniqueRole("base-color"),this.getFontWithUniqueRole("headline-font")]).spread(function(e,t,i){return(!!e+!!t+!!i)/3}.bind(this))},deleteAuthoringContextLogo:function(e){return this.deleteLogo(e.getData())},deleteLogo:function(e){return this.deleteNamedImageAsset(e,d.LOGOS_PARENT)},getLogos:function(){return this.composite.acquireNestedChildren(d.LOGOS_PARENT,!0).then(function(e){return e||[]}.bind(this))},getLogosSync:function(){return this.composite.acquireNestedChildrenSync(d.LOGOS_PARENT)},convertLogoToAuthoringContextLogo:function(e){var t=new y;return t.setContext(this),t.setData(e),t},getAuthoringContextLogos:function(){return this.composite.acquireNestedChildren(d.LOGOS_PARENT,!0).then(function(e){return t.map(e,function(e){return this.convertLogoToAuthoringContextLogo(e)}.bind(this))}.bind(this))},getLogoHref:function(e,t,n){return n=n||"image/png",this.getAssetWithUniqueRole(d.LOGOS_PARENT,t||"primary-logo").then(function(t){return t?this.hrefForImage(d.LOGOS_PARENT,t,e,n||"image/png"):i.resolve(null)}.bind(this))},getThumbnailURL:function(e){return this.getLogoHref(e||200)},_removeLogoWithRole:function(e){var t,i,n=this.getLogoWithRoleSync(e);n&&(t=d.LOGOS_PARENT+"."+n.getValue("path")+".!image",(i=this.composite.getChildWithMap(t))&&(this.composite.getDCXComposite().current.removeComponent(i),this.save(),console.warn("Removed the component with "+e)))},hasLogoWithRole:function(e){var t,i=this.getLogoWithRoleSync(e);return!(!i||(t=d.LOGOS_PARENT+"."+i.getValue("path")+".!image",!this.composite.getChildWithMap(t)))},getLogoWithRoleSync:function(e){var i=this.composite.acquireNestedChildrenSync(d.LOGOS_PARENT);return t.find(i,function(t){return this.hasRole(t,e)}.bind(this))},getLogoWithUniqueRole:function(e){return this.getAssetWithUniqueRole("logos",e).then(function(e){if(e){var t=new y;return t.setContext(this),t.setData(e),t}return null}.bind(this))},getChromeInfo:function(){var e,n=[];return this.composite.getSharedCloudCollectionId().then(function(t){e=t;for(var r=[],o=0,a=x.length;o<a;o++){var s=x[o];r.push(this.getAssetWithUniqueRole(d.LOGOS_PARENT,s))}return n=[this.getColorWithUniqueRole("chrome-text-color"),this.getColorWithUniqueRole("chrome-footer-color"),this.getColorWithUniqueRole("chrome-social-icons-color"),this.getColorWithUniqueRole("chrome-background-color"),this.getColorWithUniqueRole("chrome-header-cta-background-color"),this.getColorWithUniqueRole("chrome-footer-background-color"),this.getColorWithUniqueRole("chrome-header-cta-color")],i.all(n.concat(r))}.bind(this)).then(function(r){for(var o={name:this.getName(),logos:[]},a=this.composite.getDCXComposite().current,s=[],c=n.length,l=function(e,t,i){return t.getImageComponentHref(i,500,"image/png").then((function(t){return o[e+"-href"]=t,t}))},u=0,d=x.length;u<d;u++){var h=r[u+c];if(h){var g=a.getComponentsOf(h)[0],f=t.extend({},h._data.components[0]),m=x[u];f.absolutePath=e+"/"+f.id,f.name=x[u],o.logos.push(f),s.push(l(m,this.composite,g))}}for(u=0,d=T.length;u<d;u++){var p=T[u];o[p]=this.getViewerPageInfo(p)}var v=r[0],b=r[1],y=r[2],w=r[3],C=r[4],M=r[5],L=r[6];return v&&(o["chrome-text-color"]=v.hex()),b&&(o["chrome-footer-color"]=b.hex()),y&&(o["chrome-social-icons-color"]=y.hex()),w&&(o["chrome-background-color"]=w.hex()),C&&(o["chrome-header-cta-background-color"]=C.hex()),M&&(o["chrome-footer-background-color"]=M.hex()),L&&(o["chrome-header-cta-color"]=L.hex()),i.allSettled(s).then((function(){return o}))}.bind(this))},getChromeChecksum:function(){var e,i="",n=function(e,t){t&&(i.length&&(i+="&"),i+=encodeURIComponent(e)+"="+encodeURIComponent(t))},r=function(t){return t.name==e};return this.getChromeInfo().then(function(a){for(var s=0,c=x.length;s<c;s++){e=x[s];var l=t.find(a.logos,r);l&&n(e,l.etag)}for(s=0,c=T.length;s<c;s++){var u=T[s];n(u,a[u])}return n("chrome-text-color",a["chrome-text-color"]),n("chrome-footer-color",a["chrome-footer-color"]),n("chrome-social-icons-color",a["chrome-social-icons-color"]),n("chrome-background-color",a["chrome-background-color"]),n("chrome-header-cta-background-color",a["chrome-header-cta-background-color"]),n("chrome-footer-background-color",a["chrome-footer-background-color"]),(new o).update(i).digest("hex")}.bind(this))},changesSinceLastPublish:function(){var e=this.composite.getDCXRoot().getValue("cp#assetId");return e?i.all([k.getMetadata(e),this.getChromeChecksum()]).spread((function(t,i){var n=t&&t.custom?t.custom.checksum:void 0,r=t.version;if("string"!=typeof r&&void 0!==r)throw new Error("CP did not return a valid version");return{assetId:e,version:r,checksum:i,changes:i!=n}})):i.resolve({changes:!0})},publish:function(e){var n,r,o,a,s=this.composite.getDCXComposite().id,c=s+"/manifest",l=[],u=function(e){return e.name==a};return this.getChromeInfo().then(function(e){o=e;for(var i=0,n=x.length;i<n;i++){a=x[i];var r=t.find(o.logos,u);r&&r.type&&r.absolutePath&&r.id&&l.push({content_type:r.type,source:r.absolutePath,destination:r.id})}return k.serverSideCopy(s,l)}.bind(this)).then(function(e){for(var n,r=[],s=function(e){return e.path==n},l=0,d=x.length;l<d;l++){a=x[l];var h=t.find(o.logos,u);if(h){n=h.id;var g=t.find(e,s);r.push({name:a,id:g.path,path:g.path,version:g.version,type:h.type,state:"unmodified",etag:h.etag})}}delete o.logos;var f={"manifest-format-version":6,name:this.getName(),type:"application/vnd.adobe.sparkchrome.document+dcx",state:"unmodified",id:this.getId(),components:r,"authctx#chromeinfo":o};return i.all([k.checkResource(c).then((function(e){return k.uploadResource(c,"application/json",f,e)})),this.getChromeChecksum()])}.bind(this)).spread(function(t,i){return n=t.version,r=i,k.publishAsset(s,"application/vnd.adobe.sparkchrome.document+dcx",e,{main_resource:{resource_path:"manifest",resource_version:n}})}.bind(this)).then(function(t){return!e&&t&&(e=t),this.composite.pull()}.bind(this)).then(function(){this.composite.getDCXRoot();return this.composite.saveChanges((function(t){t.setValue("cp#assetId",e)})).then((function(){return{assetId:e,checksum:r,version:n}}))}.bind(this))},_generateLogoFromTitle:function(e){var t=document.createElement("canvas"),i=t.getContext("2d"),n=this.getName(),r=g.getTextWidthDOM(n,"333px Lato");t.width=r,t.height=400,i.fillStyle=e?"#ffffff":"#000000",i.font="333px Lato",i.textAlign="center",i.textBaseline="middle",i.fillText(n,r/2,200);var o=t.toDataURL("image/png");return f(o)},generateLogoFromTitle:function(e,t,n){var r=this._generateLogoFromTitle(),o=this._generateLogoFromTitle(!0);return i.all([this.uploadImageAsset("{new}",d.LOGOS_PARENT,r,void 0,e,void 0,n),this.uploadImageAsset("{new}",d.LOGOS_PARENT,o,void 0,t,void 0,n)])},updateLogoFromTitle:function(e,t){var i=this._generateLogoFromTitle(t);return this.uploadImageAsset(e,d.LOGOS_PARENT,i)},updateLogo:function(e,t){return this.getLogoWithUniqueRole(e).then(function(e){var i=e.getData().path;if(!t){var n=this._generateLogoFromTitle();t=n[1]}return this.uploadImageAsset(i,d.LOGOS_PARENT,t,void 0,void 0,d.MAX_LOGO_SIZE)}.bind(this)).then(function(){return this.getLogoWithUniqueRole(e)}.bind(this)).then(function(e){return e}.bind(this))},applyLogoToThemeThumbnail:function(e,t,n,r,o){return this.getLogoWithUniqueRole("primary-logo").then((function(e){var t=e.getValue(r,"image/png"),n=e.getValue(o,"image/png"),a=i.defer(),s=i.defer(),c=new Image,l=new Image;return c.onload=function(){a.resolve(c)},c.src=t,l.onload=function(){s.resolve(l)},l.src=n,i.all([a.promise,s.promise])})).spread((function(i,a){var s,c=i.width,l=i.height;a.width,a.height;s=c<=r&&l<=o?i:a,e.drawImage(s,t,n)}))},generateStamp:function(e,t,n){var r=this;return t=t||"{new}",p.inject().then((function(o){var a=i.defer(),s=function(i){var o=r.getName().toUpperCase(),s=document.createElement("canvas"),c=s.getContext("2d"),l=150,u="700 "+l+"px "+i,h=g.getTextWidthDOM(o,u),m=h+180,p=240,v=1;m>1024&&(v=1024/m,u="700 "+(l=Math.floor(150*v))+"px proxima-nova",m=1024,p=Math.floor(p*v),h=g.getTextWidthDOM(o,u)),s.width=m,s.height=p,c.imageSmoothingEnabled=!1,c.fillStyle="rgba(255, 255, 255, 0.6)",c.fillRect(0,0,m,p),c.globalCompositeOperation="destination-out";var b=(m-h)/2,y=p/2;c.font=u,c.fillStyle="#000",c.textBaseline="middle",c.fillText(o,b,y),c.globalCompositeOperation="source-over",c.font=u,c.textBaseline="middle",c.fillStyle="rgba(0,0,0,0.3)",c.fillText(o,b,y);var w=f(s.toDataURL("image/png"));r.uploadImageAsset(t,d.LOGOS_PARENT,w,"generated-stamp",e,void 0,n).then((function(e){a.resolve(e)})).catch((function(e){console.warn("Error uploading stamp",e),a.reject(e)}))};return-1===document.documentElement.className.search(/wf-proximanova-n7-active/)?(window.marvel.logger.warn("[brand setup] unexpected: Stamp detected that Proxima Nova was not loaded, attempting to load via TypeKitPreview"),o.load([{id:"vcsm",variations:["n7"],css_name:"proxima-nova",name:"Proxima Nova"}],{active:function(){s("proxima-nova")},inactive:function(e,t){window.marvel.logger.error("Error generating stamp inactive",{fontFamily:e,fontDescription:t}),a.reject(new Error("Error generating stamp inactive"))},fontinactive:function(e,t){var i="Error generating stamp fontinactive";window.marvel.logger.error(i,{fontFamily:e,fontDescription:t}),a.reject(new Error(i))}})):s("proxima-nova"),a.promise}))},getClientCommunityPlatform:function(){return h},fullUpdate:function(e){var n=i.defer(),r={},o=[];t.each(this.getCustomFonts(!0),function(i){var n=i.getMetrics();if(!n||!n.version||n.version<this.CURRENT_FONT_METRICS_VERSION){M.warn("Brand font ("+i.friendlyName()+") had an outdated version number ("+n.version+" < "+this.CURRENT_FONT_METRICS_VERSION+"). Recalculating metrics.");var a,s=i.cssName(),c=i.friendlyName();o.push(i.getFileAsBlob().then((function(e){return v.extractFontInfo(e)})).then((function(e){return a=e,i.loadFont()})).then(function(){return v.generateMetricsAsync(c,s,a).then(function(e){e.version=this.CURRENT_FONT_METRICS_VERSION,i.getValue().metrics=e,M.warn("Metrics recalculation for brand font ("+i.friendlyName()+") completed.")}.bind(this)).catch((function(e){var t="Metrics recalculation for brand font ("+i.friendlyName()+") failed: "+e;throw e.message=t,e}))}.bind(this)).then((function(){var n=e.getThemesUsingAssets([i]);t.each(n,(function(e){var t=e.theme;r[t.id]?r[t.id].assets.push(i):r[t.id]={theme:e,assets:[i]}}))})))}}.bind(this));var a=[];return i.all(o).then(function(){return i.all(t.map(r,(function(t){return a.push(t.theme),e.updateThemesWithAssets([t.theme],t.assets)})))}.bind(this)).then(function(){return this.updateThemeThumbnails(a)}.bind(this)).then(function(){return this.save()}.bind(this)).then(function(){n.resolve()}.bind(this)).catch((function(e){M.warn(e),n.reject(e)})),n.promise},isFullUpdateNeeded:function(){var e=!1;return t.each(this.getCustomFonts(!0),function(t){var i=t.getMetrics();if(!i||!i.version||i.version<this.CURRENT_FONT_METRICS_VERSION)return e=!0,!1}.bind(this)),e},validateAndRepair:function(){var e=[];return this.activated()&&(this.hasLogoWithRole("video-watermark")||e.push(this.generateStamp(["video-watermark","generated-stamp"]))),i.allSettled(e).then(function(){return this}.bind(this))},resetBrand:function(){var e=this.getLogoWithRoleSync("generated-stamp");e&&this.composite.removeChild(e);var t=this.getLogoWithRoleSync("generated-logo");t&&this.composite.removeChild(t),(t=this.getLogoWithRoleSync("generated-logo-inverted"))&&this.composite.removeChild(t);var i=this.composite.getChildWithMap("viewerpage");i&&this.composite.removeChild(i);var n=this.composite.getChildWithMap("videooutro");n&&this.composite.removeChild(n);var r=this.composite.getChildWithMap("themes");return r&&this.composite.removeChild(r),this.deactivate(),this.save()},applyWhiteLogoRoleIfNecessary:function(e){this.getLogosSync();return m.colorsFromImage(e.getHrefAsync(600,"image/png"),5,!0).then(function(t){1===t.length&&m.getLuminosity(m.hexToRgb(t[0]))>248?this.addRole(e.getData(),"white-logo"):this.removeRole(e.getData(),"white-logo")}.bind(this))},setup:function(e,i){Date.now();return window.marvel.logger.info("[brand setup] generating stamp"),this.generateStamp(["video-watermark","generated-stamp"],void 0,!0).then(function(){if(e)return window.marvel.logger.info("[brand setup] no logo found - generating logo"),this.generateLogoFromTitle(N,["generated-logo-inverted","chrome-footer-logo"],!0)}.bind(this)).then(function(){var e=this.convertLogoToAuthoringContextLogo(this.getLogoWithRoleSync("primary-logo"));return this.applyWhiteLogoRoleIfNecessary(e)}.bind(this)).then(function(){window.marvel.logger.info("[brand setup] setting viewer page metadata");var e=b.getString("brand-viewer-page-cta-placeholder");return this.setViewerPageInfo({ctaLabel:e,headerCTA:e,footerCTA:e,ctaEnabled:!1,headerCTAEnabled:!1,footerCTAEnabled:!1},void 0,!0)}.bind(this)).then(function(){return window.marvel.logger.info("[brand setup] setting video outro info"),this.setOutroInfo({message:b.getString("brand-outro-message-placeholder")},void 0,!0)}.bind(this)).then(function(){return window.marvel.logger.info("[brand setup] starting theme/template generation"),this.generateThemes(i).catch((function(e){if(e.resetBrand)throw window.marvel.logger.error("[brand setup] found resetBrand error",e),e;return window.marvel.logger.error("[brand setup] error generating themes",e),null}))}.bind(this)).then(function(){t.each(Object.keys(a.apps),function(e,i){var n=a.apps[e].typeName,r="enable-brand-kit-"+n+"-themes";if(s.hasFeature(r)){var o=this.composite.acquireNestedChildrenSync("themes");if((o=t.filter(o,(function(e){return e.getValue("ac#format")==n}))).length<I[n]){var c=new Error("Too few "+n+" themes/templates. Attempted to generate "+S[n]+". Would have been ok to only have "+I[n]+". Only ended up with "+o.length);throw c.resetBrand=!0,c}o.length<S[n]&&window.marvel.logger.warn("[brand setup] There was an error in generating "+(S[n]-o.length)+" "+n+" themes/templates. User was allowed to continue because they were successful in generating at least "+I[n]+" of them.")}}.bind(this))}.bind(this)).then(function(){return this.activate(),window.marvel.events.trigger("brand-activated",this),this.recordEntitlmentIfInterested(),this.save()}.bind(this))},generateThemes:function(e){return i.allSettled(t.map(Object.keys(a.apps),function(n,r){var o=a.apps[n],c=o.typeName,l="enable-brand-kit-"+c+"-themes";if("post"!==c&&s.hasAny("enable-brand-kit-in-progress",l))return o.getThemeController(this).then(function(n){try{var r=n.getNumberOfGeneratedThemes?n.getNumberOfGeneratedThemes():void 0;return r||(r="number"==typeof D[c]?i.resolve(D[c]):i.resolve(-1)),r.then(function(r){return S[c]=r,window.marvel.logger.info("[brand setup] generating "+c+" themes/templates"),n.addGeneratedThemes&&"function"==typeof n.addGeneratedThemes?n.addGeneratedThemes(this):n.getGeneratedThemes&&"function"==typeof n.getGeneratedThemes?n.getGeneratedThemes(this).then(function(r){return i.allSettled(t.map(r,function(t){return this.createTheme(c,(function(e){e.setValue("theme#data",t)}),(function(t,i){return e&&e(),n.generateThemeRendition(t,i)}),!0)}.bind(this)))}.bind(this)):void 0}.bind(this))}catch(o){window.marvel.logger.error("[brand setup] error generating themes/templates: "+o.message,o)}}.bind(this))}.bind(this))).then(function(e){t.each(e,(function(e){var t=e&&e.reason;if("fulfilled"!==e.state&&t&&t.resetBrand)throw t;"fulfilled"!==e.state&&t&&window.marvel.logger.warn("[brand setup] Unexpected error in generating themes/templates: "+t.message,t)}))}.bind(this))}}),u.addAuthoringContextFactory({supportsComposite:function(e){return!0},create:function(){return new C}}),C}.apply(t,n))||(e.exports=r)},877:function(e,t,i){var n,r;n=[i(9),i(2),i(241)],void 0===(r=function(e,t,i){return new(i.extend({_startingCreateDoc:function(){this.loadDocumentPromise=null}}))}.apply(t,n))||(e.exports=r)},99:function(e,t,i){"use strict";i.r(t);var n=i(2),r=i.n(n),o=i(22),a=i.n(o),s=i(13),c=i.n(s),l=i(1),u=i.n(l),d=i(6),h=i(35),g={fetch:function(e){var t=r.a.defer();h.SparkPerformanceTracker.measurePromise("SpFetchUtils:".concat(e.method||"GET",":").concat(e.uri),t.promise);var i=e&&e.LOG_CATEGORY||"[CCLibraries]",n=new d.default({color:"purple",name:i}),o=a()(),s=Object.assign({},e.headers,{"x-api-key":e&&e.apiKey||u.a.key,"x-request-id":o}),l=r.a.resolve();return e.skipAuth||(l=c.a.requiresAuth().then((function(){return c.a.getAccessToken().then((function(e){s=Object.assign(s,{authorization:"Bearer "+e})}))}))),l.then((function(){window.fetch(e.uri,{method:e.method||"GET",headers:new window.Headers(s),body:e.body}).then((function(r){if(e.resolveRawResponse)t.resolve(r);else if(r.status<300)if(201===r.status)e.expectTextResponse?r.text().then((function(e){var i,r=e.indexOf("urn:");r<0?n.warn("[Libraries:Client] failed to find URN in create result",{responseBody:e}):(i=e.substr(r).trim(),n.info('[Libraries:Client] Created doc URN "'+i+'"')),t.resolve({createdUrn:i,ok:!0})})):r.json().then((function(e){t.resolve(e)}));else if(204===r.status)t.resolve({ok:!0});else{var o=r.headers.get("content-type");o&&-1!==o.indexOf("application/json")?r.json().then((function(e){t.resolve(e)})):r.text().then((function(e){var i;try{i=JSON.parse(e)}catch(n){i=e}t.resolve(i)}))}else if(401===r.status)t.reject(new Error("".concat(i," Request auth failed; errorCode: ").concat(r.status," ; errorText: ").concat(r.statusText))),c.a.clearScope(),window.marvel.events.trigger("spark-auth-failed");else{var a="n/a",s="n/a";r.body&&r.body.errorMessage&&r.body.requestId&&(a=r.body.errorMessage,s=r.body.requestId),n.error("Request failed",{requestId:s,errorCode:r.status,errorMessage:a});var l=new Error("".concat(i," Request failed; errorCode: ").concat(r.status," ; errorMessage: ").concat(a));l.statusCode=r.status,403===r.status?r.json().then((function(e){n.info("[Libraries:Client] 403 returned while attempting Library operation",e),l.subStatusCode=parseFloat(e.subErrorCode),t.reject(l)})).catch((function(e){n.warn("[Libraries:Client] 403 returned while attempting Library operation without a response body"),t.reject(l)})):t.reject(l)}})).catch((function(e){t.reject(e)}))})),t.promise}};t.default=g}}]);
//# sourceMappingURL=brand-kit-controller-93b4db3e.js.map